/*

 Copyright (C) 2011-2014 Almende B.V, http://almende.com

 Licensed under the Apache License, Version 2.0 (the "License"); you may not
 use this file except in compliance with the License. You may obtain a copy
 of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 License for the specific language governing permissions and limitations under
 the License.
*/
!function(ka){if("object"==typeof exports)module.exports=ka();else if("function"==typeof define&&define.amd)define(ka);else{var v;"undefined"!=typeof window?v=window:"undefined"!=typeof global?v=global:"undefined"!=typeof self&&(v=self);v.vis=ka()}}(function(){return function v(I,Q,n){function u(g,J){if(!Q[g]){if(!I[g]){var E="function"==typeof require&&require;if(!J&&E)return E(g,!0);if(A)return A(g,!0);throw Error("Cannot find module '"+g+"'");}E=Q[g]={exports:{}};I[g][0].call(E.exports,function(f){var h=
I[g][1][f];return u(h?h:f)},E,E.exports,v,I,Q,n)}return Q[g].exports}for(var A="function"==typeof require&&require,g=0;g<n.length;g++)u(n[g]);return u}({1:[function(v,I,Q){function n(a){this.id=m.randomUUID();this.options=a||{};this.data={};this.fieldId=this.options.fieldId||"id";this.convert={};this.showInternalIds=this.options.showInternalIds||!1;if(this.options.convert)for(var b in this.options.convert)this.options.convert.hasOwnProperty(b)&&(a=this.options.convert[b],this.convert[b]="Date"==a||
"ISODate"==a||"ASPDate"==a?"Date":a);this.subscribers={};this.internalIds={}}function u(a,b){this.id=m.randomUUID();this.data=null;this.ids={};this.options=b||{};this.fieldId="id";this.subscribers={};var c=this;this.listener=function(){c._onEvent.apply(c,arguments)};this.setData(a)}function A(a,b){this.itemset=a;this.options=b||{};this.defaultOptions={order:function(a,b){return a instanceof G?b instanceof G?a.data.end-a.data.start-(b.data.end-b.data.start)||a.data.start-b.data.start:-1:b instanceof
G?1:a.data.start-b.data.start},margin:{item:10}};this.ordered=[]}function g(a){this.id=m.randomUUID();this.end=this.start=null;this.options=a||{};this.setOptions(a)}function S(a){if("horizontal"!=a&&"vertical"!=a)throw new TypeError('Unknown direction "'+a+'". Choose "horizontal" or "vertical".');}function J(a,b){return{x:a.pageX-M.util.getAbsoluteLeft(b),y:a.pageY-M.util.getAbsoluteTop(b)}}function E(){var a=this;this.id=m.randomUUID();this.components={};var b=null;this.on("request-reflow",function(c){c?
a.reflow():b||(b=setTimeout(function(){b=null;a.reflow()},0))});var c=null;this.on("request-repaint",function(b){b?a.repaint():c||(c=setTimeout(function(){c=null;a.repaint()},0))})}function f(){this.frame=this.options=this.controller=this.depends=this.parent=this.id=null;this.height=this.width=this.left=this.top=0}function h(a,b,c){this.id=m.randomUUID();this.parent=a;this.depends=b;this.options=c||{}}function s(a,b){this.id=m.randomUUID();this.container=a;var c=this;this.hammer=null;this.listeners=
{};"touch pinch tap doubletap hold dragstart drag dragend mousewheel DOMMouseScroll".split(" ").forEach(function(a){c.listeners[a]=function(){var b=[a].concat(Array.prototype.slice.call(arguments,0));c.controller.emit.apply(c.controller,b)}});this.options=b||{};this.defaultOptions={autoResize:!0}}function B(a,b,c){this.id=m.randomUUID();this.parent=a;this.depends=b;this.dom={majorLines:[],majorTexts:[],minorLines:[],minorTexts:[],redundant:{majorLines:[],majorTexts:[],minorLines:[],minorTexts:[]}};
this.props={range:{start:0,end:0,minimumStep:0},lineTop:0};this.options=c||{};this.defaultOptions={orientation:"bottom",showMinorLabels:!0,showMajorLabels:!0};this.range=this.conversion=null}function Y(a,b,c){this.id=m.randomUUID();this.parent=a;this.depends=b;this.options=c||{};this.defaultOptions={showCurrentTime:!1}}function P(a,b,c){this.id=m.randomUUID();this.parent=a;this.depends=b;this.options=c||{};this.defaultOptions={showCustomTime:!1};this.customTime=new Date;this.eventParams={}}function q(a,
b,c){this.id=m.randomUUID();this.parent=a;this.depends=b;this.eventListeners={dragstart:this._onDragStart.bind(this),drag:this._onDrag.bind(this),dragend:this._onDragEnd.bind(this)};this.options=c||{};this.defaultOptions={type:"box",align:"center",orientation:"bottom",margin:{axis:20,item:10},padding:5};this.dom={};var d=this;this.range=this.itemsData=null;this.listeners={add:function(a,b,c){c!=d.id&&d._onAdd(b.items)},update:function(a,b,c){c!=d.id&&d._onUpdate(b.items)},remove:function(a,b,c){c!=
d.id&&d._onRemove(b.items)}};this.items={};this.selection=[];this.queue={};this.stack=new A(this,Object.create(this.options));this.conversion=null;this.touchParams={}}function K(a,b,c,d){this.parent=a;this.data=b;this.dom=null;this.options=c||{};this.defaultOptions=d||{};this.visible=this.selected=!1;this.offset=this.height=this.width=this.left=this.top=0}function N(a,b,c,d){this.props={dot:{left:0,top:0,width:0,height:0},line:{top:0,left:0,width:0,height:0}};K.call(this,a,b,c,d)}function x(a,b,c,
d){this.props={dot:{top:0,width:0,height:0},content:{height:0,marginLeft:0}};K.call(this,a,b,c,d)}function G(a,b,c,d){this.props={content:{left:0,width:0}};K.call(this,a,b,c,d)}function U(a,b,c,d){this.props={content:{left:0,width:0}};this._width=0;Object.defineProperty(this,"width",{get:function(){return this.props.content&&this._width<this.props.content.width?this.props.content.width:this._width},set:function(a){this._width=a}});G.call(this,a,b,c,d)}function R(a,b,c){this.id=m.randomUUID();this.parent=
a;this.groupId=b;this.itemset=null;this.options=c||{};this.options.top=0;this.props={label:{width:0,height:0}};this.height=this.width=this.left=this.top=0}function D(a,b,c){this.id=m.randomUUID();this.parent=a;this.depends=b;this.options=c||{};this.groupsData=this.itemsData=this.range=null;this.groups={};this.dom={};this.props={labels:{width:0}};this.queue={};var d=this;this.listeners={add:function(a,b){d._onAdd(b.items)},update:function(a,b){d._onUpdate(b.items)},remove:function(a,b){d._onRemove(b.items)}}}
function y(a,b,c){var d=this,e=F().hours(0).minutes(0).seconds(0).milliseconds(0);this.options={orientation:"bottom",autoResize:!0,editable:!1,selectable:!0,snap:null,min:null,max:null,zoomMin:10,zoomMax:31536E10,showMinorLabels:!0,showMajorLabels:!0,showCurrentTime:!1,showCustomTime:!1,onAdd:function(a,b){b(a)},onUpdate:function(a,b){b(a)},onMove:function(a,b){b(a)},onRemove:function(a,b){b(a)}};this.controller=new E;if(!a)throw Error("No container element provided");var k=Object.create(this.options);
k.height=function(){return d.options.height?d.options.height:d.timeaxis.height+d.content.height+"px"};this.rootPanel=new s(a,k);this.controller.add(this.rootPanel);this.controller.on("tap",this._onSelectItem.bind(this));this.controller.on("hold",this._onMultiSelectItem.bind(this));this.controller.on("doubletap",this._onAddItem.bind(this));a=Object.create(this.options);a.left=function(){return d.labelPanel.width};a.width=function(){return d.rootPanel.width-d.labelPanel.width};a.top=null;a.height=null;
this.itemPanel=new h(this.rootPanel,[],a);this.controller.add(this.itemPanel);a=Object.create(this.options);a.top=null;a.left=null;a.height=null;a.width=function(){return d.content&&"function"===typeof d.content.getLabelsWidth?d.content.getLabelsWidth():0};this.labelPanel=new h(this.rootPanel,[],a);this.controller.add(this.labelPanel);a=Object.create(this.options);this.range=new g(a);this.range.setRange(e.clone().add("days",-3).valueOf(),e.clone().add("days",4).valueOf());this.range.subscribe(this.controller,
this.rootPanel,"move","horizontal");this.range.subscribe(this.controller,this.rootPanel,"zoom","horizontal");this.range.on("rangechange",function(a){d.controller.emit("rangechange",a);d.controller.emit("request-reflow",!0)});this.range.on("rangechanged",function(a){d.controller.emit("rangechanged",a);d.controller.emit("request-reflow",!0)});e=Object.create(k);e.range=this.range;e.left=null;e.top=null;e.width="100%";e.height=null;this.timeaxis=new B(this.itemPanel,[],e);this.timeaxis.setRange(this.range);
this.controller.add(this.timeaxis);this.options.snap=this.timeaxis.snap.bind(this.timeaxis);this.currenttime=new Y(this.timeaxis,[],k);this.controller.add(this.currenttime);this.customtime=new P(this.timeaxis,[],k);this.controller.add(this.customtime);this.setGroups(null);this.groupsData=this.itemsData=null;c&&this.setOptions(c);b&&this.setItems(b)}function p(a,b,c,d){this.selected=!1;this.edges=[];this.dynamicEdges=[];this.reroutedEdges={};this.group=d.nodes.group;this.fontSize=d.nodes.fontSize;
this.fontFace=d.nodes.fontFace;this.fontColor=d.nodes.fontColor;this.fontDrawThreshold=3;this.color=d.nodes.color;this.id=void 0;this.shape=d.nodes.shape;this.image=d.nodes.image;this.y=this.x=0;this.yFixed=this.xFixed=!1;this.verticalAlignTop=this.horizontalAlignLeft=!0;this.baseRadiusValue=this.radius=d.nodes.radius;this.radiusFixed=!1;this.radiusMin=d.nodes.radiusMin;this.radiusMax=d.nodes.radiusMax;this.level=-1;this.imagelist=b;this.grouplist=c;this.vy=this.vx=this.fy=this.fx=0;this.minForce=
d.minForce;this.damping=d.physics.damping;this.mass=1;this.setProperties(a,d);this.resetCluster();this.clusterSession=this.dynamicEdgesLength=0;this.clusterSizeWidthFactor=d.clustering.nodeScaling.width;this.clusterSizeHeightFactor=d.clustering.nodeScaling.height;this.clusterSizeRadiusFactor=d.clustering.nodeScaling.radius;this.maxNodeSizeIncrements=d.clustering.maxNodeSizeIncrements;this.growthIndicator=0;this.graphScale=this.graphScaleInv=1;this.canvasTopLeft={x:-300,y:-300};this.canvasBottomRight=
{x:300,y:300};this.parentEdgeId=null}function z(a,b,c){if(!b)throw"No graph provided";this.graph=b;this.widthMin=c.edges.widthMin;this.widthMax=c.edges.widthMax;this.toId=this.fromId=this.id=void 0;this.style=c.edges.style;this.title=void 0;this.width=c.edges.width;this.value=void 0;this.length=c.physics.springLength;this.selected=this.customLength=!1;this.smooth=c.smoothCurves;this.via=this.to=this.from=null;this.originalFromId=[];this.originalToId=[];this.connected=!1;this.dash=m.extend({},c.edges.dash);
this.color={color:c.edges.color.color,highlight:c.edges.color.highlight};this.lengthFixed=this.widthFixed=!1;this.setProperties(a,c)}function V(a,b,c,d){this.container=a?a:document.body;this.y=this.x=0;this.padding=5;void 0!==b&&void 0!==c&&this.setPosition(b,c);void 0!==d&&this.setText(d);this.frame=document.createElement("div");a=this.frame.style;a.position="absolute";a.visibility="hidden";a.border="1px solid #666";a.color="black";a.padding=this.padding+"px";a.backgroundColor="#FFFFC6";a.borderRadius=
"3px";a.MozBorderRadius="3px";a.WebkitBorderRadius="3px";a.boxShadow="3px 3px 10px rgba(128, 128, 128, 0.5)";a.whiteSpace="nowrap";this.container.appendChild(this.frame)}function $(){var a=["graph_BH_table","graph_R_table","graph_H_table"],b=document.querySelector('input[name="graph_physicsMethod"]:checked').value,c="graph_"+b+"_table",d=document.getElementById(c);d.style.display="block";for(var e=0;e<a.length;e++)a[e]!=c&&(d=document.getElementById(a[e]),d.style.display="none");this._restoreNodes();
"R"==b?(this.constants.hierarchicalLayout.enabled=!1,this.constants.physics.hierarchicalRepulsion.enabeled=!1,this.constants.physics.barnesHut.enabled=!1):"H"==b?(this.constants.hierarchicalLayout.enabled=!0,this.constants.physics.hierarchicalRepulsion.enabeled=!0,this.constants.physics.barnesHut.enabled=!1,this._setupHierarchicalLayout()):(this.constants.hierarchicalLayout.enabled=!1,this.constants.physics.hierarchicalRepulsion.enabeled=!1,this.constants.physics.barnesHut.enabled=!0);this._loadSelectedForceSolver();
this.moving=!0;this.start()}function O(a,b,c){var d=a+"_value";a=document.getElementById(a).value;b instanceof Array?(document.getElementById(d).value=b[parseInt(a)],this._overWriteGraphConstants(c,b[parseInt(a)])):(document.getElementById(d).value=parseInt(b)*parseFloat(a),this._overWriteGraphConstants(c,parseInt(b)*parseFloat(a)));("hierarchicalLayout_direction"==c||"hierarchicalLayout_levelSeparation"==c||"hierarchicalLayout_nodeSpacing"==c)&&this._setupHierarchicalLayout();this.moving=!0;this.start()}
function r(a,b,c){this._initializeMixinLoaders();this.containerElement=a;this.height=this.width="100%";this.renderRefreshRate=60;this.renderTimestep=1E3/this.renderRefreshRate;this.renderTime=0.5*this.renderTimestep;this.maxRenderSteps=3;this.selectable=this.stabilize=!0;this.triggerFunctions={add:null,edit:null,connect:null,"delete":null};this.constants={nodes:{radiusMin:5,radiusMax:20,radius:5,shape:"ellipse",image:void 0,widthMin:16,widthMax:64,fixed:!1,fontColor:"black",fontSize:14,fontFace:"verdana",
level:-1,color:{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"}},borderColor:"#2B7CE9",backgroundColor:"#97C2FC",highlightColor:"#D2E5FF",group:void 0},edges:{widthMin:1,widthMax:15,width:1,style:"line",color:{color:"#848484",highlight:"#848484"},fontColor:"#343434",fontSize:14,fontFace:"arial",dash:{length:10,gap:5,altLength:void 0}},configurePhysics:!1,physics:{barnesHut:{enabled:!0,theta:1/0.6,gravitationalConstant:-2E3,centralGravity:0.3,springLength:95,
springConstant:0.04,damping:0.09},repulsion:{centralGravity:0.1,springLength:200,springConstant:0.05,nodeDistance:100,damping:0.09},hierarchicalRepulsion:{enabled:!1,centralGravity:0,springLength:100,springConstant:0.01,nodeDistance:60,damping:0.09},damping:null,centralGravity:null,springLength:null,springConstant:null},clustering:{enabled:!1,initialMaxNodes:100,clusterThreshold:500,reduceToNodes:300,chainThreshold:0.4,clusterEdgeThreshold:20,sectorThreshold:100,screenSizeThreshold:0.2,fontSizeMultiplier:4,
maxFontSize:1E3,forceAmplification:0.1,distanceAmplification:0.1,edgeGrowth:20,nodeScaling:{width:1,height:1,radius:1},maxNodeSizeIncrements:600,activeAreaBoxSize:80,clusterLevelDifference:2},navigation:{enabled:!1},keyboard:{enabled:!1,speed:{x:10,y:10,zoom:0.02}},dataManipulation:{enabled:!1,initiallyVisible:!1},hierarchicalLayout:{enabled:!1,levelSeparation:150,nodeSpacing:100,direction:"UD"},smoothCurves:!0,maxVelocity:10,minVelocity:0.1,stabilizationIterations:1E3};this.editMode=this.constants.dataManipulation.initiallyVisible;
var d=this;this.groups=new Groups;this.images=new Images;this.images.setOnloadCallback(function(){d._redraw()});this.zoomIncrement=this.yIncrement=this.xIncrement=0;this._loadPhysicsSystem();this._create();this._loadSectorSystem();this._loadClusterSystem();this._loadSelectionSystem();this._loadHierarchySystem();this.setOptions(c);this.freezeSimulation=!1;this.cachedFunctions={};this.calculationNodes={};this.calculationNodeIndices=[];this.nodeIndices=[];this.nodes={};this.edges={};this.canvasTopLeft=
{x:0,y:0};this.canvasBottomRight={x:0,y:0};this.pointerPosition={x:0,y:0};this.areaCenter={};this.previousScale=this.scale=1;this.edgesData=this.nodesData=null;this.nodesListeners={add:function(a,b){d._addNodes(b.items);d.start()},update:function(a,b){d._updateNodes(b.items);d.start()},remove:function(a,b){d._removeNodes(b.items);d.start()}};this.edgesListeners={add:function(a,b){d._addEdges(b.items);d.start()},update:function(a,b){d._updateEdges(b.items);d.start()},remove:function(a,b){d._removeEdges(b.items);
d.start()}};this.moving=!0;this.timer=void 0;this.setData(b,this.constants.clustering.enabled||this.constants.hierarchicalLayout.enabled);!0==this.constants.hierarchicalLayout.enabled?this._setupHierarchicalLayout():!1==this.stabilize&&this.zoomExtent(!0,this.constants.clustering.enabled);this.constants.clustering.enabled&&this.startWithClustering()}var F="undefined"!==typeof window&&window.moment||v("moment"),aa=v("emitter-component"),T;T="undefined"!==typeof window?window.Hammer||v("hammerjs"):
function(){throw Error("hammer.js is only available in a browser, not in node.js.");};var ha;ha="undefined"!==typeof window?window.mousetrap||v("mousetrap"):function(){throw Error("mouseTrap is only available in a browser, not in node.js.");};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1};try{console.log("Warning: Ancient browser detected. Please update your browser")}catch(ra){}}Array.prototype.forEach||(Array.prototype.forEach=
function(a,b){for(var c=0,d=this.length;c<d;++c)a.call(b||this,this[c],c,this)});Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(null==this)throw new TypeError(" this is null or not defined");var k=Object(this),l=k.length>>>0;if("function"!==typeof a)throw new TypeError(a+" is not a function");b&&(c=b);d=Array(l);for(e=0;e<l;){var C;e in k&&(C=k[e],C=a.call(c,C,e,k),d[e]=C);e++}return d});Array.prototype.filter||(Array.prototype.filter=function(a,b){if(null==this)throw new TypeError;
var c=Object(this),d=c.length>>>0;if("function"!=typeof a)throw new TypeError;for(var e=[],k=0;k<d;k++)if(k in c){var l=c[k];a.call(b,l,k,c)&&e.push(l)}return e});Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),d=c.length;return function(e){if("object"!==typeof e&&"function"!==typeof e||null===e)throw new TypeError("Object.keys called on non-object");
var k=[],l;for(l in e)a.call(e,l)&&k.push(l);if(b)for(l=0;l<d;l++)a.call(e,c[l])&&k.push(c[l]);return k}}());Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)});Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof
d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;e.prototype=new d;return e});Object.create||(Object.create=function(a){function b(){}if(1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");b.prototype=a;return new b});Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,
1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;e.prototype=new d;return e});var m={isNumber:function(a){return a instanceof Number||"number"==typeof a},isString:function(a){return a instanceof String||"string"==typeof a},isDate:function(a){return a instanceof Date||m.isString(a)&&(Z.exec(a)||!isNaN(Date.parse(a)))?!0:!1},isDataTable:function(a){return"undefined"!==typeof google&&google.visualization&&
google.visualization.DataTable&&a instanceof google.visualization.DataTable},randomUUID:function(){var a=function(){return Math.floor(65536*Math.random()).toString(16)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},extend:function(a,b){for(var c=1,d=arguments.length;c<d;c++){var e=arguments[c],k;for(k in e)e.hasOwnProperty(k)&&void 0!==e[k]&&(a[k]=e[k])}return a},convert:function(a,b){var c;if(void 0!==a){if(null===a)return null;if(!b)return a;if("string"!==typeof b&&!(b instanceof String))throw Error("Type must be a string");
switch(b){case "boolean":case "Boolean":return Boolean(a);case "number":case "Number":return Number(a.valueOf());case "string":case "String":return String(a);case "Date":if(m.isNumber(a))return new Date(a);if(a instanceof Date||F.isMoment(a))return new Date(a.valueOf());if(m.isString(a))return(c=Z.exec(a))?new Date(Number(c[1])):F(a).toDate();throw Error("Cannot convert object of type "+m.getType(a)+" to type Date");case "Moment":if(m.isNumber(a))return F(a);if(a instanceof Date)return F(a.valueOf());
if(F.isMoment(a))return F(a);if(m.isString(a))return(c=Z.exec(a))?F(Number(c[1])):F(a);throw Error("Cannot convert object of type "+m.getType(a)+" to type Date");case "ISODate":if(m.isNumber(a))return new Date(a);if(a instanceof Date)return a.toISOString();if(F.isMoment(a))return a.toDate().toISOString();if(m.isString(a))return(c=Z.exec(a))?(new Date(Number(c[1]))).toISOString():(new Date(a)).toISOString();throw Error("Cannot convert object of type "+m.getType(a)+" to type ISODate");case "ASPDate":if(m.isNumber(a))return"/Date("+
a+")/";if(a instanceof Date)return"/Date("+a.valueOf()+")/";if(m.isString(a))return c=Z.exec(a),"/Date("+(c?(new Date(Number(c[1]))).valueOf():(new Date(a)).valueOf())+")/";throw Error("Cannot convert object of type "+m.getType(a)+" to type ASPDate");default:throw Error("Cannot convert object of type "+m.getType(a)+' to type "'+b+'"');}}}},Z=/^\/?Date\((\-?\d+)/i;m.getType=function(a){var b=typeof a;return"object"==b?null==a?"null":a instanceof Boolean?"Boolean":a instanceof Number?"Number":a instanceof
String?"String":a instanceof Array?"Array":a instanceof Date?"Date":"Object":"number"==b?"Number":"boolean"==b?"Boolean":"string"==b?"String":b};m.getAbsoluteLeft=function(a){var b=document.documentElement,c=document.body,d=a.offsetLeft;for(a=a.offsetParent;null!=a&&a!=c&&a!=b;)d+=a.offsetLeft,d-=a.scrollLeft,a=a.offsetParent;return d};m.getAbsoluteTop=function(a){var b=document.documentElement,c=document.body,d=a.offsetTop;for(a=a.offsetParent;null!=a&&a!=c&&a!=b;)d+=a.offsetTop,d-=a.scrollTop,a=
a.offsetParent;return d};m.getPageY=function(a){if("pageY"in a)return a.pageY;var b=document.documentElement,c=document.body;return("targetTouches"in a&&a.targetTouches.length?a.targetTouches[0].clientY:a.clientY)+(b&&b.scrollTop||c&&c.scrollTop||0)-(b&&b.clientTop||c&&c.clientTop||0)};m.getPageX=function(a){if("pageY"in a)return a.pageX;var b=document.documentElement,c=document.body;return("targetTouches"in a&&a.targetTouches.length?a.targetTouches[0].clientX:a.clientX)+(b&&b.scrollLeft||c&&c.scrollLeft||
0)-(b&&b.clientLeft||c&&c.clientLeft||0)};m.addClassName=function(a,b){var c=a.className.split(" ");-1==c.indexOf(b)&&(c.push(b),a.className=c.join(" "))};m.removeClassName=function(a,b){var c=a.className.split(" "),d=c.indexOf(b);-1!=d&&(c.splice(d,1),a.className=c.join(" "))};m.forEach=function(a,b){var c,d;if(a instanceof Array){c=0;for(d=a.length;c<d;c++)b(a[c],c,a)}else for(c in a)a.hasOwnProperty(c)&&b(a[c],c,a)};m.updateProperty=function(a,b,c){return a[b]!==c?(a[b]=c,!0):!1};m.addEventListener=
function(a,b,c,d){a.addEventListener?(void 0===d&&(d=!1),"mousewheel"===b&&0<=navigator.userAgent.indexOf("Firefox")&&(b="DOMMouseScroll"),a.addEventListener(b,c,d)):a.attachEvent("on"+b,c)};m.removeEventListener=function(a,b,c,d){a.removeEventListener?(void 0===d&&(d=!1),"mousewheel"===b&&0<=navigator.userAgent.indexOf("Firefox")&&(b="DOMMouseScroll"),a.removeEventListener(b,c,d)):a.detachEvent("on"+b,c)};m.getTarget=function(a){a||(a=window.event);var b;a.target?b=a.target:a.srcElement&&(b=a.srcElement);
void 0!=b.nodeType&&3==b.nodeType&&(b=b.parentNode);return b};m.fakeGesture=function(a,b){var c=T.event.collectEventData(this,null,b);isNaN(c.center.pageX)&&(c.center.pageX=b.pageX);isNaN(c.center.pageY)&&(c.center.pageY=b.pageY);return c};m.option={};m.option.asBoolean=function(a,b){"function"==typeof a&&(a=a());return null!=a?!1!=a:b||null};m.option.asNumber=function(a,b){"function"==typeof a&&(a=a());return null!=a?Number(a)||b||null:b||null};m.option.asString=function(a,b){"function"==typeof a&&
(a=a());return null!=a?String(a):b||null};m.option.asSize=function(a,b){"function"==typeof a&&(a=a());return m.isString(a)?a:m.isNumber(a)?a+"px":b||null};m.option.asElement=function(a,b){"function"==typeof a&&(a=a());return a||b||null};m.GiveDec=function(a){return Value="A"==a?10:"B"==a?11:"C"==a?12:"D"==a?13:"E"==a?14:"F"==a?15:eval(a)};m.GiveHex=function(a){return Value=10==a?"A":11==a?"B":12==a?"C":13==a?"D":14==a?"E":15==a?"F":""+a};m.hexToRGB=function(a){a=a.replace("#","").toUpperCase();var b=
m.GiveDec(a.substring(0,1)),c=m.GiveDec(a.substring(1,2)),d=m.GiveDec(a.substring(2,3)),e=m.GiveDec(a.substring(3,4)),k=m.GiveDec(a.substring(4,5));a=m.GiveDec(a.substring(5,6));b=16*b+c;return{r:b,g:16*d+e,b:16*k+a}};m.RGBToHex=function(a,b,c){var d=m.GiveHex(Math.floor(a/16));a=m.GiveHex(a%16);var e=m.GiveHex(Math.floor(b/16));b=m.GiveHex(b%16);var k=m.GiveHex(Math.floor(c/16));c=m.GiveHex(c%16);return"#"+(d+a+e+b+k+c)};m.RGBToHSV=function(a,b,c){a/=255;b/=255;c/=255;var d=Math.min(a,Math.min(b,
c)),e=Math.max(a,Math.max(b,c));return d==e?{h:0,s:0,v:d}:{h:60*((a==d?3:c==d?1:5)-(a==d?b-c:c==d?a-b:c-a)/(e-d))/360,s:(e-d)/e,v:e}};m.HSVToRGB=function(a,b,c){var d,e,k,l=Math.floor(6*a),C=6*a-l;a=c*(1-b);var f=c*(1-C*b);b=c*(1-(1-C)*b);switch(l%6){case 0:d=c;e=b;k=a;break;case 1:d=f;e=c;k=a;break;case 2:d=a;e=c;k=b;break;case 3:d=a;e=f;k=c;break;case 4:d=b;e=a;k=c;break;case 5:d=c,e=a,k=f}return{r:Math.floor(255*d),g:Math.floor(255*e),b:Math.floor(255*k)}};m.HSVToHex=function(a,b,c){a=m.HSVToRGB(a,
b,c);return m.RGBToHex(a.r,a.g,a.b)};m.hexToHSV=function(a){a=m.hexToRGB(a);return m.RGBToHSV(a.r,a.g,a.b)};m.isValidHex=function(a){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a)};n.prototype.on=function(a,b){var c=this.subscribers[a];c||(c=[],this.subscribers[a]=c);c.push({callback:b})};n.prototype.subscribe=n.prototype.on;n.prototype.off=function(a,b){var c=this.subscribers[a];c&&(this.subscribers[a]=c.filter(function(a){return a.callback!=b}))};n.prototype.unsubscribe=n.prototype.off;n.prototype._trigger=
function(a,b,c){if("*"==a)throw Error("Cannot trigger event *");var d=[];a in this.subscribers&&(d=d.concat(this.subscribers[a]));"*"in this.subscribers&&(d=d.concat(this.subscribers["*"]));for(var e=0;e<d.length;e++){var k=d[e];k.callback&&k.callback(a,b,c||null)}};n.prototype.add=function(a,b){var c=[],d;if(a instanceof Array)for(var e=0,k=a.length;e<k;e++)d=this._addItem(a[e]),c.push(d);else if(m.isDataTable(a))for(var e=this._getColumnNames(a),k=0,l=a.getNumberOfRows();k<l;k++){d={};for(var C=
0,f=e.length;C<f;C++)d[e[C]]=a.getValue(k,C);d=this._addItem(d);c.push(d)}else if(a instanceof Object)d=this._addItem(a),c.push(d);else throw Error("Unknown dataType");c.length&&this._trigger("add",{items:c},b);return c};n.prototype.update=function(a,b){var c=[],d=[],e=this,k=e.fieldId,l=function(a){var b=a[k];e.data[b]?(b=e._updateItem(a),d.push(b)):(b=e._addItem(a),c.push(b))};if(a instanceof Array)for(var C=0,f=a.length;C<f;C++)l(a[C]);else if(m.isDataTable(a))for(var C=this._getColumnNames(a),
f=0,g=a.getNumberOfRows();f<g;f++){for(var h={},p=0,s=C.length;p<s;p++)h[C[p]]=a.getValue(f,p);l(h)}else if(a instanceof Object)l(a);else throw Error("Unknown dataType");c.length&&this._trigger("add",{items:c},b);d.length&&this._trigger("update",{items:d},b);return c.concat(d)};n.prototype.get=function(a,b,c){var d=this.showInternalIds,e,k,l=m.getType(a);"String"==l||"Number"==l?(e=a,a=b,b=c):"Array"==l&&(k=a,a=b,b=c);if(a&&a.type){l="DataTable"==a.type?"DataTable":"Array";if(b&&l!=m.getType(b))throw Error('Type of parameter "data" ('+
m.getType(b)+") does not correspond with specified options.type ("+a.type+")");if("DataTable"==l&&!m.isDataTable(b))throw Error('Parameter "data" must be a DataTable when options.type is "DataTable"');}else l=b?"DataTable"==m.getType(b)?"DataTable":"Array":"Array";void 0!=a&&void 0!=a.showInternalIds&&(this.showInternalIds=a.showInternalIds);var C=a&&a.convert||this.options.convert,f=a&&a.filter;c=[];var g,h,p;if(void 0!=e)g=this._getItem(e,C),f&&!f(g)&&(g=null);else if(void 0!=k){h=0;for(p=k.length;h<
p;h++)g=this._getItem(k[h],C),(!f||f(g))&&c.push(g)}else for(h in this.data)this.data.hasOwnProperty(h)&&(g=this._getItem(h,C),(!f||f(g))&&c.push(g));this.showInternalIds=d;a&&(a.order&&void 0==e)&&this._sort(c,a.order);if(a&&a.fields)if(d=a.fields,void 0!=e)g=this._filterFields(g,d);else{h=0;for(p=c.length;h<p;h++)c[h]=this._filterFields(c[h],d)}if("DataTable"==l){d=this._getColumnNames(b);if(void 0!=e)this._appendRow(b,d,g);else{h=0;for(p=c.length;h<p;h++)this._appendRow(b,d,c[h])}return b}if(void 0!=
e)return g;if(b){h=0;for(p=c.length;h<p;h++)b.push(c[h]);return b}return c};n.prototype.getIds=function(a){var b=this.data,c=a&&a.filter,d=a&&a.order,e=a&&a.convert||this.options.convert,k,l,C=[];if(c)if(d){a=[];for(k in b)b.hasOwnProperty(k)&&(l=this._getItem(k,e),c(l)&&a.push(l));this._sort(a,d);b=0;for(c=a.length;b<c;b++)C[b]=a[b][this.fieldId]}else for(k in b)b.hasOwnProperty(k)&&(l=this._getItem(k,e),c(l)&&C.push(l[this.fieldId]));else if(d){a=[];for(k in b)b.hasOwnProperty(k)&&a.push(b[k]);
this._sort(a,d);b=0;for(c=a.length;b<c;b++)C[b]=a[b][this.fieldId]}else for(k in b)b.hasOwnProperty(k)&&(l=b[k],C.push(l[this.fieldId]));return C};n.prototype.forEach=function(a,b){var c=b&&b.filter,d=b&&b.convert||this.options.convert,e=this.data,k,l;if(b&&b.order){c=this.get(b);d=0;for(e=c.length;d<e;d++)k=c[d],l=k[this.fieldId],a(k,l)}else for(l in e)e.hasOwnProperty(l)&&(k=this._getItem(l,d),(!c||c(k))&&a(k,l))};n.prototype.map=function(a,b){var c=b&&b.filter,d=b&&b.convert||this.options.convert,
e=[],k=this.data,l,C;for(C in k)k.hasOwnProperty(C)&&(l=this._getItem(C,d),(!c||c(l))&&e.push(a(l,C)));b&&b.order&&this._sort(e,b.order);return e};n.prototype._filterFields=function(a,b){var c={},d;for(d in a)a.hasOwnProperty(d)&&-1!=b.indexOf(d)&&(c[d]=a[d]);return c};n.prototype._sort=function(a,b){if(m.isString(b))a.sort(function(a,d){var e=a[b],k=d[b];return e>k?1:e<k?-1:0});else if("function"===typeof b)a.sort(b);else throw new TypeError("Order must be a function or a string");};n.prototype.remove=
function(a,b){var c=[],d,e,k;if(a instanceof Array){d=0;for(e=a.length;d<e;d++)k=this._remove(a[d]),null!=k&&c.push(k)}else k=this._remove(a),null!=k&&c.push(k);c.length&&this._trigger("remove",{items:c},b);return c};n.prototype._remove=function(a){if(m.isNumber(a)||m.isString(a)){if(this.data[a])return delete this.data[a],delete this.internalIds[a],a}else if(a instanceof Object&&(a=a[this.fieldId])&&this.data[a])return delete this.data[a],delete this.internalIds[a],a;return null};n.prototype.clear=
function(a){var b=Object.keys(this.data);this.data={};this.internalIds={};this._trigger("remove",{items:b},a);return b};n.prototype.max=function(a){var b=this.data,c=null,d=null,e;for(e in b)if(b.hasOwnProperty(e)){var k=b[e],l=k[a];if(null!=l&&(!c||l>d))c=k,d=l}return c};n.prototype.min=function(a){var b=this.data,c=null,d=null,e;for(e in b)if(b.hasOwnProperty(e)){var k=b[e],l=k[a];if(null!=l&&(!c||l<d))c=k,d=l}return c};n.prototype.distinct=function(a){var b=this.data,c=[],d=this.options.convert[a],
e=0,k;for(k in b)if(b.hasOwnProperty(k)){for(var l=m.convert(b[k][a],d),C=!1,f=0;f<e;f++)if(c[f]==l){C=!0;break}C||(c[e]=l,e++)}return c};n.prototype._addItem=function(a){var b=a[this.fieldId];if(void 0!=b){if(this.data[b])throw Error("Cannot add item: item with id "+b+" already exists");}else b=m.randomUUID(),a[this.fieldId]=b,this.internalIds[b]=a;var c={},d;for(d in a)a.hasOwnProperty(d)&&(c[d]=m.convert(a[d],this.convert[d]));this.data[b]=c;return b};n.prototype._getItem=function(a,b){var c,d,
e=this.data[a];if(!e)return null;var k={},l=this.fieldId,f=this.internalIds;if(b)for(c in e){if(e.hasOwnProperty(c)&&(d=e[c],c!=l||!(d in f)||this.showInternalIds))k[c]=m.convert(d,b[c])}else for(c in e)if(e.hasOwnProperty(c)&&(d=e[c],c!=l||!(d in f)||this.showInternalIds))k[c]=d;return k};n.prototype._updateItem=function(a){var b=a[this.fieldId];if(void 0==b)throw Error("Cannot update item: item has no id (item: "+JSON.stringify(a)+")");var c=this.data[b];if(!c)throw Error("Cannot update item: no item with id "+
b+" found");for(var d in a)a.hasOwnProperty(d)&&(c[d]=m.convert(a[d],this.convert[d]));return b};n.prototype.isInternalId=function(a){return a in this.internalIds};n.prototype._getColumnNames=function(a){for(var b=[],c=0,d=a.getNumberOfColumns();c<d;c++)b[c]=a.getColumnId(c)||a.getColumnLabel(c);return b};n.prototype._appendRow=function(a,b,c){for(var d=a.addRow(),e=0,k=b.length;e<k;e++)a.setValue(d,e,c[b[e]])};u.prototype.setData=function(a){var b,c;if(this.data){this.data.unsubscribe&&this.data.unsubscribe("*",
this.listener);b=[];for(var d in this.ids)this.ids.hasOwnProperty(d)&&b.push(d);this.ids={};this._trigger("remove",{items:b})}if(this.data=a){this.fieldId=this.options.fieldId||this.data&&this.data.options&&this.data.options.fieldId||"id";b=this.data.getIds({filter:this.options&&this.options.filter});a=0;for(c=b.length;a<c;a++)d=b[a],this.ids[d]=!0;this._trigger("add",{items:b});if(this.data.on)this.data.on("*",this.listener)}};u.prototype.get=function(a,b,c){var d=this,e,k,l=m.getType(a);"String"==
l||"Number"==l||"Array"==l?(e=a,k=b,a=c):(k=a,a=b);b=m.extend({},this.options,k);this.options.filter&&(k&&k.filter)&&(b.filter=function(a){return d.options.filter(a)&&k.filter(a)});c=[];void 0!=e&&c.push(e);c.push(b);c.push(a);return this.data&&this.data.get.apply(this.data,c)};u.prototype.getIds=function(a){var b;if(this.data){var c=this.options.filter;b=this.data.getIds({filter:a&&a.filter?c?function(b){return c(b)&&a.filter(b)}:a.filter:c,order:a&&a.order})}else b=[];return b};u.prototype._onEvent=
function(a,b,c){var d,e,k;b=b&&b.items;d=this.data;var l=[],f=[],g=[];if(b&&d){switch(a){case "add":a=0;for(d=b.length;a<d;a++)if(e=b[a],k=this.get(e))this.ids[e]=!0,l.push(e);break;case "update":a=0;for(d=b.length;a<d;a++)e=b[a],(k=this.get(e))?this.ids[e]?f.push(e):(this.ids[e]=!0,l.push(e)):this.ids[e]&&(delete this.ids[e],g.push(e));break;case "remove":a=0;for(d=b.length;a<d;a++)e=b[a],this.ids[e]&&(delete this.ids[e],g.push(e))}l.length&&this._trigger("add",{items:l},c);f.length&&this._trigger("update",
{items:f},c);g.length&&this._trigger("remove",{items:g},c)}};u.prototype.on=n.prototype.on;u.prototype.off=n.prototype.off;u.prototype._trigger=n.prototype._trigger;u.prototype.subscribe=u.prototype.on;u.prototype.unsubscribe=u.prototype.off;TimeStep=function(a,b,c){this.current=new Date;this._start=new Date;this._end=new Date;this.autoScale=!0;this.scale=TimeStep.SCALE.DAY;this.step=1;this.setRange(a,b,c)};TimeStep.SCALE={MILLISECOND:1,SECOND:2,MINUTE:3,HOUR:4,DAY:5,WEEKDAY:6,MONTH:7,YEAR:8};TimeStep.prototype.setRange=
function(a,b,c){if(!(a instanceof Date)||!(b instanceof Date))throw"No legal start or end date in method setRange";this._start=void 0!=a?new Date(a.valueOf()):new Date;this._end=void 0!=b?new Date(b.valueOf()):new Date;this.autoScale&&this.setMinimumStep(c)};TimeStep.prototype.first=function(){this.current=new Date(this._start.valueOf());this.roundToMinor()};TimeStep.prototype.roundToMinor=function(){switch(this.scale){case TimeStep.SCALE.YEAR:this.current.setFullYear(this.step*Math.floor(this.current.getFullYear()/
this.step)),this.current.setMonth(0);case TimeStep.SCALE.MONTH:this.current.setDate(1);case TimeStep.SCALE.DAY:case TimeStep.SCALE.WEEKDAY:this.current.setHours(0);case TimeStep.SCALE.HOUR:this.current.setMinutes(0);case TimeStep.SCALE.MINUTE:this.current.setSeconds(0);case TimeStep.SCALE.SECOND:this.current.setMilliseconds(0)}if(1!=this.step)switch(this.scale){case TimeStep.SCALE.MILLISECOND:this.current.setMilliseconds(this.current.getMilliseconds()-this.current.getMilliseconds()%this.step);break;
case TimeStep.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()-this.current.getSeconds()%this.step);break;case TimeStep.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()-this.current.getMinutes()%this.step);break;case TimeStep.SCALE.HOUR:this.current.setHours(this.current.getHours()-this.current.getHours()%this.step);break;case TimeStep.SCALE.WEEKDAY:case TimeStep.SCALE.DAY:this.current.setDate(this.current.getDate()-1-(this.current.getDate()-1)%this.step+1);break;case TimeStep.SCALE.MONTH:this.current.setMonth(this.current.getMonth()-
this.current.getMonth()%this.step);break;case TimeStep.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()-this.current.getFullYear()%this.step)}};TimeStep.prototype.hasNext=function(){return this.current.valueOf()<=this._end.valueOf()};TimeStep.prototype.next=function(){var a=this.current.valueOf();if(6>this.current.getMonth())switch(this.scale){case TimeStep.SCALE.MILLISECOND:this.current=new Date(this.current.valueOf()+this.step);break;case TimeStep.SCALE.SECOND:this.current=new Date(this.current.valueOf()+
1E3*this.step);break;case TimeStep.SCALE.MINUTE:this.current=new Date(this.current.valueOf()+6E4*this.step);break;case TimeStep.SCALE.HOUR:this.current=new Date(this.current.valueOf()+36E5*this.step);var b=this.current.getHours();this.current.setHours(b-b%this.step);break;case TimeStep.SCALE.WEEKDAY:case TimeStep.SCALE.DAY:this.current.setDate(this.current.getDate()+this.step);break;case TimeStep.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case TimeStep.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+
this.step)}else switch(this.scale){case TimeStep.SCALE.MILLISECOND:this.current=new Date(this.current.valueOf()+this.step);break;case TimeStep.SCALE.SECOND:this.current.setSeconds(this.current.getSeconds()+this.step);break;case TimeStep.SCALE.MINUTE:this.current.setMinutes(this.current.getMinutes()+this.step);break;case TimeStep.SCALE.HOUR:this.current.setHours(this.current.getHours()+this.step);break;case TimeStep.SCALE.WEEKDAY:case TimeStep.SCALE.DAY:this.current.setDate(this.current.getDate()+
this.step);break;case TimeStep.SCALE.MONTH:this.current.setMonth(this.current.getMonth()+this.step);break;case TimeStep.SCALE.YEAR:this.current.setFullYear(this.current.getFullYear()+this.step)}if(1!=this.step)switch(this.scale){case TimeStep.SCALE.MILLISECOND:this.current.getMilliseconds()<this.step&&this.current.setMilliseconds(0);break;case TimeStep.SCALE.SECOND:this.current.getSeconds()<this.step&&this.current.setSeconds(0);break;case TimeStep.SCALE.MINUTE:this.current.getMinutes()<this.step&&
this.current.setMinutes(0);break;case TimeStep.SCALE.HOUR:this.current.getHours()<this.step&&this.current.setHours(0);break;case TimeStep.SCALE.WEEKDAY:case TimeStep.SCALE.DAY:this.current.getDate()<this.step+1&&this.current.setDate(1);break;case TimeStep.SCALE.MONTH:this.current.getMonth()<this.step&&this.current.setMonth(0)}this.current.valueOf()==a&&(this.current=new Date(this._end.valueOf()))};TimeStep.prototype.getCurrent=function(){return this.current};TimeStep.prototype.setScale=function(a,
b){this.scale=a;0<b&&(this.step=b);this.autoScale=!1};TimeStep.prototype.setAutoScale=function(a){this.autoScale=a};TimeStep.prototype.setMinimumStep=function(a){void 0!=a&&(31104E9>a&&(this.scale=TimeStep.SCALE.YEAR,this.step=1E3),15552E9>a&&(this.scale=TimeStep.SCALE.YEAR,this.step=500),31104E8>a&&(this.scale=TimeStep.SCALE.YEAR,this.step=100),15552E8>a&&(this.scale=TimeStep.SCALE.YEAR,this.step=50),31104E7>a&&(this.scale=TimeStep.SCALE.YEAR,this.step=10),15552E7>a&&(this.scale=TimeStep.SCALE.YEAR,
this.step=5),31104E6>a&&(this.scale=TimeStep.SCALE.YEAR,this.step=1),7776E6>a&&(this.scale=TimeStep.SCALE.MONTH,this.step=3),2592E6>a&&(this.scale=TimeStep.SCALE.MONTH,this.step=1),432E6>a&&(this.scale=TimeStep.SCALE.DAY,this.step=5),1728E5>a&&(this.scale=TimeStep.SCALE.DAY,this.step=2),864E5>a&&(this.scale=TimeStep.SCALE.DAY,this.step=1),432E5>a&&(this.scale=TimeStep.SCALE.WEEKDAY,this.step=1),144E5>a&&(this.scale=TimeStep.SCALE.HOUR,this.step=4),36E5>a&&(this.scale=TimeStep.SCALE.HOUR,this.step=
1),9E5>a&&(this.scale=TimeStep.SCALE.MINUTE,this.step=15),6E5>a&&(this.scale=TimeStep.SCALE.MINUTE,this.step=10),3E5>a&&(this.scale=TimeStep.SCALE.MINUTE,this.step=5),6E4>a&&(this.scale=TimeStep.SCALE.MINUTE,this.step=1),15E3>a&&(this.scale=TimeStep.SCALE.SECOND,this.step=15),1E4>a&&(this.scale=TimeStep.SCALE.SECOND,this.step=10),5E3>a&&(this.scale=TimeStep.SCALE.SECOND,this.step=5),1E3>a&&(this.scale=TimeStep.SCALE.SECOND,this.step=1),200>a&&(this.scale=TimeStep.SCALE.MILLISECOND,this.step=200),
100>a&&(this.scale=TimeStep.SCALE.MILLISECOND,this.step=100),50>a&&(this.scale=TimeStep.SCALE.MILLISECOND,this.step=50),10>a&&(this.scale=TimeStep.SCALE.MILLISECOND,this.step=10),5>a&&(this.scale=TimeStep.SCALE.MILLISECOND,this.step=5),1>a&&(this.scale=TimeStep.SCALE.MILLISECOND,this.step=1))};TimeStep.prototype.snap=function(a){a=new Date(a.valueOf());if(this.scale==TimeStep.SCALE.YEAR){var b=a.getFullYear()+Math.round(a.getMonth()/12);a.setFullYear(Math.round(b/this.step)*this.step);a.setMonth(0);
a.setDate(0);a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0)}else if(this.scale==TimeStep.SCALE.MONTH)15<a.getDate()?(a.setDate(1),a.setMonth(a.getMonth()+1)):a.setDate(1),a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);else if(this.scale==TimeStep.SCALE.DAY||this.scale==TimeStep.SCALE.WEEKDAY){switch(this.step){case 5:case 2:a.setHours(24*Math.round(a.getHours()/24));break;default:a.setHours(12*Math.round(a.getHours()/12))}a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0)}else if(this.scale==
TimeStep.SCALE.HOUR){switch(this.step){case 4:a.setMinutes(60*Math.round(a.getMinutes()/60));break;default:a.setMinutes(30*Math.round(a.getMinutes()/30))}a.setSeconds(0);a.setMilliseconds(0)}else if(this.scale==TimeStep.SCALE.MINUTE){switch(this.step){case 15:case 10:a.setMinutes(5*Math.round(a.getMinutes()/5));a.setSeconds(0);break;case 5:a.setSeconds(60*Math.round(a.getSeconds()/60));break;default:a.setSeconds(30*Math.round(a.getSeconds()/30))}a.setMilliseconds(0)}else if(this.scale==TimeStep.SCALE.SECOND)switch(this.step){case 15:case 10:a.setSeconds(5*
Math.round(a.getSeconds()/5));a.setMilliseconds(0);break;case 5:a.setMilliseconds(1E3*Math.round(a.getMilliseconds()/1E3));break;default:a.setMilliseconds(500*Math.round(a.getMilliseconds()/500))}else this.scale==TimeStep.SCALE.MILLISECOND&&(b=5<this.step?this.step/2:1,a.setMilliseconds(Math.round(a.getMilliseconds()/b)*b));return a};TimeStep.prototype.isMajor=function(){switch(this.scale){case TimeStep.SCALE.MILLISECOND:return 0==this.current.getMilliseconds();case TimeStep.SCALE.SECOND:return 0==
this.current.getSeconds();case TimeStep.SCALE.MINUTE:return 0==this.current.getHours()&&0==this.current.getMinutes();case TimeStep.SCALE.HOUR:return 0==this.current.getHours();case TimeStep.SCALE.WEEKDAY:case TimeStep.SCALE.DAY:return 1==this.current.getDate();case TimeStep.SCALE.MONTH:return 0==this.current.getMonth();case TimeStep.SCALE.YEAR:return!1;default:return!1}};TimeStep.prototype.getLabelMinor=function(a){void 0==a&&(a=this.current);switch(this.scale){case TimeStep.SCALE.MILLISECOND:return F(a).format("SSS");
case TimeStep.SCALE.SECOND:return F(a).format("s");case TimeStep.SCALE.MINUTE:return F(a).format("HH:mm");case TimeStep.SCALE.HOUR:return F(a).format("HH:mm");case TimeStep.SCALE.WEEKDAY:return F(a).format("ddd D");case TimeStep.SCALE.DAY:return F(a).format("D");case TimeStep.SCALE.MONTH:return F(a).format("MMM");case TimeStep.SCALE.YEAR:return F(a).format("YYYY");default:return""}};TimeStep.prototype.getLabelMajor=function(a){void 0==a&&(a=this.current);switch(this.scale){case TimeStep.SCALE.MILLISECOND:return F(a).format("HH:mm:ss");
case TimeStep.SCALE.SECOND:return F(a).format("D MMMM HH:mm");case TimeStep.SCALE.MINUTE:case TimeStep.SCALE.HOUR:return F(a).format("ddd D MMMM");case TimeStep.SCALE.WEEKDAY:case TimeStep.SCALE.DAY:return F(a).format("MMMM YYYY");case TimeStep.SCALE.MONTH:return F(a).format("YYYY");case TimeStep.SCALE.YEAR:return"";default:return""}};A.prototype.setOptions=function(a){m.extend(this.options,a)};A.prototype.update=function(){this._order();this._stack()};A.prototype._order=function(){var a=this.itemset.items;
if(!a)throw Error("Cannot stack items: ItemSet does not contain items");var b=[],c=0;m.forEach(a,function(a){a.visible&&(b[c]=a,c++)});a=this.options.order||this.defaultOptions.order;if("function"!==typeof a)throw Error("Option order must be a function");b.sort(a);this.ordered=b};A.prototype._stack=function(){var a,b,c=this.ordered;a=this.options;var d="top"==(a.orientation||this.defaultOptions.orientation),e;e=a.margin&&void 0!==a.margin.item?a.margin.item:this.defaultOptions.margin.item;a=0;for(b=
c.length;a<b;a++){var k=c[a],l=null;do l=this.checkOverlap(c,a,0,a-1,e),null!=l&&(k.top=d?l.top+l.height+e:l.top-k.height-e);while(l)}};A.prototype.checkOverlap=function(a,b,c,d,e){for(var k=this.collision,l=a[b];d>=c;d--){var f=a[d];if(k(l,f,e)&&d!=b)return f}return null};A.prototype.collision=function(a,b,c){return a.left-c<b.left+b.width&&a.left+a.width+c>b.left&&a.top-c<b.top+b.height&&a.top+a.height+c>b.top};aa(g.prototype);g.prototype.setOptions=function(a){m.extend(this.options,a);null!==this.start&&
null!==this.end&&this.setRange(this.start,this.end)};g.prototype.subscribe=function(a,b,c,d){var e=this;if("move"==c)a.on("dragstart",function(a){e._onDragStart(a,b)}),a.on("drag",function(a){e._onDrag(a,b,d)}),a.on("dragend",function(a){e._onDragEnd(a,b)}),a.on("hold",function(a){e._onHold()});else if("zoom"==c)c=function(a){e._onMouseWheel(a,b,d)},a.on("mousewheel",c),a.on("DOMMouseScroll",c),a.on("touch",function(a){e._onTouch(a)}),a.on("pinch",function(a){e._onPinch(a,b,d)});else throw new TypeError('Unknown event "'+
c+'". Choose "move" or "zoom".');};g.prototype.setRange=function(a,b){if(this._applyRange(a,b)){var c={start:this.start,end:this.end};this.emit("rangechange",c);this.emit("rangechanged",c)}};g.prototype._applyRange=function(a,b){var c=null!=a?m.convert(a,"Date").valueOf():this.start,d=null!=b?m.convert(b,"Date").valueOf():this.end,e=null!=this.options.max?m.convert(this.options.max,"Date").valueOf():null,k=null!=this.options.min?m.convert(this.options.min,"Date").valueOf():null,l;if(isNaN(c)||null===
c)throw Error('Invalid start "'+a+'"');if(isNaN(d)||null===d)throw Error('Invalid end "'+b+'"');d<c&&(d=c);null!==k&&c<k&&(l=k-c,c+=l,d+=l,null!=e&&d>e&&(d=e));null!==e&&d>e&&(l=d-e,c-=l,d-=l,null!=k&&c<k&&(c=k));null!==this.options.zoomMin&&(e=parseFloat(this.options.zoomMin),0>e&&(e=0),d-c<e&&(this.end-this.start===e?(c=this.start,d=this.end):(l=e-(d-c),c-=l/2,d+=l/2)));null!==this.options.zoomMax&&(e=parseFloat(this.options.zoomMax),0>e&&(e=0),d-c>e&&(this.end-this.start===e?(c=this.start,d=this.end):
(l=d-c-e,c+=l/2,d-=l/2)));e=this.start!=c||this.end!=d;this.start=c;this.end=d;return e};g.prototype.getRange=function(){return{start:this.start,end:this.end}};g.prototype.conversion=function(a){return g.conversion(this.start,this.end,a)};g.conversion=function(a,b,c){return 0!=c&&0!=b-a?{offset:a,scale:c/(b-a)}:{offset:0,scale:1}};var L={};g.prototype._onDragStart=function(a,b){if(!L.ignore){L.start=this.start;L.end=this.end;var c=b.frame;c&&(c.style.cursor="move")}};g.prototype._onDrag=function(a,
b,c){S(c);L.ignore||(a=-("horizontal"==c?a.gesture.deltaX:a.gesture.deltaY)/("horizontal"==c?b.width:b.height)*(L.end-L.start),this._applyRange(L.start+a,L.end+a),this.emit("rangechange",{start:this.start,end:this.end}))};g.prototype._onDragEnd=function(a,b){L.ignore||(b.frame&&(b.frame.style.cursor="auto"),this.emit("rangechanged",{start:this.start,end:this.end}))};g.prototype._onMouseWheel=function(a,b,c){S(c);var d=0;a.wheelDelta?d=a.wheelDelta/120:a.detail&&(d=-a.detail/3);if(d){var d=0>d?1-d/
5:1/(1+d/5),e=m.fakeGesture(this,a),e=J(e.center,b.frame);b=this._pointerToDate(b,c,e);this.zoom(d,b)}a.preventDefault()};g.prototype._onTouch=function(a){L.start=this.start;L.end=this.end;L.ignore=!1;L.center=null;if((a=q.itemFromTarget(a))&&a.selected&&this.options.editable)L.ignore=!0};g.prototype._onHold=function(){L.ignore=!0};g.prototype._onPinch=function(a,b,c){L.ignore=!0;if(1<a.gesture.touches.length){L.center||(L.center=J(a.gesture.center,b.frame));var d=1/a.gesture.scale,e=this._pointerToDate(b,
c,L.center);a=J(a.gesture.center,b.frame);this._pointerToDate(b,c,a);b=parseInt(e+(L.start-e)*d);d=parseInt(e+(L.end-e)*d);this.setRange(b,d)}};g.prototype._pointerToDate=function(a,b,c){if("horizontal"==b)return a=this.conversion(a.width),c.x/a.scale+a.offset;a=this.conversion(a.height);return c.y/a.scale+a.offset};g.prototype.zoom=function(a,b){null==b&&(b=(this.start+this.end)/2);this.setRange(b+(this.start-b)*a,b+(this.end-b)*a)};g.prototype.move=function(a){var b=this.end-this.start,c=this.end+
b*a;this.start+=b*a;this.end=c};g.prototype.moveTo=function(a){a=(this.start+this.end)/2-a;this.setRange(this.start-a,this.end-a)};aa(E.prototype);E.prototype.add=function(a){if(void 0==a.id)throw Error("Component has no field id");if(!(a instanceof f)&&!(a instanceof E))throw new TypeError("Component must be an instance of prototype Component or Controller");a.setController(this);this.components[a.id]=a};E.prototype.remove=function(a){for(var b in this.components)if(this.components.hasOwnProperty(b)&&
(b==a||this.components[b]===a))break;b&&(this.components[b].setController(null),delete this.components[b])};E.prototype.repaint=function(){function a(d,e){e in c||(d.depends&&d.depends.forEach(function(b){a(b,b.id)}),d.parent&&a(d.parent,d.parent.id),b=d.repaint()||b,c[e]=!0)}var b=!1;this.repaintTimer&&(clearTimeout(this.repaintTimer),this.repaintTimer=void 0);var c={};m.forEach(this.components,a);this.emit("repaint");b&&this.reflow()};E.prototype.reflow=function(){function a(d,e){e in c||(d.depends&&
d.depends.forEach(function(b){a(b,b.id)}),d.parent&&a(d.parent,d.parent.id),b=d.reflow()||b,c[e]=!0)}var b=!1;this.reflowTimer&&(clearTimeout(this.reflowTimer),this.reflowTimer=void 0);var c={};m.forEach(this.components,a);this.emit("reflow");b&&this.repaint()};f.prototype.setOptions=function(a){a&&(m.extend(this.options,a),this.controller&&(this.requestRepaint(),this.requestReflow()))};f.prototype.getOption=function(a){var b;this.options&&(b=this.options[a]);void 0===b&&this.defaultOptions&&(b=this.defaultOptions[a]);
return b};f.prototype.setController=function(a){this.controller=a||null};f.prototype.getController=function(){return this.controller};f.prototype.getContainer=function(){return null};f.prototype.getFrame=function(){return this.frame};f.prototype.repaint=function(){return!1};f.prototype.reflow=function(){return!1};f.prototype.hide=function(){return this.frame&&this.frame.parentNode?(this.frame.parentNode.removeChild(this.frame),!0):!1};f.prototype.show=function(){return!this.frame||!this.frame.parentNode?
this.repaint():!1};f.prototype.requestRepaint=function(){if(this.controller)this.controller.emit("request-repaint");else throw Error("Cannot request a repaint: no controller configured");};f.prototype.requestReflow=function(){if(this.controller)this.controller.emit("request-reflow");else throw Error("Cannot request a reflow: no controller configured");};h.prototype=new f;h.prototype.setOptions=f.prototype.setOptions;h.prototype.getContainer=function(){return this.frame};h.prototype.repaint=function(){var a=
0,b=m.updateProperty,c=m.option.asSize,d=this.options,e=this.frame;if(!e){e=document.createElement("div");e.className="vpanel";var k=d.className;k&&("function"==typeof k?m.addClassName(e,String(k())):m.addClassName(e,String(k)));this.frame=e;a+=1}if(!e.parentNode){if(!this.parent)throw Error("Cannot repaint panel: no parent attached");k=this.parent.getContainer();if(!k)throw Error("Cannot repaint panel: parent has no container element");k.appendChild(e);a+=1}a+=b(e.style,"top",c(d.top,"0px"));a+=
b(e.style,"left",c(d.left,"0px"));a+=b(e.style,"width",c(d.width,"100%"));a+=b(e.style,"height",c(d.height,"100%"));return 0<a};h.prototype.reflow=function(){var a=0,b=m.updateProperty,c=this.frame;c?(a+=b(this,"top",c.offsetTop),a+=b(this,"left",c.offsetLeft),a+=b(this,"width",c.offsetWidth),a+=b(this,"height",c.offsetHeight)):a+=1;return 0<a};s.prototype=new h;s.prototype.setOptions=f.prototype.setOptions;s.prototype.repaint=function(){var a=0,b=m.updateProperty,c=m.option.asSize,d=this.options,
e=this.frame;e||(this.frame=e=document.createElement("div"),this._registerListeners(),a+=1);if(!e.parentNode){if(!this.container)throw Error("Cannot repaint root panel: no container attached");this.container.appendChild(e);a+=1}e.className="vis timeline rootpanel "+d.orientation+(d.editable?" editable":"");var k=d.className;k&&m.addClassName(e,m.option.asString(k));a+=b(e.style,"top",c(d.top,"0px"));a+=b(e.style,"left",c(d.left,"0px"));a+=b(e.style,"width",c(d.width,"100%"));a+=b(e.style,"height",
c(d.height,"100%"));this._updateWatch();return 0<a};s.prototype.reflow=function(){var a=0,b=m.updateProperty,c=this.frame;c?(a+=b(this,"top",c.offsetTop),a+=b(this,"left",c.offsetLeft),a+=b(this,"width",c.offsetWidth),a+=b(this,"height",c.offsetHeight)):a+=1;return 0<a};s.prototype._updateWatch=function(){this.getOption("autoResize")?this._watch():this._unwatch()};s.prototype._watch=function(){var a=this;this._unwatch();var b=function(){a.getOption("autoResize")?a.frame&&(a.frame.clientWidth!=a.width||
a.frame.clientHeight!=a.height)&&a.requestReflow():a._unwatch()};m.addEventListener(window,"resize",b);this.watchTimer=setInterval(b,1E3)};s.prototype._unwatch=function(){this.watchTimer&&(clearInterval(this.watchTimer),this.watchTimer=void 0)};s.prototype.setController=function(a){(this.controller=a||null)?this._registerListeners():this._unregisterListeners()};s.prototype._registerListeners=function(){if(this.frame&&this.controller&&!this.hammer){this.hammer=T(this.frame,{prevent_default:!0});for(var a in this.listeners)if(this.listeners.hasOwnProperty(a))this.hammer.on(a,
this.listeners[a])}};s.prototype._unregisterListeners=function(){if(this.hammer){for(var a in this.listeners)this.listeners.hasOwnProperty(a)&&this.hammer.off(a,this.listeners[a]);this.hammer=null}};B.prototype=new f;B.prototype.setOptions=f.prototype.setOptions;B.prototype.setRange=function(a){if(!(a instanceof g)&&(!a||!a.start||!a.end))throw new TypeError("Range must be an instance of Range, or an object containing start and end.");this.range=a};B.prototype.toTime=function(a){var b=this.conversion;
return new Date(a/b.scale+b.offset)};B.prototype.toScreen=function(a){var b=this.conversion;return(a.valueOf()-b.offset)*b.scale};B.prototype.repaint=function(){var a=0,b=m.updateProperty,c=m.option.asSize,d=this.options,e=this.getOption("orientation"),k=this.props,l=this.step,f=this.frame;f||(this.frame=f=document.createElement("div"),a+=1);f.className="axis";if(!f.parentNode){if(!this.parent)throw Error("Cannot repaint time axis: no parent attached");var g=this.parent.getContainer();if(!g)throw Error("Cannot repaint time axis: parent has no container element");
g.appendChild(f);a+=1}if(g=f.parentNode){var h=f.nextSibling;g.removeChild(f);a+=b(f.style,"top",c(d.top,"bottom"==e&&this.props.parentHeight&&this.height?this.props.parentHeight-this.height+"px":"0px"));a+=b(f.style,"left",c(d.left,"0px"));a+=b(f.style,"width",c(d.width,"100%"));a+=b(f.style,"height",c(d.height,this.height+"px"));this._repaintMeasureChars();if(this.step){this._repaintStart();l.first();b=void 0;for(c=0;l.hasNext()&&1E3>c;)c++,d=l.getCurrent(),d=this.toScreen(d),e=l.isMajor(),this.getOption("showMinorLabels")&&
this._repaintMinorText(d,l.getLabelMinor()),e&&this.getOption("showMajorLabels")?(0<d&&(void 0==b&&(b=d),this._repaintMajorText(d,l.getLabelMajor())),this._repaintMajorLine(d)):this._repaintMinorLine(d),l.next();this.getOption("showMajorLabels")&&(c=this.toTime(0),l=l.getLabelMajor(c),k=l.length*(k.majorCharWidth||10)+10,(void 0==b||k<b)&&this._repaintMajorText(0,l));this._repaintEnd()}this._repaintLine();h?g.insertBefore(f,h):g.appendChild(f)}return 0<a};B.prototype._repaintStart=function(){var a=
this.dom,b=a.redundant;b.majorLines=a.majorLines;b.majorTexts=a.majorTexts;b.minorLines=a.minorLines;b.minorTexts=a.minorTexts;a.majorLines=[];a.majorTexts=[];a.minorLines=[];a.minorTexts=[]};B.prototype._repaintEnd=function(){m.forEach(this.dom.redundant,function(a){for(;a.length;){var b=a.pop();b&&b.parentNode&&b.parentNode.removeChild(b)}})};B.prototype._repaintMinorText=function(a,b){var c=this.dom.redundant.minorTexts.shift();if(!c){var d=document.createTextNode(""),c=document.createElement("div");
c.appendChild(d);c.className="text minor";this.frame.appendChild(c)}this.dom.minorTexts.push(c);c.childNodes[0].nodeValue=b;c.style.left=a+"px";c.style.top=this.props.minorLabelTop+"px"};B.prototype._repaintMajorText=function(a,b){var c=this.dom.redundant.majorTexts.shift();if(!c){var d=document.createTextNode(b),c=document.createElement("div");c.className="text major";c.appendChild(d);this.frame.appendChild(c)}this.dom.majorTexts.push(c);c.childNodes[0].nodeValue=b;c.style.top=this.props.majorLabelTop+
"px";c.style.left=a+"px"};B.prototype._repaintMinorLine=function(a){var b=this.dom.redundant.minorLines.shift();b||(b=document.createElement("div"),b.className="grid vertical minor",this.frame.appendChild(b));this.dom.minorLines.push(b);var c=this.props;b.style.top=c.minorLineTop+"px";b.style.height=c.minorLineHeight+"px";b.style.left=a-c.minorLineWidth/2+"px"};B.prototype._repaintMajorLine=function(a){var b=this.dom.redundant.majorLines.shift();b||(b=document.createElement("DIV"),b.className="grid vertical major",
this.frame.appendChild(b));this.dom.majorLines.push(b);var c=this.props;b.style.top=c.majorLineTop+"px";b.style.left=a-c.majorLineWidth/2+"px";b.style.height=c.majorLineHeight+"px"};B.prototype._repaintLine=function(){var a=this.dom.line,b=this.frame;this.getOption("showMinorLabels")||this.getOption("showMajorLabels")?(a?(b.removeChild(a),b.appendChild(a)):(a=document.createElement("div"),a.className="grid horizontal major",b.appendChild(a),this.dom.line=a),a.style.top=this.props.lineTop+"px"):a&&
a.parentElement&&(b.removeChild(a.line),delete this.dom.line)};B.prototype._repaintMeasureChars=function(){var a=this.dom,b;if(!a.measureCharMinor){b=document.createTextNode("0");var c=document.createElement("DIV");c.className="text minor measure";c.appendChild(b);this.frame.appendChild(c);a.measureCharMinor=c}a.measureCharMajor||(b=document.createTextNode("0"),c=document.createElement("DIV"),c.className="text major measure",c.appendChild(b),this.frame.appendChild(c),a.measureCharMajor=c)};B.prototype.reflow=
function(){var a=0,b=m.updateProperty,c=this.frame,d=this.range;if(!d)throw Error("Cannot repaint time axis: no range configured");if(c){var a=a+b(this,"top",c.offsetTop),a=a+b(this,"left",c.offsetLeft),e=this.props,k=this.getOption("showMinorLabels"),l=this.getOption("showMajorLabels"),f=this.dom.measureCharMinor,g=this.dom.measureCharMajor;f&&(e.minorCharHeight=f.clientHeight,e.minorCharWidth=f.clientWidth);g&&(e.majorCharHeight=g.clientHeight,e.majorCharWidth=g.clientWidth);f=c.parentNode?c.parentNode.offsetHeight:
0;f!=e.parentHeight&&(e.parentHeight=f,a+=1);switch(this.getOption("orientation")){case "bottom":e.minorLabelHeight=k?e.minorCharHeight:0;e.majorLabelHeight=l?e.majorCharHeight:0;e.minorLabelTop=0;e.majorLabelTop=e.minorLabelTop+e.minorLabelHeight;e.minorLineTop=-this.top;e.minorLineHeight=Math.max(this.top+e.majorLabelHeight,0);e.minorLineWidth=1;e.majorLineTop=-this.top;e.majorLineHeight=Math.max(this.top+e.minorLabelHeight+e.majorLabelHeight,0);e.majorLineWidth=1;e.lineTop=0;break;case "top":e.minorLabelHeight=
k?e.minorCharHeight:0;e.majorLabelHeight=l?e.majorCharHeight:0;e.majorLabelTop=0;e.minorLabelTop=e.majorLabelTop+e.majorLabelHeight;e.minorLineTop=e.minorLabelTop;e.minorLineHeight=Math.max(f-e.majorLabelHeight-this.top);e.minorLineWidth=1;e.majorLineTop=0;e.majorLineHeight=Math.max(f-this.top);e.majorLineWidth=1;e.lineTop=e.majorLabelHeight+e.minorLabelHeight;break;default:throw Error('Unkown orientation "'+this.getOption("orientation")+'"');}k=e.minorLabelHeight+e.majorLabelHeight;a+=b(this,"width",
c.offsetWidth);a+=b(this,"height",k);this._updateConversion();c=m.convert(d.start,"Number");d=m.convert(d.end,"Number");k=this.toTime(5*(e.minorCharWidth||10)).valueOf()-this.toTime(0).valueOf();this.step=new TimeStep(new Date(c),new Date(d),k);a+=b(e.range,"start",c);a+=b(e.range,"end",d);a+=b(e.range,"minimumStep",k.valueOf())}return 0<a};B.prototype._updateConversion=function(){var a=this.range;if(!a)throw Error("No range configured");this.conversion=a.conversion?a.conversion(this.width):g.conversion(a.start,
a.end,this.width)};B.prototype.snap=function(a){return this.step.snap(a)};Y.prototype=new f;Y.prototype.setOptions=f.prototype.setOptions;Y.prototype.getContainer=function(){return this.frame};Y.prototype.repaint=function(){var a=this.frame,b=this.parent,c=b.parent.getContainer();if(!b)throw Error("Cannot repaint bar: no parent attached");if(!c)throw Error("Cannot repaint bar: parent has no container element");if(!this.getOption("showCurrentTime"))return a&&(c.removeChild(a),delete this.frame),!1;
a||(a=document.createElement("div"),a.className="currenttime",a.style.position="absolute",a.style.top="0px",a.style.height="100%",c.appendChild(a),this.frame=a);b.conversion||b._updateConversion();var c=new Date,d=b.toScreen(c);a.style.left=d+"px";a.title="Current time: "+c;void 0!==this.currentTimeTimer&&(clearTimeout(this.currentTimeTimer),delete this.currentTimeTimer);var e=this,a=1/b.conversion.scale/2;30>a&&(a=30);this.currentTimeTimer=setTimeout(function(){e.repaint()},a);return!1};P.prototype=
new f;aa(P.prototype);P.prototype.setOptions=f.prototype.setOptions;P.prototype.getContainer=function(){return this.frame};P.prototype.repaint=function(){var a=this.frame,b=this.parent;if(!b)throw Error("Cannot repaint bar: no parent attached");var c=b.parent.getContainer();if(!c)throw Error("Cannot repaint bar: parent has no container element");if(!this.getOption("showCustomTime"))return a&&(c.removeChild(a),delete this.frame),!1;a||(a=document.createElement("div"),a.className="customtime",a.style.position=
"absolute",a.style.top="0px",a.style.height="100%",c.appendChild(a),c=document.createElement("div"),c.style.position="relative",c.style.top="0px",c.style.left="-10px",c.style.height="100%",c.style.width="20px",a.appendChild(c),this.frame=a,this.hammer=T(a,{prevent_default:!0}),this.hammer.on("dragstart",this._onDragStart.bind(this)),this.hammer.on("drag",this._onDrag.bind(this)),this.hammer.on("dragend",this._onDragEnd.bind(this)));b.conversion||b._updateConversion();b=b.toScreen(this.customTime);
a.style.left=b+"px";a.title="Time: "+this.customTime;return!1};P.prototype.setCustomTime=function(a){this.customTime=new Date(a.valueOf());this.repaint()};P.prototype.getCustomTime=function(){return new Date(this.customTime.valueOf())};P.prototype._onDragStart=function(a){this.eventParams.customTime=this.customTime;a.stopPropagation();a.preventDefault()};P.prototype._onDrag=function(a){var b=a.gesture.deltaX,b=this.parent.toScreen(this.eventParams.customTime)+b,b=this.parent.toTime(b);this.setCustomTime(b);
this.controller&&this.controller.emit("timechange",{time:this.customTime});a.stopPropagation();a.preventDefault()};P.prototype._onDragEnd=function(a){this.controller&&this.controller.emit("timechanged",{time:this.customTime});a.stopPropagation();a.preventDefault()};q.prototype=new h;q.types={box:N,range:G,rangeoverflow:U,point:x};q.prototype.setOptions=f.prototype.setOptions;q.prototype.setController=function(a){var b;if(this.controller)for(b in this.eventListeners)this.eventListeners.hasOwnProperty(b)&&
this.controller.off(b,this.eventListeners[b]);if(this.controller=a||null)for(b in this.eventListeners)if(this.eventListeners.hasOwnProperty(b))this.controller.on(b,this.eventListeners[b])};(function(a){Object.defineProperty(a,"controller",{get:function(){return null},set:function(a){}})})(this);q.prototype.setRange=function(a){if(!(a instanceof g)&&(!a||!a.start||!a.end))throw new TypeError("Range must be an instance of Range, or an object containing start and end.");this.range=a};q.prototype.setSelection=
function(a){var b,c,d,e;if(a){if(!Array.isArray(a))throw new TypeError("Array expected");b=0;for(c=this.selection.length;b<c;b++)d=this.selection[b],(e=this.items[d])&&e.unselect();this.selection=[];b=0;for(c=a.length;b<c;b++)if(d=a[b],e=this.items[d])this.selection.push(d),e.select();this.controller&&this.requestRepaint()}};q.prototype.getSelection=function(){return this.selection.concat([])};q.prototype._deselect=function(a){for(var b=this.selection,c=0,d=b.length;c<d;c++)if(b[c]==a){b.splice(c,
1);break}};q.prototype.repaint=function(){var a=0,b=m.updateProperty,c=m.option.asSize,d=this.options,e=this.getOption("orientation"),k=this.defaultOptions,l=this.frame;if(!l){l=document.createElement("div");l.className="itemset";l["timeline-itemset"]=this;var f=d.className;f&&m.addClassName(l,m.option.asString(f));f=document.createElement("div");f.className="background";l.appendChild(f);this.dom.background=f;f=document.createElement("div");f.className="foreground";l.appendChild(f);this.dom.foreground=
f;f=document.createElement("div");f.className="itemset-axis";this.dom.axis=f;this.frame=l;a+=1}if(!this.parent)throw Error("Cannot repaint itemset: no parent attached");f=this.parent.getContainer();if(!f)throw Error("Cannot repaint itemset: parent has no container element");l.parentNode||(f.appendChild(l),a+=1);this.dom.axis.parentNode||(f.appendChild(this.dom.axis),a+=1);a+=b(l.style,"left",c(d.left,"0px"));a+=b(l.style,"top",c(d.top,"0px"));a+=b(l.style,"width",c(d.width,"100%"));a+=b(l.style,"height",
c(d.height,this.height+"px"));a+=b(this.dom.axis.style,"left",c(d.left,"0px"));a+=b(this.dom.axis.style,"width",c(d.width,"100%"));a="bottom"==e?a+b(this.dom.axis.style,"top",this.height+this.top+"px"):a+b(this.dom.axis.style,"top",this.top+"px");this._updateConversion();var b=this.queue,c=this.itemsData,e=this.items,l={},g;for(g in b)if(b.hasOwnProperty(g)){var f=b[g],h=e[g],p=f.action;switch(p){case "add":case "update":if(p=c&&c.get(g,l)){var s=p.type||p.start&&p.end&&"range"||d.type||"box",r=q.types[s];
h&&(!r||!(h instanceof r)?(a+=h.hide(),h=null):(h.data=p,a++));if(!h)if(r)h=new r(this,p,d,k),h.id=f.id,a++;else throw new TypeError('Unknown item type "'+s+'"');h.repaint();e[g]=h}delete b[g];break;case "remove":h&&(h.selected&&this._deselect(g),a+=h.hide());delete e[g];delete b[g];break;default:console.log('Error: unknown action "'+p+'"')}}m.forEach(this.items,function(b){b.visible?(a+=b.show(),b.reposition()):a+=b.hide()});return 0<a};q.prototype.getForeground=function(){return this.dom.foreground};
q.prototype.getBackground=function(){return this.dom.background};q.prototype.getAxis=function(){return this.dom.axis};q.prototype.reflow=function(){var a=0,b=this.options,c=b.margin&&"axis"in b.margin?b.margin.axis:this.defaultOptions.margin.axis,d=b.margin&&"item"in b.margin?b.margin.item:this.defaultOptions.margin.item,e=m.updateProperty,k=m.option.asNumber,l=m.option.asSize,f=this.frame;if(f){this._updateConversion();m.forEach(this.items,function(b){a+=b.reflow()});this.stack.update();k=k(b.maxHeight);
if(null!=l(b.height))c=f.offsetHeight;else if(b=this.stack.ordered,b.length){var g=b[0].top,h=b[0].top+b[0].height;m.forEach(b,function(a){g=Math.min(g,a.top);h=Math.max(h,a.top+a.height)});c=h-g+c+d}else c+=d;null!=k&&(c=Math.min(c,k));a+=e(this,"height",c);a+=e(this,"top",f.offsetTop);a+=e(this,"left",f.offsetLeft);a+=e(this,"width",f.offsetWidth)}else a+=1;return 0<a};q.prototype.hide=function(){var a=!1;this.frame&&this.frame.parentNode&&(this.frame.parentNode.removeChild(this.frame),a=!0);this.dom.axis&&
this.dom.axis.parentNode&&(this.dom.axis.parentNode.removeChild(this.dom.axis),a=!0);return a};q.prototype.setItems=function(a){var b=this,c=this.itemsData;if(a)if(a instanceof n||a instanceof u)this.itemsData=a;else throw new TypeError("Data must be an instance of DataSet");else this.itemsData=null;c&&(m.forEach(this.listeners,function(a,b){c.unsubscribe(b,a)}),a=c.getIds(),this._onRemove(a));if(this.itemsData){var d=this.id;m.forEach(this.listeners,function(a,c){b.itemsData.on(c,a,d)});a=this.itemsData.getIds();
this._onAdd(a)}};q.prototype.getItems=function(){return this.itemsData};q.prototype.removeItem=function(a){a=this.itemsData.get(a);var b=this._myDataSet();if(a)this.options.onRemove(a,function(a){a&&b.remove(a)})};q.prototype._onUpdate=function(a){this._toQueue("update",a)};q.prototype._onAdd=function(a){this._toQueue("add",a)};q.prototype._onRemove=function(a){this._toQueue("remove",a)};q.prototype._toQueue=function(a,b){var c=this.queue;b.forEach(function(b){c[b]={id:b,action:a}});this.controller&&
this.requestRepaint()};q.prototype._updateConversion=function(){var a=this.range;if(!a)throw Error("No range configured");this.conversion=a.conversion?a.conversion(this.width):g.conversion(a.start,a.end,this.width)};q.prototype.toTime=function(a){var b=this.conversion;return new Date(a/b.scale+b.offset)};q.prototype.toScreen=function(a){var b=this.conversion;return(a.valueOf()-b.offset)*b.scale};q.prototype._onDragStart=function(a){if(this.options.editable){var b=q.itemFromTarget(a),c=this;if(b&&
b.selected){var d=a.target.dragLeftItem,e=a.target.dragRightItem;this.touchParams.itemProps=d?[{item:d,start:b.data.start.valueOf()}]:e?[{item:e,end:b.data.end.valueOf()}]:this.getSelection().map(function(a){a=c.items[a];var b={item:a};"start"in a.data&&(b.start=a.data.start.valueOf());"end"in a.data&&(b.end=a.data.end.valueOf());return b});a.stopPropagation()}}};q.prototype._onDrag=function(a){if(this.touchParams.itemProps){var b=this.options.snap||null,c=a.gesture.deltaX/this.conversion.scale;this.touchParams.itemProps.forEach(function(a){if("start"in
a){var e=new Date(a.start+c);a.item.data.start=b?b(e):e}"end"in a&&(e=new Date(a.end+c),a.item.data.end=b?b(e):e)});this.requestReflow();a.stopPropagation()}};q.prototype._onDragEnd=function(a){if(this.touchParams.itemProps){var b=[],c=this,d=this._myDataSet();this.touchParams.itemProps.forEach(function(a){var k=c.itemsData.get(a.item.id),l=!1;"start"in a.item.data&&(l=a.start!=a.item.data.start.valueOf(),k.start=m.convert(a.item.data.start,d.convert.start));"end"in a.item.data&&(l=l||a.end!=a.item.data.end.valueOf(),
k.end=m.convert(a.item.data.end,d.convert.end));if(l)c.options.onMove(k,function(d){d?b.push(d):("start"in a&&(a.item.data.start=a.start),"end"in a&&(a.item.data.end=a.end),c.requestReflow())})});this.touchParams.itemProps=null;b.length&&d.update(b);a.stopPropagation()}};q.itemFromTarget=function(a){for(a=a.target;a;){if(a.hasOwnProperty("timeline-item"))return a["timeline-item"];a=a.parentNode}return null};q.itemSetFromTarget=function(a){for(a=a.target;a;){if(a.hasOwnProperty("timeline-itemset"))return a["timeline-itemset"];
a=a.parentNode}return null};q.prototype._myDataSet=function(){for(var a=this.itemsData;a instanceof u;)a=a.data;return a};K.prototype.select=function(){this.selected=!0;this.visible&&this.repaint()};K.prototype.unselect=function(){this.selected=!1;this.visible&&this.repaint()};K.prototype.show=function(){return!1};K.prototype.hide=function(){return!1};K.prototype.repaint=function(){return!1};K.prototype.reflow=function(){return!1};K.prototype.setOffset=function(a){this.offset=a};K.prototype._repaintDeleteButton=
function(a){if(this.selected&&this.options.editable&&!this.dom.deleteButton){var b=this.parent,c=this.id,d=document.createElement("div");d.className="delete";d.title="Delete this item";T(d,{preventDefault:!0}).on("tap",function(a){b.removeItem(c);a.stopPropagation()});a.appendChild(d);this.dom.deleteButton=d}else!this.selected&&this.dom.deleteButton&&(this.dom.deleteButton.parentNode&&this.dom.deleteButton.parentNode.removeChild(this.dom.deleteButton),this.dom.deleteButton=null)};N.prototype=new K(null,
null);N.prototype.repaint=function(){var a=!1,b=this.dom;b||(this._create(),b=this.dom,a=!0);if(b){if(!this.parent)throw Error("Cannot repaint item: no parent attached");if(!b.box.parentNode){a=this.parent.getForeground();if(!a)throw Error("Cannot repaint time axis: parent has no foreground container element");a.appendChild(b.box);a=!0}if(!b.line.parentNode){var c=this.parent.getBackground();if(!c)throw Error("Cannot repaint time axis: parent has no background container element");c.appendChild(b.line);
a=!0}if(!b.dot.parentNode){a=this.parent.getAxis();if(!c)throw Error("Cannot repaint time axis: parent has no axis container element");a.appendChild(b.dot);a=!0}this._repaintDeleteButton(b.box);if(this.data.content!=this.content){this.content=this.data.content;if(this.content instanceof Element)b.content.innerHTML="",b.content.appendChild(this.content);else if(void 0!=this.data.content)b.content.innerHTML=this.content;else throw Error('Property "content" missing in item '+this.data.id);a=!0}c=(this.data.className?
" "+this.data.className:"")+(this.selected?" selected":"");this.className!=c&&(this.className=c,b.box.className="item box"+c,b.line.className="item line"+c,b.dot.className="item dot"+c,a=!0)}return a};N.prototype.show=function(){return!this.dom||!this.dom.box.parentNode?this.repaint():!1};N.prototype.hide=function(){var a=!1,b=this.dom;b&&(b.box.parentNode&&(b.box.parentNode.removeChild(b.box),a=!0),b.line.parentNode&&b.line.parentNode.removeChild(b.line),b.dot.parentNode&&b.dot.parentNode.removeChild(b.dot));
return a};N.prototype.reflow=function(){var a=0,b,c,d,e,k,l,f;if(void 0==this.data.start)throw Error('Property "start" missing in item '+this.data.id);b=this.data;d=this.parent&&this.parent.range;b&&d?(k=d.end-d.start,this.visible=b.start>d.start-k&&b.start<d.end+k):this.visible=!1;this.visible&&((c=this.dom)?(b=m.updateProperty,d=this.props,e=this.options,l=this.parent.toScreen(this.data.start)+this.offset,f=e.align||this.defaultOptions.align,k=e.margin&&e.margin.axis||this.defaultOptions.margin.axis,
e=e.orientation||this.defaultOptions.orientation,a+=b(d.dot,"height",c.dot.offsetHeight),a+=b(d.dot,"width",c.dot.offsetWidth),a+=b(d.line,"width",c.line.offsetWidth),a+=b(d.line,"height",c.line.offsetHeight),a+=b(d.line,"top",c.line.offsetTop),a+=b(this,"width",c.box.offsetWidth),a+=b(this,"height",c.box.offsetHeight),c="right"==f?l-this.width:"left"==f?l:l-this.width/2,a+=b(this,"left",c),a+=b(d.line,"left",l-d.line.width/2),a+=b(d.dot,"left",l-d.dot.width/2),a+=b(d.dot,"top",-d.dot.height/2),d=
"top"==e?k:this.parent.height-this.height-k,a+=b(this,"top",d)):a+=1);return 0<a};N.prototype._create=function(){var a=this.dom;a||(this.dom=a={},a.box=document.createElement("DIV"),a.content=document.createElement("DIV"),a.content.className="content",a.box.appendChild(a.content),a.line=document.createElement("DIV"),a.line.className="line",a.dot=document.createElement("DIV"),a.dot.className="dot",a.box["timeline-item"]=this)};N.prototype.reposition=function(){var a=this.dom,b=this.props,c=this.options.orientation||
this.defaultOptions.orientation;if(a){var d=a.box,e=a.line,a=a.dot;d.style.left=this.left+"px";d.style.top=this.top+"px";e.style.left=b.line.left+"px";"top"==c?(e.style.top="0px",e.style.height=this.top+"px"):(e.style.top=this.top+this.height+"px",e.style.height=Math.max(this.parent.height-this.top-this.height+this.props.dot.height/2,0)+"px");a.style.left=b.dot.left+"px";a.style.top=b.dot.top+"px"}};x.prototype=new K(null,null);x.prototype.repaint=function(){var a=!1,b=this.dom;b||(this._create(),
b=this.dom,a=!0);if(b){if(!this.parent)throw Error("Cannot repaint item: no parent attached");var c=this.parent.getForeground();if(!c)throw Error("Cannot repaint time axis: parent has no foreground container element");b.point.parentNode||(c.appendChild(b.point),c.appendChild(b.point),a=!0);if(this.data.content!=this.content){this.content=this.data.content;if(this.content instanceof Element)b.content.innerHTML="",b.content.appendChild(this.content);else if(void 0!=this.data.content)b.content.innerHTML=
this.content;else throw Error('Property "content" missing in item '+this.data.id);a=!0}this._repaintDeleteButton(b.point);c=(this.data.className?" "+this.data.className:"")+(this.selected?" selected":"");this.className!=c&&(this.className=c,b.point.className="item point"+c,a=!0)}return a};x.prototype.show=function(){return!this.dom||!this.dom.point.parentNode?this.repaint():!1};x.prototype.hide=function(){var a=!1,b=this.dom;b&&b.point.parentNode&&(b.point.parentNode.removeChild(b.point),a=!0);return a};
x.prototype.reflow=function(){var a=0,b,c,d,e,k,l;if(void 0==this.data.start)throw Error('Property "start" missing in item '+this.data.id);b=this.data;d=this.parent&&this.parent.range;if(this.visible=b&&d?b.start>d.start-(d.end-d.start)&&b.start<d.end:!1)(c=this.dom)?(b=m.updateProperty,d=this.props,e=this.options,l=e.orientation||this.defaultOptions.orientation,k=e.margin&&e.margin.axis||this.defaultOptions.margin.axis,e=this.parent.toScreen(this.data.start)+this.offset,a+=b(this,"width",c.point.offsetWidth),
a+=b(this,"height",c.point.offsetHeight),a+=b(d.dot,"width",c.dot.offsetWidth),a+=b(d.dot,"height",c.dot.offsetHeight),a+=b(d.content,"height",c.content.offsetHeight),c="top"==l?k:Math.max(this.parent.height-this.height-k,0),a+=b(this,"top",c),a+=b(this,"left",e-d.dot.width/2),a+=b(d.content,"marginLeft",1.5*d.dot.width),a+=b(d.dot,"top",(this.height-d.dot.height)/2)):a+=1;return 0<a};x.prototype._create=function(){var a=this.dom;a||(this.dom=a={},a.point=document.createElement("div"),a.content=document.createElement("div"),
a.content.className="content",a.point.appendChild(a.content),a.dot=document.createElement("div"),a.dot.className="dot",a.point.appendChild(a.dot),a.point["timeline-item"]=this)};x.prototype.reposition=function(){var a=this.dom,b=this.props;a&&(a.point.style.top=this.top+"px",a.point.style.left=this.left+"px",a.content.style.marginLeft=b.content.marginLeft+"px",a.dot.style.top=b.dot.top+"px")};G.prototype=new K(null,null);G.prototype.repaint=function(){var a=!1,b=this.dom;b||(this._create(),b=this.dom,
a=!0);if(b){if(!this.parent)throw Error("Cannot repaint item: no parent attached");var c=this.parent.getForeground();if(!c)throw Error("Cannot repaint time axis: parent has no foreground container element");b.box.parentNode||(c.appendChild(b.box),a=!0);if(this.data.content!=this.content){this.content=this.data.content;if(this.content instanceof Element)b.content.innerHTML="",b.content.appendChild(this.content);else if(void 0!=this.data.content)b.content.innerHTML=this.content;else throw Error('Property "content" missing in item '+
this.data.id);a=!0}this._repaintDeleteButton(b.box);this._repaintDragLeft();this._repaintDragRight();c=(this.data.className?" "+this.data.className:"")+(this.selected?" selected":"");this.className!=c&&(this.className=c,b.box.className="item range"+c,a=!0)}return a};G.prototype.show=function(){return!this.dom||!this.dom.box.parentNode?this.repaint():!1};G.prototype.hide=function(){var a=!1,b=this.dom;b&&b.box.parentNode&&(b.box.parentNode.removeChild(b.box),a=!0);return a};G.prototype.reflow=function(){var a=
0,b,c,d,e,k,l,f,g,h,p,s;if(void 0==this.data.start)throw Error('Property "start" missing in item '+this.data.id);if(void 0==this.data.end)throw Error('Property "end" missing in item '+this.data.id);l=this.data;f=this.parent&&this.parent.range;if(this.visible=l&&f?l.start<f.end&&l.end>f.start:!1)(b=this.dom)?(c=this.props,d=this.options,k=this.parent,l=k.toScreen(this.data.start)+this.offset,f=k.toScreen(this.data.end)+this.offset,g=m.updateProperty,h=b.box,p=k.width,s=d.orientation||this.defaultOptions.orientation,
e=d.margin&&d.margin.axis||this.defaultOptions.margin.axis,d=d.padding||this.defaultOptions.padding,a+=g(c.content,"width",b.content.offsetWidth),a+=g(this,"height",h.offsetHeight),l<-p&&(l=-p),f>2*p&&(f=2*p),b=0>l?Math.min(-l,f-l-c.content.width-2*d):0,a+=g(c.content,"left",b),c="top"==s?e:k.height-this.height-e,a+=g(this,"top",c),a+=g(this,"left",l),a+=g(this,"width",Math.max(f-l,1))):a+=1;return 0<a};G.prototype._create=function(){var a=this.dom;a||(this.dom=a={},a.box=document.createElement("div"),
a.content=document.createElement("div"),a.content.className="content",a.box.appendChild(a.content),a.box["timeline-item"]=this)};G.prototype.reposition=function(){var a=this.dom,b=this.props;a&&(a.box.style.top=this.top+"px",a.box.style.left=this.left+"px",a.box.style.width=this.width+"px",a.content.style.left=b.content.left+"px")};G.prototype._repaintDragLeft=function(){if(this.selected&&this.options.editable&&!this.dom.dragLeft){var a=document.createElement("div");a.className="drag-left";a.dragLeftItem=
this;T(a,{preventDefault:!0}).on("drag",function(){});this.dom.box.appendChild(a);this.dom.dragLeft=a}else!this.selected&&this.dom.dragLeft&&(this.dom.dragLeft.parentNode&&this.dom.dragLeft.parentNode.removeChild(this.dom.dragLeft),this.dom.dragLeft=null)};G.prototype._repaintDragRight=function(){if(this.selected&&this.options.editable&&!this.dom.dragRight){var a=document.createElement("div");a.className="drag-right";a.dragRightItem=this;T(a,{preventDefault:!0}).on("drag",function(){});this.dom.box.appendChild(a);
this.dom.dragRight=a}else!this.selected&&this.dom.dragRight&&(this.dom.dragRight.parentNode&&this.dom.dragRight.parentNode.removeChild(this.dom.dragRight),this.dom.dragRight=null)};U.prototype=new G(null,null);U.prototype.repaint=function(){var a=!1,b=this.dom;b||(this._create(),b=this.dom,a=!0);if(b){if(!this.parent)throw Error("Cannot repaint item: no parent attached");var c=this.parent.getForeground();if(!c)throw Error("Cannot repaint time axis: parent has no foreground container element");b.box.parentNode||
(c.appendChild(b.box),a=!0);if(this.data.content!=this.content){this.content=this.data.content;if(this.content instanceof Element)b.content.innerHTML="",b.content.appendChild(this.content);else if(void 0!=this.data.content)b.content.innerHTML=this.content;else throw Error('Property "content" missing in item '+this.id);a=!0}this._repaintDeleteButton(b.box);this._repaintDragLeft();this._repaintDragRight();c=(this.data.className?" "+this.data.className:"")+(this.selected?" selected":"");this.className!=
c&&(this.className=c,b.box.className="item rangeoverflow"+c,a=!0)}return a};U.prototype.reposition=function(){var a=this.dom,b=this.props;a&&(a.box.style.top=this.top+"px",a.box.style.left=this.left+"px",a.box.style.width=this._width+"px",a.content.style.left=b.content.left+"px")};R.prototype=new f;R.prototype.setOptions=f.prototype.setOptions;R.prototype.getContainer=function(){return this.parent.getContainer()};R.prototype.setItems=function(a){this.itemset&&(this.itemset.hide(),this.itemset.setItems(),
this.parent.controller.remove(this.itemset),this.itemset=null);if(a){var b=this.groupId,c=Object.create(this.options);this.itemset=new q(this,null,c);this.itemset.setRange(this.parent.range);this.view=new u(a,{filter:function(a){return a.group==b}});this.itemset.setItems(this.view);this.parent.controller.add(this.itemset)}};R.prototype.setSelection=function(a){this.itemset&&this.itemset.setSelection(a)};R.prototype.getSelection=function(){return this.itemset?this.itemset.getSelection():[]};R.prototype.repaint=
function(){return!1};R.prototype.reflow=function(){var a,b=m.updateProperty;a=0+b(this,"top",this.itemset?this.itemset.top:0);a+=b(this,"height",this.itemset?this.itemset.height:0);if(this.label){var c=this.label.firstChild;a+=b(this.props.label,"width",c.clientWidth);a+=b(this.props.label,"height",c.clientHeight)}else a+=b(this.props.label,"width",0),a+=b(this.props.label,"height",0);return 0<a};D.prototype=new h;D.prototype.setOptions=f.prototype.setOptions;D.prototype.setRange=function(a){};D.prototype.setItems=
function(a){this.itemsData=a;for(var b in this.groups)this.groups.hasOwnProperty(b)&&this.groups[b].setItems(a)};D.prototype.getItems=function(){return this.itemsData};D.prototype.setRange=function(a){this.range=a};D.prototype.setGroups=function(a){var b=this,c;this.groupsData&&(m.forEach(this.listeners,function(a,c){b.groupsData.unsubscribe(c,a)}),c=this.groupsData.getIds(),this._onRemove(c));a?a instanceof n?this.groupsData=a:(this.groupsData=new n({convert:{start:"Date",end:"Date"}}),this.groupsData.add(a)):
this.groupsData=null;if(this.groupsData){var d=this.id;m.forEach(this.listeners,function(a,c){b.groupsData.on(c,a,d)});c=this.groupsData.getIds();this._onAdd(c)}};D.prototype.getGroups=function(){return this.groupsData};D.prototype.setSelection=function(a){var b=this.groups,c;for(c in b)b.hasOwnProperty(c)&&b[c].setSelection(a);return[]};D.prototype.getSelection=function(){var a=[],b=this.groups,c;for(c in b)b.hasOwnProperty(c)&&(a=a.concat(b[c].getSelection()));return a};D.prototype.repaint=function(){var a=
0,b,c,d,e;e=m.updateProperty;b=m.option.asSize;var k=m.option.asElement,l=this.options,f=this.dom.frame,g=this.dom.labels;d=this.dom.labelSet;if(!this.parent)throw Error("Cannot repaint groupset: no parent attached");var h=this.parent.getContainer();if(!h)throw Error("Cannot repaint groupset: parent has no container element");if(!f){f=document.createElement("div");f.className="groupset";f["timeline-groupset"]=this;this.dom.frame=f;var p=l.className;p&&m.addClassName(f,m.option.asString(p));a+=1}f.parentNode||
(h.appendChild(f),a+=1);k=k(l.labelContainer);if(!k)throw Error('Cannot repaint groupset: option "labelContainer" not defined');g||(g=document.createElement("div"),g.className="labels",this.dom.labels=g);d||(d=document.createElement("div"),d.className="label-set",g.appendChild(d),this.dom.labelSet=d);if(!g.parentNode||g.parentNode!=k)g.parentNode&&g.parentNode.removeChild(g.parentNode),k.appendChild(g);var a=a+e(f.style,"height",b(l.height,this.height+"px")),a=a+e(f.style,"top",b(l.top,"0px")),a=
a+e(f.style,"left",b(l.left,"0px")),a=a+e(f.style,"width",b(l.width,"100%")),a=a+e(d.style,"top",b(l.top,"0px")),a=a+e(d.style,"height",b(l.height,this.height+"px")),s=this,r=this.queue,y=this.groups,t=this.groupsData;e=Object.keys(r);if(e.length){e.forEach(function(a){var b=r[a],c=y[a];switch(b){case "add":case "update":c||(b=Object.create(s.options),m.extend(b,{height:null,maxHeight:null}),c=new R(s,a,b),c.setItems(s.itemsData),y[a]=c,s.controller.add(c));c.data=t.get(a);delete r[a];break;case "remove":c&&
(c.setItems(),delete y[a],s.controller.remove(c));delete r[a];break;default:console.log('Error: unknown action "'+b+'"')}});l=this.groupsData.getIds({order:this.options.groupOrder});for(b=0;b<l.length;b++)(function(a,b){var c=0;b&&(c=function(){return b.top+b.height});a.setOptions({top:c})})(y[l[b]],y[l[b-1]]);for(;d.firstChild;)d.removeChild(d.firstChild);for(b=0;b<l.length;b++)c=l[b],e=this._createLabel(c),d.appendChild(e);a++}for(c in y)if(y.hasOwnProperty(c)&&(d=y[c],e=d.label))e.style.top=d.top+
"px",e.style.height=d.height+"px";return 0<a};D.prototype._createLabel=function(a){a=this.groups[a];var b=document.createElement("div");b.className="vlabel";var c=document.createElement("div");c.className="inner";b.appendChild(c);var d=a.data&&a.data.content;d instanceof Element?c.appendChild(d):void 0!=d&&(c.innerHTML=d);(c=a.data&&a.data.className)&&m.addClassName(b,c);return a.label=b};D.prototype.getContainer=function(){return this.dom.frame};D.prototype.getLabelsWidth=function(){return this.props.labels.width};
D.prototype.reflow=function(){var a=0,b,c;c=this.options;var d=m.updateProperty,e=m.option.asNumber,k=m.option.asSize,l=this.dom.frame;if(l){e=e(c.maxHeight);if(null!=k(c.height))k=l.offsetHeight;else for(b in k=0,this.groups)this.groups.hasOwnProperty(b)&&(c=this.groups[b],k+=c.height);null!=e&&(k=Math.min(k,e));a+=d(this,"height",k);a+=d(this,"top",l.offsetTop);a+=d(this,"left",l.offsetLeft);a+=d(this,"width",l.offsetWidth)}l=0;for(b in this.groups)this.groups.hasOwnProperty(b)&&(c=this.groups[b],
l=Math.max(l,c.props&&c.props.label&&c.props.label.width||0));a+=d(this.props.labels,"width",l);return 0<a};D.prototype.hide=function(){return this.dom.frame&&this.dom.frame.parentNode?(this.dom.frame.parentNode.removeChild(this.dom.frame),!0):!1};D.prototype.show=function(){return!this.dom.frame||!this.dom.frame.parentNode?this.repaint():!1};D.prototype._onUpdate=function(a){this._toQueue(a,"update")};D.prototype._onAdd=function(a){this._toQueue(a,"add")};D.prototype._onRemove=function(a){this._toQueue(a,
"remove")};D.prototype._toQueue=function(a,b){var c=this.queue;a.forEach(function(a){c[a]=b});this.controller&&this.requestRepaint()};D.groupFromTarget=function(a){for(var b,c=a.target;c;){if(c.hasOwnProperty("timeline-groupset")){b=c["timeline-groupset"];break}c=c.parentNode}if(b)for(var d in b.groups)if(b.groups.hasOwnProperty(d)&&(c=b.groups[d],c.itemset&&q.itemSetFromTarget(a)==c.itemset))return c;return null};y.prototype.on=function(a,b){this.controller.on(a,b)};y.prototype.off=function(a,b){this.controller.off(a,
b)};y.prototype.setOptions=function(a){m.extend(this.options,a);this.range.setRange(a.start,a.end);if("editable"in a||"selectable"in a)this.options.selectable?this.setSelection(this.getSelection()):this.setSelection([]);a=function(a){if(!(this.options[a]instanceof Function)||2!=this.options[a].length)throw Error("option "+a+" must be a function "+a+"(item, callback)");}.bind(this);["onAdd","onUpdate","onRemove","onMove"].forEach(a);this.controller.reflow();this.controller.repaint()};y.prototype.setCustomTime=
function(a){if(!this.customtime)throw Error("Cannot get custom time: Custom time bar is not enabled");this.customtime.setCustomTime(a)};y.prototype.getCustomTime=function(){if(!this.customtime)throw Error("Cannot get custom time: Custom time bar is not enabled");return this.customtime.getCustomTime()};y.prototype.setItems=function(a){var b=null==this.itemsData,c;a?a instanceof n&&(c=a):c=null;a instanceof n||(c=new n({convert:{start:"Date",end:"Date"}}),c.add(a));this.itemsData=c;this.content.setItems(c);
if(b&&(void 0==this.options.start||void 0==this.options.end))b=this.getItemRange(),a=b.min,b=b.max,null!=a&&null!=b&&(c=b.valueOf()-a.valueOf(),0>=c&&(c=864E5),a=new Date(a.valueOf()-0.05*c),b=new Date(b.valueOf()+0.05*c)),void 0!=this.options.start&&(a=m.convert(this.options.start,"Date")),void 0!=this.options.end&&(b=m.convert(this.options.end,"Date")),(null!=a||null!=b)&&this.range.setRange(a,b)};y.prototype.setGroups=function(a){var b=this;a=(this.groupsData=a)?D:q;if(!(this.content instanceof
a)){this.content&&(this.content.hide(),this.content.setItems&&this.content.setItems(),this.content.setGroups&&this.content.setGroups(),this.controller.remove(this.content));var c=Object.create(this.options);m.extend(c,{top:function(){return"top"==b.options.orientation?b.timeaxis.height:b.itemPanel.height-b.timeaxis.height-b.content.height},left:null,width:"100%",height:function(){return b.options.height?b.itemPanel.height-b.timeaxis.height:null},maxHeight:function(){if(b.options.maxHeight){if(!m.isNumber(b.options.maxHeight))throw new TypeError("Number expected for property maxHeight");
return b.options.maxHeight-b.timeaxis.height}return null},labelContainer:function(){return b.labelPanel.getContainer()}});this.content=new a(this.itemPanel,[this.timeaxis],c);this.content.setRange&&this.content.setRange(this.range);this.content.setItems&&this.content.setItems(this.itemsData);this.content.setGroups&&this.content.setGroups(this.groupsData);this.controller.add(this.content)}};y.prototype.getItemRange=function(){var a=this.itemsData,b=null,c=null;if(a){var b=(b=a.min("start"))?b.start.valueOf():
null,d=a.max("start");d&&(c=d.start.valueOf());(a=a.max("end"))&&(c=null==c?a.end.valueOf():Math.max(c,a.end.valueOf()))}return{min:null!=b?new Date(b):null,max:null!=c?new Date(c):null}};y.prototype.setSelection=function(a){this.content&&this.content.setSelection(a)};y.prototype.getSelection=function(){return this.content?this.content.getSelection():[]};y.prototype.setWindow=function(a,b){this.range.setRange(a,b)};y.prototype.getWindow=function(){var a=this.range.getRange();return{start:new Date(a.start),
end:new Date(a.end)}};y.prototype._onSelectItem=function(a){if(this.options.selectable){var b=a.gesture.srcEvent&&a.gesture.srcEvent.shiftKey;a.gesture.srcEvent&&a.gesture.srcEvent.ctrlKey||b?this._onMultiSelectItem(a):(b=q.itemFromTarget(a),this.setSelection(b?[b.id]:[]),this.controller.emit("select",{items:this.getSelection()}),a.stopPropagation())}};y.prototype._onAddItem=function(a){if(this.options.selectable&&this.options.editable){var b=this,c=q.itemFromTarget(a);if(c)a=b.itemsData.get(c.id),
this.options.onUpdate(a,function(a){a&&b.itemsData.update(a)});else{var c=M.util.getAbsoluteLeft(this.rootPanel.frame),d={start:this.timeaxis.snap(this._toTime(a.gesture.center.pageX-c)),content:"new item"},e=m.randomUUID();d[this.itemsData.fieldId]=e;if(a=D.groupFromTarget(a))d.group=a.groupId;this.options.onAdd(d,function(a){a&&(b.itemsData.add(d),b.controller.once("repaint",function(){b.setSelection([e]);b.controller.emit("select",{items:b.getSelection()})}.bind(b)))})}}};y.prototype._onMultiSelectItem=
function(a){if(this.options.selectable){var b,c=q.itemFromTarget(a);if(c){b=this.getSelection();var d=b.indexOf(c.id);-1==d?b.push(c.id):b.splice(d,1);this.setSelection(b);this.controller.emit("select",{items:this.getSelection()});a.stopPropagation()}}};y.prototype._toTime=function(a){var b=this.range.conversion(this.content.width);return new Date(a/b.scale+b.offset)};y.prototype._toScreen=function(a){var b=this.range.conversion(this.content.width);return(a.valueOf()-b.offset)*b.scale};(function(a){function b(a){z=
a;a={};n=0;q=z.charAt(0);f();"strict"==w&&(a.strict=!0,f());if("graph"==w||"digraph"==w)a.type=w,f();u==t.IDENTIFIER&&(a.id=w,f());if("{"!=w)throw r("Angle bracket { expected");f();g(a);if("}"!=w)throw r("Angle bracket } expected");f();if(""!==w)throw r("End of file expected");f();delete a.node;delete a.edge;delete a.graph;return a}function c(){n++;q=z.charAt(n)}function d(){return z.charAt(n+1)}function e(a,b){a||(a={});if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function k(a,b){for(var c,
d,k=null,l=[a],f=a;f.parent;)l.push(f.parent),f=f.parent;if(f.nodes){c=0;for(d=f.nodes.length;c<d;c++)if(b.id===f.nodes[c].id){k=f.nodes[c];break}}k||(k={id:b.id},a.node&&(k.attr=e(k.attr,a.node)));for(c=l.length-1;0<=c;c--)d=l[c],d.nodes||(d.nodes=[]),-1==d.nodes.indexOf(k)&&d.nodes.push(k);b.attr&&(k.attr=e(k.attr,b.attr))}function l(a,b,c,d,k){b={from:b,to:c,type:d};a.edge&&(b.attr=e({},a.edge));b.attr=e(b.attr||{},k);return b}function f(){u=t.NULL;for(w="";" "==q||"\t"==q||"\n"==q||"\r"==q;)c();
do{var a=!1;if("#"==q){for(var b=n-1;" "==z.charAt(b)||"\t"==z.charAt(b);)b--;if("\n"==z.charAt(b)||""==z.charAt(b)){for(;""!=q&&"\n"!=q;)c();a=!0}}if("/"==q&&"/"==d()){for(;""!=q&&"\n"!=q;)c();a=!0}if("/"==q&&"*"==d()){for(;""!=q;)if("*"==q&&"/"==d()){c();c();break}else c();a=!0}for(;" "==q||"\t"==q||"\n"==q||"\r"==q;)c()}while(a);if(""==q)u=t.DELIMITER;else if(a=q+d(),B[a])u=t.DELIMITER,w=a,c(),c();else if(B[q])u=t.DELIMITER,w=q,c();else if(x.test(q)||"-"==q){w+=q;for(c();x.test(q);)w+=q,c();"false"==
w?w=!1:"true"==w?w=!0:isNaN(Number(w))||(w=Number(w));u=t.IDENTIFIER}else if('"'==q){for(c();""!=q&&('"'!=q||'"'==q&&'"'==d());)w+=q,'"'==q&&c(),c();if('"'!=q)throw r('End of string " expected');c();u=t.IDENTIFIER}else{for(u=t.UNKNOWN;""!=q;)w+=q,c();throw new SyntaxError('Syntax error in part "'+(30>=w.length?w:w.substr(0,27)+"...")+'"');}}function g(a){for(;""!==w&&"}"!=w;){var b=a,c=h(b);if(c)p(b,c);else if(!m(b)){if(u!=t.IDENTIFIER)throw r("Identifier expected");c=w;f();if("="==w){f();if(u!=t.IDENTIFIER)throw r("Identifier expected");
b[c]=w;f()}else{var d={id:c},e=s();e&&(d.attr=e);k(b,d);p(b,c)}}";"==w&&f()}}function h(a){var b=null;"subgraph"==w&&(b={type:"subgraph"},f(),u==t.IDENTIFIER&&(b.id=w,f()));if("{"==w){f();b||(b={});b.parent=a;b.node=a.node;b.edge=a.edge;b.graph=a.graph;g(b);if("}"!=w)throw r("Angle bracket } expected");f();delete b.node;delete b.edge;delete b.graph;delete b.parent;a.subgraphs||(a.subgraphs=[]);a.subgraphs.push(b)}return b}function m(a){return"node"==w?(f(),a.node=s(),"node"):"edge"==w?(f(),a.edge=
s(),"edge"):"graph"==w?(f(),a.graph=s(),"graph"):null}function p(a,b){for(;"->"==w||"--"==w;){var c,d=w;f();c=h(a);if(!c){if(u!=t.IDENTIFIER)throw r("Identifier or subgraph expected");c=w;k(a,{id:c});f()}var g=s(),g=l(a,b,c,d,g),d=a;d.edges||(d.edges=[]);d.edges.push(g);d.edge&&(d=e({},d.edge),g.attr=e(d,g.attr));b=c}}function s(){for(var a=null;"["==w;){f();for(a={};""!==w&&"]"!=w;){if(u!=t.IDENTIFIER)throw r("Attribute name expected");var b=w;f();if("="!=w)throw r("Equal sign = expected");f();if(u!=
t.IDENTIFIER)throw r("Attribute value expected");for(var c=a,d=w,b=b.split(".");b.length;){var e=b.shift();b.length?(c[e]||(c[e]={}),c=c[e]):c[e]=d}f();","==w&&f()}if("]"!=w)throw r("Bracket ] expected");f()}return a}function r(a){return new SyntaxError(a+', got "'+(30>=w.length?w:w.substr(0,27)+"...")+'" (char '+n+")")}function y(a,b,c){a instanceof Array?a.forEach(function(a){b instanceof Array?b.forEach(function(b){c(a,b)}):c(a,b)}):b instanceof Array?b.forEach(function(b){c(a,b)}):c(a,b)}var t=
{NULL:0,DELIMITER:1,IDENTIFIER:2,UNKNOWN:3},B={"{":!0,"}":!0,"[":!0,"]":!0,";":!0,"=":!0,",":!0,"->":!0,"--":!0},z="",n=0,q="",w="",u=t.NULL,x=/[a-zA-Z_0-9.:#]/;a.parseDOT=b;a.DOTToGraph=function(a){a=b(a);var c={nodes:[],edges:[],options:{}};a.nodes&&a.nodes.forEach(function(a){var b={id:a.id,label:String(a.label||a.id)};e(b,a.attr);b.image&&(b.shape="image");c.nodes.push(b)});if(a.edges){var d=function(a){var b={from:a.from,to:a.to};e(b,a.attr);b.style="->"==a.type?"arrow":"line";return b};a.edges.forEach(function(a){var b,
e;b=a.from instanceof Object?a.from.nodes:{id:a.from};e=a.to instanceof Object?a.to.nodes:{id:a.to};a.from instanceof Object&&a.from.edges&&a.from.edges.forEach(function(a){a=d(a);c.edges.push(a)});y(b,e,function(b,e){var k=l(c,b.id,e.id,a.type,a.attr),k=d(k);c.edges.push(k)});a.to instanceof Object&&a.to.edges&&a.to.edges.forEach(function(a){a=d(a);c.edges.push(a)})})}a.attr&&(c.options=a.attr);return c}})("undefined"!==typeof m?m:Q);"undefined"!==typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.circle=
function(a,b,c){this.beginPath();this.arc(a,b,c,0,2*Math.PI,!1)},CanvasRenderingContext2D.prototype.square=function(a,b,c){this.beginPath();this.rect(a-c,b-c,2*c,2*c)},CanvasRenderingContext2D.prototype.triangle=function(a,b,c){this.beginPath();var d=2*c;c=d/2;var e=Math.sqrt(3)/6*d,d=Math.sqrt(d*d-c*c);this.moveTo(a,b-(d-e));this.lineTo(a+c,b+e);this.lineTo(a-c,b+e);this.lineTo(a,b-(d-e));this.closePath()},CanvasRenderingContext2D.prototype.triangleDown=function(a,b,c){this.beginPath();var d=2*c;
c=d/2;var e=Math.sqrt(3)/6*d,d=Math.sqrt(d*d-c*c);this.moveTo(a,b+(d-e));this.lineTo(a+c,b-e);this.lineTo(a-c,b-e);this.lineTo(a,b+(d-e));this.closePath()},CanvasRenderingContext2D.prototype.star=function(a,b,c){this.beginPath();for(var d=0;10>d;d++){var e=0===d%2?1.3*c:0.5*c;this.lineTo(a+e*Math.sin(2*d*Math.PI/10),b-e*Math.cos(2*d*Math.PI/10))}this.closePath()},CanvasRenderingContext2D.prototype.roundRect=function(a,b,c,d,e){var k=Math.PI/180;0>c-2*e&&(e=c/2);0>d-2*e&&(e=d/2);this.beginPath();this.moveTo(a+
e,b);this.lineTo(a+c-e,b);this.arc(a+c-e,b+e,e,270*k,360*k,!1);this.lineTo(a+c,b+d-e);this.arc(a+c-e,b+d-e,e,0,90*k,!1);this.lineTo(a+e,b+d);this.arc(a+e,b+d-e,e,90*k,180*k,!1);this.lineTo(a,b+e);this.arc(a+e,b+e,e,180*k,270*k,!1)},CanvasRenderingContext2D.prototype.ellipse=function(a,b,c,d){var e=0.5522848*(c/2),k=0.5522848*(d/2),l=a+c,f=b+d;c=a+c/2;d=b+d/2;this.beginPath();this.moveTo(a,d);this.bezierCurveTo(a,d-k,c-e,b,c,b);this.bezierCurveTo(c+e,b,l,d-k,l,d);this.bezierCurveTo(l,d+k,c+e,f,c,f);
this.bezierCurveTo(c-e,f,a,d+k,a,d)},CanvasRenderingContext2D.prototype.database=function(a,b,c,d){var e=d*(1/3),k=0.5522848*(c/2),l=0.5522848*(e/2),f=a+c,g=b+e;c=a+c/2;var h=b+e/2,e=b+(d-e/2);d=b+d;this.beginPath();this.moveTo(f,h);this.bezierCurveTo(f,h+l,c+k,g,c,g);this.bezierCurveTo(c-k,g,a,h+l,a,h);this.bezierCurveTo(a,h-l,c-k,b,c,b);this.bezierCurveTo(c+k,b,f,h-l,f,h);this.lineTo(f,e);this.bezierCurveTo(f,e+l,c+k,d,c,d);this.bezierCurveTo(c-k,d,a,e+l,a,e);this.lineTo(a,h)},CanvasRenderingContext2D.prototype.arrow=
function(a,b,c,d){var e=a-d*Math.cos(c),k=b-d*Math.sin(c),l=a-0.9*d*Math.cos(c),f=b-0.9*d*Math.sin(c),g=e+d/3*Math.cos(c+0.5*Math.PI),h=k+d/3*Math.sin(c+0.5*Math.PI),e=e+d/3*Math.cos(c-0.5*Math.PI);c=k+d/3*Math.sin(c-0.5*Math.PI);this.beginPath();this.moveTo(a,b);this.lineTo(g,h);this.lineTo(l,f);this.lineTo(e,c);this.closePath()},CanvasRenderingContext2D.prototype.dashedLine=function(a,b,c,d,e){e||(e=[10,5]);var k=e.length;this.moveTo(a,b);c-=a;var l=d-b;d=l/c;for(var l=Math.sqrt(c*c+l*l),f=0,g=
!0;0.1<=l;){var h=e[f++%k];h>l&&(h=l);var m=Math.sqrt(h*h/(1+d*d));0>c&&(m=-m);a+=m;b+=d*m;this[g?"lineTo":"moveTo"](a,b);l-=h;g=!g}});p.prototype.resetCluster=function(){this.formationScale=void 0;this.clusterSize=1;this.containedNodes={};this.containedEdges={};this.clusterSessions=[]};p.prototype.attachEdge=function(a){-1==this.edges.indexOf(a)&&this.edges.push(a);-1==this.dynamicEdges.indexOf(a)&&this.dynamicEdges.push(a);this.dynamicEdgesLength=this.dynamicEdges.length};p.prototype.detachEdge=
function(a){a=this.edges.indexOf(a);-1!=a&&(this.edges.splice(a,1),this.dynamicEdges.splice(a,1));this.dynamicEdgesLength=this.dynamicEdges.length};p.prototype.setProperties=function(a,b){if(a){this.originalLabel=void 0;void 0!==a.id&&(this.id=a.id);void 0!==a.label&&(this.originalLabel=this.label=a.label);void 0!==a.title&&(this.title=a.title);void 0!==a.group&&(this.group=a.group);void 0!==a.x&&(this.x=a.x);void 0!==a.y&&(this.y=a.y);void 0!==a.value&&(this.value=a.value);void 0!==a.level&&(this.level=
a.level);void 0!==a.internalMultiplier&&(this.internalMultiplier=a.internalMultiplier);void 0!==a.damping&&(this.dampingBase=a.damping);void 0!==a.mass&&(this.mass=a.mass);void 0!==a.horizontalAlignLeft&&(this.horizontalAlignLeft=a.horizontalAlignLeft);void 0!==a.verticalAlignTop&&(this.verticalAlignTop=a.verticalAlignTop);void 0!==a.triggerFunction&&(this.triggerFunction=a.triggerFunction);if(void 0===this.id)throw"Node must have an id";if(this.group){var c=this.grouplist.get(this.group),d;for(d in c)c.hasOwnProperty(d)&&
(this[d]=c[d])}void 0!==a.shape&&(this.shape=a.shape);void 0!==a.image&&(this.image=a.image);void 0!==a.radius&&(this.radius=a.radius);void 0!==a.color&&(this.color=p.parseColor(a.color));void 0!==a.fontColor&&(this.fontColor=a.fontColor);void 0!==a.fontSize&&(this.fontSize=a.fontSize);void 0!==a.fontFace&&(this.fontFace=a.fontFace);if(void 0!==this.image)if(this.imagelist)this.imageObj=this.imagelist.load(this.image);else throw"No imagelist provided";this.xFixed=this.xFixed||void 0!==a.x&&!a.allowedToMoveX;
this.yFixed=this.yFixed||void 0!==a.y&&!a.allowedToMoveY;this.radiusFixed=this.radiusFixed||void 0!==a.radius;"image"==this.shape&&(this.radiusMin=b.nodes.widthMin,this.radiusMax=b.nodes.widthMax);switch(this.shape){case "database":this.draw=this._drawDatabase;this.resize=this._resizeDatabase;break;case "box":this.draw=this._drawBox;this.resize=this._resizeBox;break;case "circle":this.draw=this._drawCircle;this.resize=this._resizeCircle;break;case "ellipse":this.draw=this._drawEllipse;this.resize=
this._resizeEllipse;break;case "image":this.draw=this._drawImage;this.resize=this._resizeImage;break;case "text":this.draw=this._drawText;this.resize=this._resizeText;break;case "dot":this.draw=this._drawDot;this.resize=this._resizeShape;break;case "square":this.draw=this._drawSquare;this.resize=this._resizeShape;break;case "triangle":this.draw=this._drawTriangle;this.resize=this._resizeShape;break;case "triangleDown":this.draw=this._drawTriangleDown;this.resize=this._resizeShape;break;case "star":this.draw=
this._drawStar;this.resize=this._resizeShape;break;default:this.draw=this._drawEllipse,this.resize=this._resizeEllipse}this._reset()}};p.parseColor=function(a){var b;if(m.isString(a))if(m.isValidHex(a)){var c=m.hexToHSV(a);b=c.h;var d=0.45*c.s,e=Math.min(1,1.05*c.v),k=c.h;Math.min(1,1.25*c.v);c=m.HSVToHex(k,k,0.6*c.v);b=m.HSVToHex(b,d,e);b={background:a,border:c,highlight:{background:b,border:c}}}else b={background:a,border:a,highlight:{background:a,border:a}};else b={},b.background=a.background||
"white",b.border=a.border||b.background,m.isString(a.highlight)?b.highlight={border:a.highlight,background:a.highlight}:(b.highlight={},b.highlight.background=a.highlight&&a.highlight.background||b.background,b.highlight.border=a.highlight&&a.highlight.border||b.border);return b};p.prototype.select=function(){this.selected=!0;this._reset()};p.prototype.unselect=function(){this.selected=!1;this._reset()};p.prototype.clearSizeCache=function(){this._reset()};p.prototype._reset=function(){this.height=
this.width=void 0};p.prototype.getTitle=function(){return this.title};p.prototype.distanceToBorder=function(a,b){this.width||this.resize(a);switch(this.shape){case "circle":case "dot":return this.radius+1;case "ellipse":var c=this.width/2,d=this.height/2,e=Math.sin(b)*c,k=Math.cos(b)*d;return c*d/Math.sqrt(e*e+k*k);default:return this.width?Math.min(Math.abs(this.width/2/Math.cos(b)),Math.abs(this.height/2/Math.sin(b)))+1:0}};p.prototype._setForce=function(a,b){this.fx=a;this.fy=b};p.prototype._addForce=
function(a,b){this.fx+=a;this.fy+=b};p.prototype.discreteStep=function(a){this.xFixed||(this.vx+=(this.fx-this.damping*this.vx)/this.mass*a,this.x+=this.vx*a);this.yFixed||(this.vy+=(this.fy-this.damping*this.vy)/this.mass*a,this.y+=this.vy*a)};p.prototype.discreteStepLimited=function(a,b){this.xFixed||(this.vx+=(this.fx-this.damping*this.vx)/this.mass*a,this.vx=Math.abs(this.vx)>b?0<this.vx?b:-b:this.vx,this.x+=this.vx*a);this.yFixed||(this.vy+=(this.fy-this.damping*this.vy)/this.mass*a,this.vy=
Math.abs(this.vy)>b?0<this.vy?b:-b:this.vy,this.y+=this.vy*a)};p.prototype.isFixed=function(){return this.xFixed&&this.yFixed};p.prototype.isMoving=function(a){return Math.abs(this.vx)>a||Math.abs(this.vy)>a};p.prototype.isSelected=function(){return this.selected};p.prototype.getValue=function(){return this.value};p.prototype.getDistance=function(a,b){var c=this.x-a,d=this.y-b;return Math.sqrt(c*c+d*d)};p.prototype.setValueRange=function(a,b){!this.radiusFixed&&void 0!==this.value&&(this.radius=b==
a?(this.radiusMin+this.radiusMax)/2:(this.value-a)*((this.radiusMax-this.radiusMin)/(b-a))+this.radiusMin);this.baseRadiusValue=this.radius};p.prototype.draw=function(a){throw"Draw method not initialized for node";};p.prototype.resize=function(a){throw"Resize method not initialized for node";};p.prototype.isOverlappingWith=function(a){return this.left<a.right&&this.left+this.width>a.left&&this.top<a.bottom&&this.top+this.height>a.top};p.prototype._resizeImage=function(a){if(!this.width||!this.height){var b;
this.value?(this.radius=this.baseRadiusValue,b=this.imageObj.height/this.imageObj.width,void 0!==b?(a=this.radius||this.imageObj.width,b=this.radius*b||this.imageObj.height):b=a=0):(a=this.imageObj.width,b=this.imageObj.height);this.width=a;this.height=b;this.growthIndicator=0;0<this.width&&0<this.height&&(this.width+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeWidthFactor,this.height+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeHeightFactor,
this.radius+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeRadiusFactor,this.growthIndicator=this.width-a)}};p.prototype._drawImage=function(a){this._resizeImage(a);this.left=this.x-this.width/2;this.top=this.y-this.height/2;var b;0!=this.imageObj.width?(1<this.clusterSize&&(b=1<this.clusterSize?10:0,b*=this.graphScaleInv,b=Math.min(0.2*this.width,b),a.globalAlpha=0.5,a.drawImage(this.imageObj,this.left-b,this.top-b,this.width+2*b,this.height+2*b)),a.globalAlpha=1,a.drawImage(this.imageObj,
this.left,this.top,this.width,this.height),b=this.y+this.height/2):b=this.y;this._label(a,this.label,this.x,b,void 0,"top")};p.prototype._resizeBox=function(a){this.width||(a=this.getTextSize(a),this.width=a.width+10,this.height=a.height+10,this.width+=0.5*Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeWidthFactor,this.height+=0.5*Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeHeightFactor,this.growthIndicator=this.width-(a.width+10))};p.prototype._drawBox=
function(a){this._resizeBox(a);this.left=this.x-this.width/2;this.top=this.y-this.height/2;a.strokeStyle=this.selected?this.color.highlight.border:this.color.border;1<this.clusterSize&&(a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0),a.lineWidth*=this.graphScaleInv,a.lineWidth=Math.min(0.1*this.width,a.lineWidth),a.roundRect(this.left-2*a.lineWidth,this.top-2*a.lineWidth,this.width+4*a.lineWidth,this.height+4*a.lineWidth,this.radius),a.stroke());a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?
2.5:0);a.lineWidth*=this.graphScaleInv;a.lineWidth=Math.min(0.1*this.width,a.lineWidth);a.fillStyle=this.selected?this.color.highlight.background:this.color.background;a.roundRect(this.left,this.top,this.width,this.height,this.radius);a.fill();a.stroke();this._label(a,this.label,this.x,this.y)};p.prototype._resizeDatabase=function(a){this.width||(this.height=this.width=a=this.getTextSize(a).width+10,this.width+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeWidthFactor,this.height+=
Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeHeightFactor,this.radius+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeRadiusFactor,this.growthIndicator=this.width-a)};p.prototype._drawDatabase=function(a){this._resizeDatabase(a);this.left=this.x-this.width/2;this.top=this.y-this.height/2;a.strokeStyle=this.selected?this.color.highlight.border:this.color.border;1<this.clusterSize&&(a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0),a.lineWidth*=
this.graphScaleInv,a.lineWidth=Math.min(0.1*this.width,a.lineWidth),a.database(this.x-this.width/2-2*a.lineWidth,this.y-0.5*this.height-2*a.lineWidth,this.width+4*a.lineWidth,this.height+4*a.lineWidth),a.stroke());a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0);a.lineWidth*=this.graphScaleInv;a.lineWidth=Math.min(0.1*this.width,a.lineWidth);a.fillStyle=this.selected?this.color.highlight.background:this.color.background;a.database(this.x-this.width/2,this.y-0.5*this.height,this.width,this.height);
a.fill();a.stroke();this._label(a,this.label,this.x,this.y)};p.prototype._resizeCircle=function(a){this.width||(a=this.getTextSize(a),a=Math.max(a.width,a.height)+10,this.radius=a/2,this.height=this.width=a,this.radius+=0.5*Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeRadiusFactor,this.growthIndicator=this.radius-0.5*a)};p.prototype._drawCircle=function(a){this._resizeCircle(a);this.left=this.x-this.width/2;this.top=this.y-this.height/2;a.strokeStyle=this.selected?this.color.highlight.border:
this.color.border;1<this.clusterSize&&(a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0),a.lineWidth*=this.graphScaleInv,a.lineWidth=Math.min(0.1*this.width,a.lineWidth),a.circle(this.x,this.y,this.radius+2*a.lineWidth),a.stroke());a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0);a.lineWidth*=this.graphScaleInv;a.lineWidth=Math.min(0.1*this.width,a.lineWidth);a.fillStyle=this.selected?this.color.highlight.background:this.color.background;a.circle(this.x,this.y,this.radius);a.fill();
a.stroke();this._label(a,this.label,this.x,this.y)};p.prototype._resizeEllipse=function(a){this.width||(a=this.getTextSize(a),this.width=1.5*a.width,this.height=2*a.height,this.width<this.height&&(this.width=this.height),a=this.width,this.width+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeWidthFactor,this.height+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeHeightFactor,this.radius+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeRadiusFactor,
this.growthIndicator=this.width-a)};p.prototype._drawEllipse=function(a){this._resizeEllipse(a);this.left=this.x-this.width/2;this.top=this.y-this.height/2;a.strokeStyle=this.selected?this.color.highlight.border:this.color.border;1<this.clusterSize&&(a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0),a.lineWidth*=this.graphScaleInv,a.lineWidth=Math.min(0.1*this.width,a.lineWidth),a.ellipse(this.left-2*a.lineWidth,this.top-2*a.lineWidth,this.width+4*a.lineWidth,this.height+4*a.lineWidth),a.stroke());
a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0);a.lineWidth*=this.graphScaleInv;a.lineWidth=Math.min(0.1*this.width,a.lineWidth);a.fillStyle=this.selected?this.color.highlight.background:this.color.background;a.ellipse(this.left,this.top,this.width,this.height);a.fill();a.stroke();this._label(a,this.label,this.x,this.y)};p.prototype._drawDot=function(a){this._drawShape(a,"circle")};p.prototype._drawTriangle=function(a){this._drawShape(a,"triangle")};p.prototype._drawTriangleDown=function(a){this._drawShape(a,
"triangleDown")};p.prototype._drawSquare=function(a){this._drawShape(a,"square")};p.prototype._drawStar=function(a){this._drawShape(a,"star")};p.prototype._resizeShape=function(a){this.width||(this.radius=this.baseRadiusValue,this.height=this.width=a=2*this.radius,this.width+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeWidthFactor,this.height+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeHeightFactor,this.radius+=0.5*Math.min(this.clusterSize-
1,this.maxNodeSizeIncrements)*this.clusterSizeRadiusFactor,this.growthIndicator=this.width-a)};p.prototype._drawShape=function(a,b){this._resizeShape(a);this.left=this.x-this.width/2;this.top=this.y-this.height/2;var c=2;switch(b){case "dot":c=2;break;case "square":c=2;break;case "triangle":c=3;break;case "triangleDown":c=3;break;case "star":c=4}a.strokeStyle=this.selected?this.color.highlight.border:this.color.border;1<this.clusterSize&&(a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0),
a.lineWidth*=this.graphScaleInv,a.lineWidth=Math.min(0.1*this.width,a.lineWidth),a[b](this.x,this.y,this.radius+c*a.lineWidth),a.stroke());a.lineWidth=(this.selected?2:1)+(1<this.clusterSize?2.5:0);a.lineWidth*=this.graphScaleInv;a.lineWidth=Math.min(0.1*this.width,a.lineWidth);a.fillStyle=this.selected?this.color.highlight.background:this.color.background;a[b](this.x,this.y,this.radius);a.fill();a.stroke();this.label&&this._label(a,this.label,this.x,this.y+this.height/2,void 0,"top")};p.prototype._resizeText=
function(a){this.width||(a=this.getTextSize(a),this.width=a.width+10,this.height=a.height+10,this.width+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeWidthFactor,this.height+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeHeightFactor,this.radius+=Math.min(this.clusterSize-1,this.maxNodeSizeIncrements)*this.clusterSizeRadiusFactor,this.growthIndicator=this.width-(a.width+10))};p.prototype._drawText=function(a){this._resizeText(a);this.left=this.x-
this.width/2;this.top=this.y-this.height/2;this._label(a,this.label,this.x,this.y)};p.prototype._label=function(a,b,c,d,e,k){if(b&&this.fontSize*this.graphScale>this.fontDrawThreshold){a.font=(this.selected?"bold ":"")+this.fontSize+"px "+this.fontFace;a.fillStyle=this.fontColor||"black";a.textAlign=e||"center";a.textBaseline=k||"middle";b=b.split("\n");e=b.length;k=this.fontSize+4;d+=(1-e)/2*k;for(var f=0;f<e;f++)a.fillText(b[f],c,d),d+=k}};p.prototype.getTextSize=function(a){if(void 0!==this.label){a.font=
(this.selected?"bold ":"")+this.fontSize+"px "+this.fontFace;for(var b=this.label.split("\n"),c=(this.fontSize+4)*b.length,d=0,e=0,k=b.length;e<k;e++)d=Math.max(d,a.measureText(b[e]).width);return{width:d,height:c}}return{width:0,height:0}};p.prototype.inArea=function(){return void 0!==this.width?this.x+this.width*this.graphScaleInv>=this.canvasTopLeft.x&&this.x-this.width*this.graphScaleInv<this.canvasBottomRight.x&&this.y+this.height*this.graphScaleInv>=this.canvasTopLeft.y&&this.y-this.height*
this.graphScaleInv<this.canvasBottomRight.y:!0};p.prototype.inView=function(){return this.x>=this.canvasTopLeft.x&&this.x<this.canvasBottomRight.x&&this.y>=this.canvasTopLeft.y&&this.y<this.canvasBottomRight.y};p.prototype.setScaleAndPos=function(a,b,c){this.graphScaleInv=1/a;this.graphScale=a;this.canvasTopLeft=b;this.canvasBottomRight=c};p.prototype.setScale=function(a){this.graphScaleInv=1/a;this.graphScale=a};p.prototype.clearVelocity=function(){this.vy=this.vx=0};p.prototype.updateVelocity=function(a){var b=
this.vx*this.vx*a;this.vx=Math.sqrt(b/this.mass);b=this.vy*this.vy*a;this.vy=Math.sqrt(b/this.mass)};z.prototype.setProperties=function(a,b){if(a)switch(void 0!==a.from&&(this.fromId=a.from),void 0!==a.to&&(this.toId=a.to),void 0!==a.id&&(this.id=a.id),void 0!==a.style&&(this.style=a.style),void 0!==a.label&&(this.label=a.label),this.label&&(this.fontSize=b.edges.fontSize,this.fontFace=b.edges.fontFace,this.fontColor=b.edges.fontColor,void 0!==a.fontColor&&(this.fontColor=a.fontColor),void 0!==a.fontSize&&
(this.fontSize=a.fontSize),void 0!==a.fontFace&&(this.fontFace=a.fontFace)),void 0!==a.title&&(this.title=a.title),void 0!==a.width&&(this.width=a.width),void 0!==a.value&&(this.value=a.value),void 0!==a.length&&(this.length=a.length,this.customLength=!0),a.dash&&(void 0!==a.dash.length&&(this.dash.length=a.dash.length),void 0!==a.dash.gap&&(this.dash.gap=a.dash.gap),void 0!==a.dash.altLength&&(this.dash.altLength=a.dash.altLength)),void 0!==a.color&&(m.isString(a.color)?(this.color.color=a.color,
this.color.highlight=a.color):(void 0!==a.color.color&&(this.color.color=a.color.color),void 0!==a.color.highlight?this.color.highlight=a.color.highlight:void 0!==a.color.color&&(this.color.highlight=a.color.color))),this.connect(),this.widthFixed=this.widthFixed||void 0!==a.width,this.lengthFixed=this.lengthFixed||void 0!==a.length,this.style){case "line":this.draw=this._drawLine;break;case "arrow":this.draw=this._drawArrow;break;case "arrow-center":this.draw=this._drawArrowCenter;break;case "dash-line":this.draw=
this._drawDashLine;break;default:this.draw=this._drawLine}};z.prototype.connect=function(){this.disconnect();this.from=this.graph.nodes[this.fromId]||null;this.to=this.graph.nodes[this.toId]||null;(this.connected=this.from&&this.to)?(this.from.attachEdge(this),this.to.attachEdge(this)):(this.from&&this.from.detachEdge(this),this.to&&this.to.detachEdge(this))};z.prototype.disconnect=function(){this.from&&(this.from.detachEdge(this),this.from=null);this.to&&(this.to.detachEdge(this),this.to=null);this.connected=
!1};z.prototype.getTitle=function(){return this.title};z.prototype.getValue=function(){return this.value};z.prototype.setValueRange=function(a,b){!this.widthFixed&&void 0!==this.value&&(this.width=(this.value-a)*((this.widthMax-this.widthMin)/(b-a))+this.widthMin)};z.prototype.draw=function(a){throw"Method draw not initialized in edge";};z.prototype.isOverlappingWith=function(a){return 10>this._getDistanceToEdge(this.from.x,this.from.y,this.to.x,this.to.y,a.left,a.top)};z.prototype._drawLine=function(a){a.strokeStyle=
!0==this.selected?this.color.highlight:this.color.color;a.lineWidth=this._getLineWidth();if(this.from!=this.to){this._line(a);var b;this.label&&(b=!0==this.smooth?{x:0.5*(0.5*(this.from.x+this.via.x)+0.5*(this.to.x+this.via.x)),y:0.5*(0.5*(this.from.y+this.via.y)+0.5*(this.to.y+this.via.y))}:this._pointOnLine(0.5),this._label(a,this.label,b.x,b.y))}else{var c,d=this.length/4;c=this.from;c.width||c.resize(a);c.width>c.height?(b=c.x+c.width/2,c=c.y-d):(b=c.x+d,c=c.y-c.height/2);this._circle(a,b,c,d);
b=this._pointOnCircle(b,c,d,0.5);this._label(a,this.label,b.x,b.y)}};z.prototype._getLineWidth=function(){return!0==this.selected?Math.min(2*this.width,this.widthMax)*this.graphScaleInv:this.width*this.graphScaleInv};z.prototype._line=function(a){a.beginPath();a.moveTo(this.from.x,this.from.y);!0==this.smooth?a.quadraticCurveTo(this.via.x,this.via.y,this.to.x,this.to.y):a.lineTo(this.to.x,this.to.y);a.stroke()};z.prototype._circle=function(a,b,c,d){a.beginPath();a.arc(b,c,d,0,2*Math.PI,!1);a.stroke()};
z.prototype._label=function(a,b,c,d){if(b){a.font=(this.from.selected||this.to.selected?"bold ":"")+this.fontSize+"px "+this.fontFace;a.fillStyle="white";var e=a.measureText(b).width,k=this.fontSize;c-=e/2;d-=k/2;a.fillRect(c,d,e,k);a.fillStyle=this.fontColor||"black";a.textAlign="left";a.textBaseline="top";a.fillText(b,c,d)}};z.prototype._drawDashLine=function(a){a.strokeStyle=!0==this.selected?this.color.highlight:this.color.color;a.lineWidth=this._getLineWidth();if(void 0!==a.mozDash||void 0!==
a.setLineDash){a.beginPath();a.moveTo(this.from.x,this.from.y);var b=[0],b=void 0!==this.dash.length&&void 0!==this.dash.gap?[this.dash.length,this.dash.gap]:[5,5];"undefined"!==typeof a.setLineDash?(a.setLineDash(b),a.lineDashOffset=0):(a.mozDash=b,a.mozDashOffset=0);!0==this.smooth?a.quadraticCurveTo(this.via.x,this.via.y,this.to.x,this.to.y):a.lineTo(this.to.x,this.to.y);a.stroke();"undefined"!==typeof a.setLineDash?(a.setLineDash([0]),a.lineDashOffset=0):(a.mozDash=[0],a.mozDashOffset=0)}else a.beginPath(),
a.lineCap="round",void 0!==this.dash.altLength?a.dashedLine(this.from.x,this.from.y,this.to.x,this.to.y,[this.dash.length,this.dash.gap,this.dash.altLength,this.dash.gap]):void 0!==this.dash.length&&void 0!==this.dash.gap?a.dashedLine(this.from.x,this.from.y,this.to.x,this.to.y,[this.dash.length,this.dash.gap]):(a.moveTo(this.from.x,this.from.y),a.lineTo(this.to.x,this.to.y)),a.stroke();this.label&&(b=!0==this.smooth?{x:0.5*(0.5*(this.from.x+this.via.x)+0.5*(this.to.x+this.via.x)),y:0.5*(0.5*(this.from.y+
this.via.y)+0.5*(this.to.y+this.via.y))}:this._pointOnLine(0.5),this._label(a,this.label,b.x,b.y))};z.prototype._pointOnLine=function(a){return{x:(1-a)*this.from.x+a*this.to.x,y:(1-a)*this.from.y+a*this.to.y}};z.prototype._pointOnCircle=function(a,b,c,d){d=2*(d-0.375)*Math.PI;return{x:a+c*Math.cos(d),y:b-c*Math.sin(d)}};z.prototype._drawArrowCenter=function(a){var b;!0==this.selected?(a.strokeStyle=this.color.highlight,a.fillStyle=this.color.highlight):(a.strokeStyle=this.color.color,a.fillStyle=
this.color.color);a.lineWidth=this._getLineWidth();if(this.from!=this.to){this._line(a);var c=Math.atan2(this.to.y-this.from.y,this.to.x-this.from.x),d=10+5*this.width;b=!0==this.smooth?{x:0.5*(0.5*(this.from.x+this.via.x)+0.5*(this.to.x+this.via.x)),y:0.5*(0.5*(this.from.y+this.via.y)+0.5*(this.to.y+this.via.y))}:this._pointOnLine(0.5);a.arrow(b.x,b.y,c,d);a.fill();a.stroke();this.label&&this._label(a,this.label,b.x,b.y)}else{var e,k,f=0.25*Math.max(100,this.length);b=this.from;b.width||b.resize(a);
b.width>b.height?(e=b.x+0.5*b.width,k=b.y-f):(e=b.x+f,k=b.y-0.5*b.height);this._circle(a,e,k,f);c=0.2*Math.PI;d=10+5*this.width;b=this._pointOnCircle(e,k,f,0.5);a.arrow(b.x,b.y,c,d);a.fill();a.stroke();this.label&&(b=this._pointOnCircle(e,k,f,0.5),this._label(a,this.label,b.x,b.y))}};z.prototype._drawArrow=function(a){var b,c,d;!0==this.selected?(a.strokeStyle=this.color.highlight,a.fillStyle=this.color.highlight):(a.strokeStyle=this.color.color,a.fillStyle=this.color.color);a.lineWidth=this._getLineWidth();
var e;if(this.from!=this.to){b=Math.atan2(this.to.y-this.from.y,this.to.x-this.from.x);var k=this.to.x-this.from.x,f=this.to.y-this.from.y,k=Math.sqrt(k*k+f*f);e=this.from.distanceToBorder(a,b+Math.PI);var g=(k-e)/k;e=g*this.from.x+(1-g)*this.to.x;g=g*this.from.y+(1-g)*this.to.y;!0==this.smooth&&(b=Math.atan2(this.to.y-this.via.y,this.to.x-this.via.x),k=this.to.x-this.via.x,f=this.to.y-this.via.y,k=Math.sqrt(k*k+f*f));f=this.to.distanceToBorder(a,b);f=(k-f)/k;!0==this.smooth?(k=(1-f)*this.via.x+f*
this.to.x,f=(1-f)*this.via.y+f*this.to.y):(k=(1-f)*this.from.x+f*this.to.x,f=(1-f)*this.from.y+f*this.to.y);a.beginPath();a.moveTo(e,g);!0==this.smooth?a.quadraticCurveTo(this.via.x,this.via.y,k,f):a.lineTo(k,f);a.stroke();e=10+5*this.width;a.arrow(k,f,b,e);a.fill();a.stroke();this.label&&(b=!0==this.smooth?{x:0.5*(0.5*(this.from.x+this.via.x)+0.5*(this.to.x+this.via.x)),y:0.5*(0.5*(this.from.y+this.via.y)+0.5*(this.to.y+this.via.y))}:this._pointOnLine(0.5),this._label(a,this.label,b.x,b.y))}else e=
this.from,f=0.25*Math.max(100,this.length),e.width||e.resize(a),e.width>e.height?(g=e.x+0.5*e.width,k=e.y-f,b=g,c=e.y,d=0.9*Math.PI):(g=e.x+f,k=e.y-0.5*e.height,b=e.x,c=k,d=0.6*Math.PI),a.beginPath(),a.arc(g,k,f,0,2*Math.PI,!1),a.stroke(),e=10+5*this.width,a.arrow(b,c,d,e),a.fill(),a.stroke(),this.label&&(b=this._pointOnCircle(g,k,f,0.5),this._label(a,this.label,b.x,b.y))};z.prototype._getDistanceToEdge=function(a,b,c,d,e,k){if(!0==this.smooth){var f=1E9,g,h,m;for(g=0;10>g;g++)h=0.1*g,m=Math.pow(1-
h,2)*a+2*h*(1-h)*this.via.x+Math.pow(h,2)*c,h=Math.pow(1-h,2)*b+2*h*(1-h)*this.via.y+Math.pow(h,2)*d,m=Math.abs(e-m),h=Math.abs(k-h),f=Math.min(f,Math.sqrt(m*m+h*h));return f}c-=a;d-=b;f=((e-a)*c+(k-b)*d)/(c*c+d*d);1<f?f=1:0>f&&(f=0);m=a+f*c-e;h=b+f*d-k;return Math.sqrt(m*m+h*h)};z.prototype.setScale=function(a){this.graphScaleInv=1/a};z.prototype.select=function(){this.selected=!0};z.prototype.unselect=function(){this.selected=!1};z.prototype.positionBezierNode=function(){null!==this.via&&(this.via.x=
0.5*(this.from.x+this.to.x),this.via.y=0.5*(this.from.y+this.to.y))};V.prototype.setPosition=function(a,b){this.x=parseInt(a);this.y=parseInt(b)};V.prototype.setText=function(a){this.frame.innerHTML=a};V.prototype.show=function(a){void 0===a&&(a=!0);if(a){var b=this.frame.clientHeight;a=this.frame.clientWidth;var c=this.frame.parentNode.clientHeight,d=this.frame.parentNode.clientWidth,e=this.y-b;e+b+this.padding>c&&(e=c-b-this.padding);e<this.padding&&(e=this.padding);b=this.x;b+a+this.padding>d&&
(b=d-a-this.padding);b<this.padding&&(b=this.padding);this.frame.style.left=b+"px";this.frame.style.top=e+"px";this.frame.style.visibility="visible"}else this.hide()};V.prototype.hide=function(){this.frame.style.visibility="hidden"};Groups=function(){this.clear();this.defaultIndex=0};Groups.DEFAULT=[{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"}},{border:"#FFA500",background:"#FFFF00",highlight:{border:"#FFA500",background:"#FFFFA3"}},{border:"#FA0A10",background:"#FB7E81",
highlight:{border:"#FA0A10",background:"#FFAFB1"}},{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"}},{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"}},{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"}},{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"}},{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"}},
{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"}},{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"}}];Groups.prototype.clear=function(){this.groups={};this.groups.length=function(){var a=0,b;for(b in this)this.hasOwnProperty(b)&&a++;return a}};Groups.prototype.get=function(a){var b=this.groups[a];if(void 0==b){var c=this.defaultIndex%Groups.DEFAULT.length;this.defaultIndex++;b={};b.color=Groups.DEFAULT[c];this.groups[a]=
b}return b};Groups.prototype.add=function(a,b){this.groups[a]=b;b.color&&(b.color=p.parseColor(b.color));return b};Images=function(){this.images={};this.callback=void 0};Images.prototype.setOnloadCallback=function(a){this.callback=a};Images.prototype.load=function(a){var b=this.images[a];if(void 0==b){var c=this,b=new Image;this.images[a]=b;b.onload=function(){c.callback&&c.callback(this)};b.src=a}return b};var ea={_toggleBarnesHut:function(){this.constants.physics.barnesHut.enabled=!this.constants.physics.barnesHut.enabled;
this._loadSelectedForceSolver();this.moving=!0;this.start()},_loadSelectedForceSolver:function(){!0==this.constants.physics.barnesHut.enabled?(this._clearMixin(ba),this._clearMixin(ca),this.constants.physics.centralGravity=this.constants.physics.barnesHut.centralGravity,this.constants.physics.springLength=this.constants.physics.barnesHut.springLength,this.constants.physics.springConstant=this.constants.physics.barnesHut.springConstant,this.constants.physics.damping=this.constants.physics.barnesHut.damping,
this._loadMixin(da)):!0==this.constants.physics.hierarchicalRepulsion.enabled?(this._clearMixin(da),this._clearMixin(ba),this.constants.physics.centralGravity=this.constants.physics.hierarchicalRepulsion.centralGravity,this.constants.physics.springLength=this.constants.physics.hierarchicalRepulsion.springLength,this.constants.physics.springConstant=this.constants.physics.hierarchicalRepulsion.springConstant,this.constants.physics.damping=this.constants.physics.hierarchicalRepulsion.damping,this._loadMixin(ca)):
(this._clearMixin(da),this._clearMixin(ca),this.barnesHutTree=void 0,this.constants.physics.centralGravity=this.constants.physics.repulsion.centralGravity,this.constants.physics.springLength=this.constants.physics.repulsion.springLength,this.constants.physics.springConstant=this.constants.physics.repulsion.springConstant,this.constants.physics.damping=this.constants.physics.repulsion.damping,this._loadMixin(ba))},_initializeForceCalculation:function(){1==this.nodeIndices.length?this.nodes[this.nodeIndices[0]]._setForce(0,
0):(this.nodeIndices.length>this.constants.clustering.clusterThreshold&&!0==this.constants.clustering.enabled&&this.clusterToFit(this.constants.clustering.reduceToNodes,!1),this._calculateForces())},_calculateForces:function(){this._calculateGravitationalForces();this._calculateNodeForces();!0==this.constants.smoothCurves?this._calculateSpringForcesWithSupport():this._calculateSpringForces()},_updateCalculationNodes:function(){if(!0==this.constants.smoothCurves){this.calculationNodes={};this.calculationNodeIndices=
[];for(var a in this.nodes)this.nodes.hasOwnProperty(a)&&(this.calculationNodes[a]=this.nodes[a]);a=this.sectors.support.nodes;for(var b in a)a.hasOwnProperty(b)&&(this.edges.hasOwnProperty(a[b].parentEdgeId)?this.calculationNodes[b]=a[b]:a[b]._setForce(0,0));for(var c in this.calculationNodes)this.calculationNodes.hasOwnProperty(c)&&this.calculationNodeIndices.push(c)}else this.calculationNodes=this.nodes,this.calculationNodeIndices=this.nodeIndices},_calculateGravitationalForces:function(){var a,
b,c,d,e,k=this.calculationNodes,f=this.constants.physics.centralGravity;for(e=c=0;e<this.calculationNodeIndices.length;e++)d=k[this.calculationNodeIndices[e]],d.damping=this.constants.physics.damping,"default"==this._sector()&&0!=f?(a=-d.x,b=-d.y,c=Math.sqrt(a*a+b*b),c=f/c,d.fx=a*c,d.fy=b*c):(d.fx=0,d.fy=0)},_calculateSpringForces:function(){var a,b,c,d,e,k,f=this.edges;for(c in f)f.hasOwnProperty(c)&&(b=f[c],b.connected&&(this.nodes.hasOwnProperty(b.toId)&&this.nodes.hasOwnProperty(b.fromId))&&(a=
b.customLength?b.length:this.constants.physics.springLength,a+=(b.to.clusterSize+b.from.clusterSize-2)*this.constants.clustering.edgeGrowth,d=b.from.x-b.to.x,e=b.from.y-b.to.y,k=Math.sqrt(d*d+e*e),0==k&&(k=0.01),a=this.constants.physics.springConstant*(a-k)/k,d*=a,e*=a,b.from.fx+=d,b.from.fy+=e,b.to.fx-=d,b.to.fy-=e))},_calculateSpringForcesWithSupport:function(){var a,b,c,d=this.edges;for(b in d)if(d.hasOwnProperty(b)&&(a=d[b],a.connected&&this.nodes.hasOwnProperty(a.toId)&&this.nodes.hasOwnProperty(a.fromId)&&
null!=a.via)){var e=a.to,k=a.via,f=a.from;a=a.customLength?a.length:this.constants.physics.springLength;c=e.clusterSize+f.clusterSize-2;a+=c*this.constants.clustering.edgeGrowth;this._calculateSpringForce(e,k,0.5*a);this._calculateSpringForce(k,f,0.5*a)}},_calculateSpringForce:function(a,b,c){var d,e,f;d=a.x-b.x;e=a.y-b.y;f=Math.sqrt(d*d+e*e);c=this.constants.physics.springConstant*(c-f)/f;d*=c;e*=c;a.fx+=d;a.fy+=e;b.fx-=d;b.fy-=e},_loadPhysicsConfiguration:function(){if(void 0===this.physicsConfiguration){var a=
["LR","RL","UD","DU"];this.physicsConfiguration=document.createElement("div");this.physicsConfiguration.className="PhysicsConfiguration";this.physicsConfiguration.innerHTML='<table><tr><td><b>Simulation Mode:</b></td></tr><tr><td width="120px"><input type="radio" name="graph_physicsMethod" id="graph_physicsMethod1" value="BH" checked="checked">Barnes Hut</td><td width="120px"><input type="radio" name="graph_physicsMethod" id="graph_physicsMethod2" value="R">Repulsion</td><td width="120px"><input type="radio" name="graph_physicsMethod" id="graph_physicsMethod3" value="H">Hierarchical</td></tr></table><table id="graph_BH_table" style="display:none"><tr><td><b>Barnes Hut</b></td></tr><tr><td width="150px">gravitationalConstant</td><td>0</td><td><input type="range" min="500" max="20000" value="'+
-1*this.constants.physics.barnesHut.gravitationalConstant+'" step="25" style="width:300px" id="graph_BH_gc"></td><td  width="50px">-20000</td><td><input value="'+-1*this.constants.physics.barnesHut.gravitationalConstant+'" id="graph_BH_gc_value" style="width:60px"></td></tr><tr><td width="150px">centralGravity</td><td>0</td><td><input type="range" min="0" max="3"  value="'+this.constants.physics.barnesHut.centralGravity+'" step="0.05"  style="width:300px" id="graph_BH_cg"></td><td>3</td><td><input value="'+
this.constants.physics.barnesHut.centralGravity+'" id="graph_BH_cg_value" style="width:60px"></td></tr><tr><td width="150px">springLength</td><td>0</td><td><input type="range" min="0" max="500" value="'+this.constants.physics.barnesHut.springLength+'" step="1" style="width:300px" id="graph_BH_sl"></td><td>500</td><td><input value="'+this.constants.physics.barnesHut.springLength+'" id="graph_BH_sl_value" style="width:60px"></td></tr><tr><td width="150px">springConstant</td><td>0</td><td><input type="range" min="0" max="0.5" value="'+
this.constants.physics.barnesHut.springConstant+'" step="0.001" style="width:300px" id="graph_BH_sc"></td><td>0.5</td><td><input value="'+this.constants.physics.barnesHut.springConstant+'" id="graph_BH_sc_value" style="width:60px"></td></tr><tr><td width="150px">damping</td><td>0</td><td><input type="range" min="0" max="0.3" value="'+this.constants.physics.barnesHut.damping+'" step="0.005" style="width:300px" id="graph_BH_damp"></td><td>0.3</td><td><input value="'+this.constants.physics.barnesHut.damping+
'" id="graph_BH_damp_value" style="width:60px"></td></tr></table><table id="graph_R_table" style="display:none"><tr><td><b>Repulsion</b></td></tr><tr><td width="150px">nodeDistance</td><td>0</td><td><input type="range" min="0" max="300" value="'+this.constants.physics.repulsion.nodeDistance+'" step="1" style="width:300px" id="graph_R_nd"></td><td width="50px">300</td><td><input value="'+this.constants.physics.repulsion.nodeDistance+'" id="graph_R_nd_value" style="width:60px"></td></tr><tr><td width="150px">centralGravity</td><td>0</td><td><input type="range" min="0" max="3"  value="'+
this.constants.physics.repulsion.centralGravity+'" step="0.05"  style="width:300px" id="graph_R_cg"></td><td>3</td><td><input value="'+this.constants.physics.repulsion.centralGravity+'" id="graph_R_cg_value" style="width:60px"></td></tr><tr><td width="150px">springLength</td><td>0</td><td><input type="range" min="0" max="500" value="'+this.constants.physics.repulsion.springLength+'" step="1" style="width:300px" id="graph_R_sl"></td><td>500</td><td><input value="'+this.constants.physics.repulsion.springLength+
'" id="graph_R_sl_value" style="width:60px"></td></tr><tr><td width="150px">springConstant</td><td>0</td><td><input type="range" min="0" max="0.5" value="'+this.constants.physics.repulsion.springConstant+'" step="0.001" style="width:300px" id="graph_R_sc"></td><td>0.5</td><td><input value="'+this.constants.physics.repulsion.springConstant+'" id="graph_R_sc_value" style="width:60px"></td></tr><tr><td width="150px">damping</td><td>0</td><td><input type="range" min="0" max="0.3" value="'+this.constants.physics.repulsion.damping+
'" step="0.005" style="width:300px" id="graph_R_damp"></td><td>0.3</td><td><input value="'+this.constants.physics.repulsion.damping+'" id="graph_R_damp_value" style="width:60px"></td></tr></table><table id="graph_H_table" style="display:none"><tr><td width="150"><b>Hierarchical</b></td></tr><tr><td width="150px">nodeDistance</td><td>0</td><td><input type="range" min="0" max="300" value="'+this.constants.physics.hierarchicalRepulsion.nodeDistance+'" step="1" style="width:300px" id="graph_H_nd"></td><td width="50px">300</td><td><input value="'+
this.constants.physics.hierarchicalRepulsion.nodeDistance+'" id="graph_H_nd_value" style="width:60px"></td></tr><tr><td width="150px">centralGravity</td><td>0</td><td><input type="range" min="0" max="3"  value="'+this.constants.physics.hierarchicalRepulsion.centralGravity+'" step="0.05"  style="width:300px" id="graph_H_cg"></td><td>3</td><td><input value="'+this.constants.physics.hierarchicalRepulsion.centralGravity+'" id="graph_H_cg_value" style="width:60px"></td></tr><tr><td width="150px">springLength</td><td>0</td><td><input type="range" min="0" max="500" value="'+
this.constants.physics.hierarchicalRepulsion.springLength+'" step="1" style="width:300px" id="graph_H_sl"></td><td>500</td><td><input value="'+this.constants.physics.hierarchicalRepulsion.springLength+'" id="graph_H_sl_value" style="width:60px"></td></tr><tr><td width="150px">springConstant</td><td>0</td><td><input type="range" min="0" max="0.5" value="'+this.constants.physics.hierarchicalRepulsion.springConstant+'" step="0.001" style="width:300px" id="graph_H_sc"></td><td>0.5</td><td><input value="'+
this.constants.physics.hierarchicalRepulsion.springConstant+'" id="graph_H_sc_value" style="width:60px"></td></tr><tr><td width="150px">damping</td><td>0</td><td><input type="range" min="0" max="0.3" value="'+this.constants.physics.hierarchicalRepulsion.damping+'" step="0.005" style="width:300px" id="graph_H_damp"></td><td>0.3</td><td><input value="'+this.constants.physics.hierarchicalRepulsion.damping+'" id="graph_H_damp_value" style="width:60px"></td></tr><tr><td width="150px">direction</td><td>1</td><td><input type="range" min="0" max="3" value="'+
a.indexOf(this.constants.hierarchicalLayout.direction)+'" step="1" style="width:300px" id="graph_H_direction"></td><td>4</td><td><input value="'+this.constants.hierarchicalLayout.direction+'" id="graph_H_direction_value" style="width:60px"></td></tr><tr><td width="150px">levelSeparation</td><td>1</td><td><input type="range" min="0" max="500" value="'+this.constants.hierarchicalLayout.levelSeparation+'" step="1" style="width:300px" id="graph_H_levsep"></td><td>500</td><td><input value="'+this.constants.hierarchicalLayout.levelSeparation+
'" id="graph_H_levsep_value" style="width:60px"></td></tr><tr><td width="150px">nodeSpacing</td><td>1</td><td><input type="range" min="0" max="500" value="'+this.constants.hierarchicalLayout.nodeSpacing+'" step="1" style="width:300px" id="graph_H_nspac"></td><td>500</td><td><input value="'+this.constants.hierarchicalLayout.nodeSpacing+'" id="graph_H_nspac_value" style="width:60px"></td></tr></table>';this.containerElement.parentElement.insertBefore(this.physicsConfiguration,this.containerElement);
var b;b=document.getElementById("graph_BH_gc");b.onchange=O.bind(this,"graph_BH_gc",-1,"physics_barnesHut_gravitationalConstant");b=document.getElementById("graph_BH_cg");b.onchange=O.bind(this,"graph_BH_cg",1,"physics_centralGravity");b=document.getElementById("graph_BH_sc");b.onchange=O.bind(this,"graph_BH_sc",1,"physics_springConstant");b=document.getElementById("graph_BH_sl");b.onchange=O.bind(this,"graph_BH_sl",1,"physics_springLength");b=document.getElementById("graph_BH_damp");b.onchange=O.bind(this,
"graph_BH_damp",1,"physics_damping");b=document.getElementById("graph_R_nd");b.onchange=O.bind(this,"graph_R_nd",1,"physics_repulsion_nodeDistance");b=document.getElementById("graph_R_cg");b.onchange=O.bind(this,"graph_R_cg",1,"physics_centralGravity");b=document.getElementById("graph_R_sc");b.onchange=O.bind(this,"graph_R_sc",1,"physics_springConstant");b=document.getElementById("graph_R_sl");b.onchange=O.bind(this,"graph_R_sl",1,"physics_springLength");b=document.getElementById("graph_R_damp");
b.onchange=O.bind(this,"graph_R_damp",1,"physics_damping");b=document.getElementById("graph_H_nd");b.onchange=O.bind(this,"graph_H_nd",1,"physics_hierarchicalRepulsion_nodeDistance");b=document.getElementById("graph_H_cg");b.onchange=O.bind(this,"graph_H_cg",1,"physics_centralGravity");b=document.getElementById("graph_H_sc");b.onchange=O.bind(this,"graph_H_sc",1,"physics_springConstant");b=document.getElementById("graph_H_sl");b.onchange=O.bind(this,"graph_H_sl",1,"physics_springLength");b=document.getElementById("graph_H_damp");
b.onchange=O.bind(this,"graph_H_damp",1,"physics_damping");b=document.getElementById("graph_H_direction");b.onchange=O.bind(this,"graph_H_direction",a,"hierarchicalLayout_direction");b=document.getElementById("graph_H_levsep");b.onchange=O.bind(this,"graph_H_levsep",1,"hierarchicalLayout_levelSeparation");b=document.getElementById("graph_H_nspac");b.onchange=O.bind(this,"graph_H_nspac",1,"hierarchicalLayout_nodeSpacing");a=document.getElementById("graph_physicsMethod1");b=document.getElementById("graph_physicsMethod2");
var c=document.getElementById("graph_physicsMethod3");b.checked=!0;this.constants.physics.barnesHut.enabled&&(a.checked=!0);this.constants.hierarchicalLayout.enabled&&(c.checked=!0);$.apply(this);a.onchange=$.bind(this);b.onchange=$.bind(this);c.onchange=$.bind(this)}},_overWriteGraphConstants:function(a,b){var c=a.split("_");1==c.length?this.constants[c[0]]=b:2==c.length?this.constants[c[0]][c[1]]=b:3==c.length&&(this.constants[c[0]][c[1]][c[2]]=b)}},ca={_calculateNodeForces:function(){var a,b,c,
d,e,f,l,g,h=this.calculationNodes,m=this.calculationNodeIndices,p=this.constants.physics.hierarchicalRepulsion.nodeDistance;for(l=0;l<m.length-1;l++){e=h[m[l]];for(g=l+1;g<m.length;g++)f=h[m[g]],a=f.x-e.x,b=f.y-e.y,c=Math.sqrt(a*a+b*b),d=-2.5/p,c<2*p&&(d=d*c+5,0!=c&&(d/=c),a*=d,b*=d,e.fx-=a,e.fy-=b,f.fx+=a,f.fy+=b)}}},da={_calculateNodeForces:function(){var a,b=this.calculationNodes,c=this.calculationNodeIndices,d=c.length;this._formBarnesHutTree(b,c);for(var e=this.barnesHutTree,f=0;f<d;f++)a=b[c[f]],
this._getForceContribution(e.root.children.NW,a),this._getForceContribution(e.root.children.NE,a),this._getForceContribution(e.root.children.SW,a),this._getForceContribution(e.root.children.SE,a)},_getForceContribution:function(a,b){if(0<a.childrenCount){var c,d,e;c=a.centerOfMass.x-b.x;d=a.centerOfMass.y-b.y;e=Math.sqrt(c*c+d*d);e*a.calcSize>this.constants.physics.barnesHut.theta?(0==e&&(c=e=0.1*Math.random()),e=this.constants.physics.barnesHut.gravitationalConstant*a.mass*b.mass/(e*e*e),b.fx+=c*
e,b.fy+=d*e):4==a.childrenCount?(this._getForceContribution(a.children.NW,b),this._getForceContribution(a.children.NE,b),this._getForceContribution(a.children.SW,b),this._getForceContribution(a.children.SE,b)):a.children.data.id!=b.id&&(0==e&&(c=e=0.5*Math.random()),e=this.constants.physics.barnesHut.gravitationalConstant*a.mass*b.mass/(e*e*e),b.fx+=c*e,b.fy+=d*e)}},_formBarnesHutTree:function(a,b){var c,d=b.length,e=Number.MAX_VALUE;c=Number.MAX_VALUE;for(var f=-Number.MAX_VALUE,l=-Number.MAX_VALUE,
g=0;g<d;g++){var h=a[b[g]].x,m=a[b[g]].y;h<e&&(e=h);h>f&&(f=h);m<c&&(c=m);m>l&&(l=m)}g=Math.abs(f-e)-Math.abs(l-c);0<g?(c-=0.5*g,l+=0.5*g):(e+=0.5*g,f-=0.5*g);g=Math.max(1E-5,Math.abs(f-e));h=0.5*g;e=0.5*(e+f);c=0.5*(c+l);l={root:{centerOfMass:{x:0,y:0},mass:0,range:{minX:e-h,maxX:e+h,minY:c-h,maxY:c+h},size:g,calcSize:1/g,children:{data:null},maxWidth:0,level:0,childrenCount:4}};this._splitBranch(l.root);for(g=0;g<d;g++)c=a[b[g]],this._placeInTree(l.root,c);this.barnesHutTree=l},_updateBranchMass:function(a,
b){var c=a.mass+b.mass,d=1/c;a.centerOfMass.x=a.centerOfMass.x*a.mass+b.x*b.mass;a.centerOfMass.x*=d;a.centerOfMass.y=a.centerOfMass.y*a.mass+b.y*b.mass;a.centerOfMass.y*=d;a.mass=c;c=Math.max(Math.max(b.height,b.radius),b.width);a.maxWidth=a.maxWidth<c?c:a.maxWidth},_placeInTree:function(a,b,c){(!0!=c||void 0===c)&&this._updateBranchMass(a,b);a.children.NW.range.maxX>b.x?a.children.NW.range.maxY>b.y?this._placeInRegion(a,b,"NW"):this._placeInRegion(a,b,"SW"):a.children.NW.range.maxY>b.y?this._placeInRegion(a,
b,"NE"):this._placeInRegion(a,b,"SE")},_placeInRegion:function(a,b,c){switch(a.children[c].childrenCount){case 0:a.children[c].children.data=b;a.children[c].childrenCount=1;this._updateBranchMass(a.children[c],b);break;case 1:a.children[c].children.data.x==b.x&&a.children[c].children.data.y==b.y?(b.x+=Math.random(),b.y+=Math.random(),this._placeInTree(a,b,!0)):(this._splitBranch(a.children[c]),this._placeInTree(a.children[c],b));break;case 4:this._placeInTree(a.children[c],b)}},_splitBranch:function(a){var b=
null;1==a.childrenCount&&(b=a.children.data,a.mass=0,a.centerOfMass.x=0,a.centerOfMass.y=0);a.childrenCount=4;a.children.data=null;this._insertRegion(a,"NW");this._insertRegion(a,"NE");this._insertRegion(a,"SW");this._insertRegion(a,"SE");null!=b&&this._placeInTree(a,b)},_insertRegion:function(a,b){var c,d,e,f,g=0.5*a.size;switch(b){case "NW":c=a.range.minX;d=a.range.minX+g;e=a.range.minY;f=a.range.minY+g;break;case "NE":c=a.range.minX+g;d=a.range.maxX;e=a.range.minY;f=a.range.minY+g;break;case "SW":c=
a.range.minX;d=a.range.minX+g;e=a.range.minY+g;f=a.range.maxY;break;case "SE":c=a.range.minX+g,d=a.range.maxX,e=a.range.minY+g,f=a.range.maxY}a.children[b]={centerOfMass:{x:0,y:0},mass:0,range:{minX:c,maxX:d,minY:e,maxY:f},size:0.5*a.size,calcSize:2*a.calcSize,children:{data:null},maxWidth:0,level:a.level+1,childrenCount:0}},_drawTree:function(a,b){void 0!==this.barnesHutTree&&(a.lineWidth=1,this._drawBranch(this.barnesHutTree.root,a,b))},_drawBranch:function(a,b,c){void 0===c&&(c="#FF0000");4==a.childrenCount&&
(this._drawBranch(a.children.NW,b),this._drawBranch(a.children.NE,b),this._drawBranch(a.children.SE,b),this._drawBranch(a.children.SW,b));b.strokeStyle=c;b.beginPath();b.moveTo(a.range.minX,a.range.minY);b.lineTo(a.range.maxX,a.range.minY);b.stroke();b.beginPath();b.moveTo(a.range.maxX,a.range.minY);b.lineTo(a.range.maxX,a.range.maxY);b.stroke();b.beginPath();b.moveTo(a.range.maxX,a.range.maxY);b.lineTo(a.range.minX,a.range.maxY);b.stroke();b.beginPath();b.moveTo(a.range.minX,a.range.maxY);b.lineTo(a.range.minX,
a.range.minY);b.stroke()}},ba={_calculateNodeForces:function(){var a,b,c,d,e,f,g,h,m,p=this.calculationNodes,s=this.calculationNodeIndices,r=-2/3,t=4/3,y=this.constants.physics.repulsion.nodeDistance;e=y;for(h=0;h<s.length-1;h++){f=p[s[h]];for(m=h+1;m<s.length;m++){g=p[s[m]];d=f.clusterSize+g.clusterSize-2;a=g.x-f.x;b=g.y-f.y;c=Math.sqrt(a*a+b*b);e=0==d?y:y*(1+d*this.constants.clustering.distanceAmplification);var q=r/e;c<2*e&&(e=c<0.5*e?1:q*c+t,e*=0==d?1:1+d*this.constants.clustering.forceAmplification,
e/=c,a*=e,b*=e,f.fx-=a,f.fy-=b,g.fx+=a,g.fy+=b)}}}},na={_setupHierarchicalLayout:function(){if(!0==this.constants.hierarchicalLayout.enabled){this.constants.hierarchicalLayout.levelSeparation="RL"==this.constants.hierarchicalLayout.direction||"DU"==this.constants.hierarchicalLayout.direction?-1*this.constants.hierarchicalLayout.levelSeparation:Math.abs(this.constants.hierarchicalLayout.levelSeparation);var a=0,b,c,d=!1,e=!1;for(c in this.nodes)this.nodes.hasOwnProperty(c)&&(b=this.nodes[c],-1!=b.level?
d=!0:e=!0,a<b.edges.length&&(a=b.edges.length));!0==e&&!0==d?(alert("To use the hierarchical layout, nodes require either no predefined levels or levels have to be defined for all nodes."),this.zoomExtent(!0,this.constants.clustering.enabled),this.constants.clustering.enabled||this.start()):(this._changeConstants(),!0==e&&this._determineLevels(a),a=this._getDistribution(),this._placeNodesByHierarchy(a),this.start())}},_placeNodesByHierarchy:function(a){var b,c;for(b in a[0].nodes)a[0].nodes.hasOwnProperty(b)&&
(c=a[0].nodes[b],"UD"==this.constants.hierarchicalLayout.direction||"DU"==this.constants.hierarchicalLayout.direction?c.xFixed&&(c.x=a[0].minPos,c.xFixed=!1,a[0].minPos+=a[0].nodeSpacing):c.yFixed&&(c.y=a[0].minPos,c.yFixed=!1,a[0].minPos+=a[0].nodeSpacing),this._placeBranchNodes(c.edges,c.id,a,c.level));this._stabilize()},_getDistribution:function(){var a={},b,c;for(b in this.nodes)this.nodes.hasOwnProperty(b)&&(c=this.nodes[b],c.xFixed=!0,c.yFixed=!0,"UD"==this.constants.hierarchicalLayout.direction||
"DU"==this.constants.hierarchicalLayout.direction?c.y=this.constants.hierarchicalLayout.levelSeparation*c.level:c.x=this.constants.hierarchicalLayout.levelSeparation*c.level,a.hasOwnProperty(c.level)||(a[c.level]={amount:0,nodes:{},minPos:0,nodeSpacing:0}),a[c.level].amount+=1,a[c.level].nodes[c.id]=c);b=0;for(var d in a)a.hasOwnProperty(d)&&b<a[d].amount&&(b=a[d].amount);for(d in a)a.hasOwnProperty(d)&&(a[d].nodeSpacing=(b+1)*this.constants.hierarchicalLayout.nodeSpacing,a[d].nodeSpacing/=a[d].amount+
1,a[d].minPos=a[d].nodeSpacing-0.5*(a[d].amount+1)*a[d].nodeSpacing);return a},_determineLevels:function(a){var b,c;for(b in this.nodes)this.nodes.hasOwnProperty(b)&&(c=this.nodes[b],c.edges.length==a&&(c.level=0));for(b in this.nodes)this.nodes.hasOwnProperty(b)&&(c=this.nodes[b],0==c.level&&this._setLevel(1,c.edges,c.id))},_changeConstants:function(){this.constants.clustering.enabled=!1;this.constants.physics.barnesHut.enabled=!1;this.constants.physics.hierarchicalRepulsion.enabled=!0;this._loadSelectedForceSolver();
this.constants.smoothCurves=!1;this._configureSmoothCurves()},_placeBranchNodes:function(a,b,c,d){for(var e=0;e<a.length;e++){var f=null,f=a[e].toId==b?a[e].from:a[e].to,g=!1;"UD"==this.constants.hierarchicalLayout.direction||"DU"==this.constants.hierarchicalLayout.direction?f.xFixed&&f.level>d&&(f.xFixed=!1,f.x=c[f.level].minPos,g=!0):f.yFixed&&f.level>d&&(f.yFixed=!1,f.y=c[f.level].minPos,g=!0);!0==g&&(c[f.level].minPos+=c[f.level].nodeSpacing,1<f.edges.length&&this._placeBranchNodes(f.edges,f.id,
c,f.level))}},_setLevel:function(a,b,c){for(var d=0;d<b.length;d++){var e=null,e=b[d].toId==c?b[d].from:b[d].to;if(-1==e.level||e.level>a)e.level=a,1<b.length&&this._setLevel(a+1,e.edges,e.id)}},_restoreNodes:function(){for(nodeId in this.nodes)this.nodes.hasOwnProperty(nodeId)&&(this.nodes[nodeId].xFixed=!1,this.nodes[nodeId].yFixed=!1)}},fa={_clearManipulatorBar:function(){for(;this.manipulationDiv.hasChildNodes();)this.manipulationDiv.removeChild(this.manipulationDiv.firstChild)},_restoreOverloadedFunctions:function(){for(var a in this.cachedFunctions)this.cachedFunctions.hasOwnProperty(a)&&
(this[a]=this.cachedFunctions[a])},_toggleEditMode:function(){this.editMode=!this.editMode;var a=document.getElementById("graph-manipulationDiv"),b=document.getElementById("graph-manipulation-closeDiv"),c=document.getElementById("graph-manipulation-editMode");!0==this.editMode?(a.style.display="block",b.style.display="block",c.style.display="none",b.onclick=this._toggleEditMode.bind(this)):(a.style.display="none",b.style.display="none",c.style.display="block",b.onclick=null);this._createManipulatorBar()},
_createManipulatorBar:function(){this.off("select",this.boundFunction);this._restoreOverloadedFunctions();this.forceAppendSelection=this.blockConnectingEdgeSelection=this.freezeSimulation=!1;if(!0==this.editMode){for(;this.manipulationDiv.hasChildNodes();)this.manipulationDiv.removeChild(this.manipulationDiv.firstChild);this.manipulationDiv.innerHTML="<span class='graph-manipulationUI add' id='graph-manipulate-addNode'><span class='graph-manipulationLabel'>Add Node</span></span><div class='graph-seperatorLine'></div><span class='graph-manipulationUI connect' id='graph-manipulate-connectNode'><span class='graph-manipulationLabel'>Add Link</span></span>";
1==this._getSelectedNodeCount()&&this.triggerFunctions.edit&&(this.manipulationDiv.innerHTML+="<div class='graph-seperatorLine'></div><span class='graph-manipulationUI edit' id='graph-manipulate-editNode'><span class='graph-manipulationLabel'>Edit Node</span></span>");!1==this._selectionIsEmpty()&&(this.manipulationDiv.innerHTML+="<div class='graph-seperatorLine'></div><span class='graph-manipulationUI delete' id='graph-manipulate-delete'><span class='graph-manipulationLabel'>Delete selected</span></span>");
document.getElementById("graph-manipulate-addNode").onclick=this._createAddNodeToolbar.bind(this);document.getElementById("graph-manipulate-connectNode").onclick=this._createAddEdgeToolbar.bind(this);1==this._getSelectedNodeCount()&&this.triggerFunctions.edit&&(document.getElementById("graph-manipulate-editNode").onclick=this._editNode.bind(this));!1==this._selectionIsEmpty()&&(document.getElementById("graph-manipulate-delete").onclick=this._deleteSelected.bind(this));document.getElementById("graph-manipulation-closeDiv").onclick=
this._toggleEditMode.bind(this);this.boundFunction=this._createManipulatorBar.bind(this);this.on("select",this.boundFunction)}else this.editModeDiv.innerHTML="<span class='graph-manipulationUI edit editmode' id='graph-manipulate-editModeButton'><span class='graph-manipulationLabel'>Edit</span></span>",document.getElementById("graph-manipulate-editModeButton").onclick=this._toggleEditMode.bind(this)},_createAddNodeToolbar:function(){this._clearManipulatorBar();this.off("select",this.boundFunction);
this.manipulationDiv.innerHTML="<span class='graph-manipulationUI back' id='graph-manipulate-back'><span class='graph-manipulationLabel'>Back</span></span><div class='graph-seperatorLine'></div><span class='graph-manipulationUI none' id='graph-manipulate-back'><span class='graph-manipulationLabel'>Click in an empty space to place a new node</span></span>";document.getElementById("graph-manipulate-back").onclick=this._createManipulatorBar.bind(this);this.boundFunction=this._addNode.bind(this);this.on("select",
this.boundFunction)},_createAddEdgeToolbar:function(){this._clearManipulatorBar();this._unselectAll(!0);this.freezeSimulation=!0;this.off("select",this.boundFunction);this._unselectAll();this.forceAppendSelection=!1;this.blockConnectingEdgeSelection=!0;this.manipulationDiv.innerHTML="<span class='graph-manipulationUI back' id='graph-manipulate-back'><span class='graph-manipulationLabel'>Back</span></span><div class='graph-seperatorLine'></div><span class='graph-manipulationUI none' id='graph-manipulate-back'><span id='graph-manipulatorLabel' class='graph-manipulationLabel'>Click on a node and drag the edge to another node to connect them.</span></span>";
document.getElementById("graph-manipulate-back").onclick=this._createManipulatorBar.bind(this);this.boundFunction=this._handleConnect.bind(this);this.on("select",this.boundFunction);this.cachedFunctions._handleTouch=this._handleTouch;this.cachedFunctions._handleOnRelease=this._handleOnRelease;this._handleTouch=this._handleConnect;this._handleOnRelease=this._finishConnect;this._redraw()},_handleConnect:function(a){0==this._getSelectedNodeCount()&&(a=this._getNodeAt(a),null!=a&&(1<a.clusterSize?alert("Cannot create edges to a cluster."):
(this._selectObject(a,!1),this.sectors.support.nodes.targetNode=new p({id:"targetNode"},{},{},this.constants),this.sectors.support.nodes.targetNode.x=a.x,this.sectors.support.nodes.targetNode.y=a.y,this.sectors.support.nodes.targetViaNode=new p({id:"targetViaNode"},{},{},this.constants),this.sectors.support.nodes.targetViaNode.x=a.x,this.sectors.support.nodes.targetViaNode.y=a.y,this.sectors.support.nodes.targetViaNode.parentEdgeId="connectionEdge",this.edges.connectionEdge=new z({id:"connectionEdge",
from:a.id,to:this.sectors.support.nodes.targetNode.id},this,this.constants),this.edges.connectionEdge.from=a,this.edges.connectionEdge.connected=!0,this.edges.connectionEdge.smooth=!0,this.edges.connectionEdge.selected=!0,this.edges.connectionEdge.to=this.sectors.support.nodes.targetNode,this.edges.connectionEdge.via=this.sectors.support.nodes.targetViaNode,this.cachedFunctions._handleOnDrag=this._handleOnDrag,this._handleOnDrag=function(a){a=this._getPointer(a.gesture.center);this.sectors.support.nodes.targetNode.x=
this._canvasToX(a.x);this.sectors.support.nodes.targetNode.y=this._canvasToY(a.y);this.sectors.support.nodes.targetViaNode.x=0.5*(this._canvasToX(a.x)+this.edges.connectionEdge.from.x);this.sectors.support.nodes.targetViaNode.y=this._canvasToY(a.y)},this.moving=!0,this.start())))},_finishConnect:function(a){if(1==this._getSelectedNodeCount()){this._handleOnDrag=this.cachedFunctions._handleOnDrag;delete this.cachedFunctions._handleOnDrag;var b=this.edges.connectionEdge.fromId;delete this.edges.connectionEdge;
delete this.sectors.support.nodes.targetNode;delete this.sectors.support.nodes.targetViaNode;a=this._getNodeAt(a);null!=a&&(1<a.clusterSize?alert("Cannot create edges to a cluster."):(this._createEdge(b,a.id),this._createManipulatorBar()));this._unselectAll()}},_addNode:function(){if(this._selectionIsEmpty()&&!0==this.editMode){var a=this._pointerToPositionObject(this.pointerPosition),a={id:m.randomUUID(),x:a.left,y:a.top,label:"new",allowedToMoveX:!0,allowedToMoveY:!0};if(this.triggerFunctions.add)if(2==
this.triggerFunctions.add.length){var b=this;this.triggerFunctions.add(a,function(a){b.createNodeOnClick=!0;b.nodesData.add(a);b.createNodeOnClick=!1;b._createManipulatorBar();b.moving=!0;b.start()})}else alert("The function for add does not support two arguments (data,callback)."),this._createManipulatorBar(),this.moving=!0,this.start();else this.createNodeOnClick=!0,this.nodesData.add(a),this.createNodeOnClick=!1,this._createManipulatorBar(),this.moving=!0,this.start()}},_createEdge:function(a,
b){if(!0==this.editMode){var c={from:a,to:b};if(this.triggerFunctions.connect)if(2==this.triggerFunctions.connect.length){var d=this;this.triggerFunctions.connect(c,function(a){d.edgesData.add(a);d.moving=!0;d.start()})}else alert("The function for connect does not support two arguments (data,callback)."),this.moving=!0,this.start();else this.edgesData.add(c),this.moving=!0,this.start()}},_editNode:function(){if(this.triggerFunctions.edit&&!0==this.editMode){var a=this._getSelectedNode(),a={id:a.id,
label:a.label,group:a.group,shape:a.shape,color:{background:a.color.background,border:a.color.border,highlight:{background:a.color.highlight.background,border:a.color.highlight.border}}};if(2==this.triggerFunctions.edit.length){var b=this;this.triggerFunctions.edit(a,function(a){b.nodesData.update(a);b._createManipulatorBar();b.moving=!0;b.start()})}else alert("The function for edit does not support two arguments (data, callback).")}else alert("No edit function has been bound to this button.")},_deleteSelected:function(){if(!this._selectionIsEmpty()&&
!0==this.editMode)if(this._clusterInSelection())alert("Clusters cannot be deleted.");else{var a=this.getSelectedNodes(),b=this.getSelectedEdges();if(this.triggerFunctions.delete){var c=this,a={nodes:a,edges:b};this.triggerFunctions.delete.length=2;this.triggerFunctions.delete(a,function(a){c.edgesData.remove(a.edges);c.nodesData.remove(a.nodes);this._unselectAll();c.moving=!0;c.start()})}else this.edgesData.remove(b),this.nodesData.remove(a),this._unselectAll(),this.moving=!0,this.start()}}},ja={_putDataInSector:function(){this.sectors.active[this._sector()].nodes=
this.nodes;this.sectors.active[this._sector()].edges=this.edges;this.sectors.active[this._sector()].nodeIndices=this.nodeIndices},_switchToSector:function(a,b){void 0===b||"active"==b?this._switchToActiveSector(a):this._switchToFrozenSector(a)},_switchToActiveSector:function(a){this.nodeIndices=this.sectors.active[a].nodeIndices;this.nodes=this.sectors.active[a].nodes;this.edges=this.sectors.active[a].edges},_switchToSupportSector:function(){this.nodeIndices=this.sectors.support.nodeIndices;this.nodes=
this.sectors.support.nodes;this.edges=this.sectors.support.edges},_switchToFrozenSector:function(a){this.nodeIndices=this.sectors.frozen[a].nodeIndices;this.nodes=this.sectors.frozen[a].nodes;this.edges=this.sectors.frozen[a].edges},_loadLatestSector:function(){this._switchToSector(this._sector())},_sector:function(){return this.activeSector[this.activeSector.length-1]},_previousSector:function(){if(1<this.activeSector.length)return this.activeSector[this.activeSector.length-2];throw new TypeError("there are not enough sectors in the this.activeSector array.");
},_setActiveSector:function(a){this.activeSector.push(a)},_forgetLastSector:function(){this.activeSector.pop()},_createNewSector:function(a){this.sectors.active[a]={nodes:{},edges:{},nodeIndices:[],formationScale:this.scale,drawingNode:void 0};this.sectors.active[a].drawingNode=new p({id:a,color:{background:"#eaefef",border:"495c5e"}},{},{},this.constants);this.sectors.active[a].drawingNode.clusterSize=2},_deleteActiveSector:function(a){delete this.sectors.active[a]},_deleteFrozenSector:function(a){delete this.sectors.frozen[a]},
_freezeSector:function(a){this.sectors.frozen[a]=this.sectors.active[a];this._deleteActiveSector(a)},_activateSector:function(a){this.sectors.active[a]=this.sectors.frozen[a];this._deleteFrozenSector(a)},_mergeThisWithFrozen:function(a){for(var b in this.nodes)this.nodes.hasOwnProperty(b)&&(this.sectors.frozen[a].nodes[b]=this.nodes[b]);for(var c in this.edges)this.edges.hasOwnProperty(c)&&(this.sectors.frozen[a].edges[c]=this.edges[c]);for(b=0;b<this.nodeIndices.length;b++)this.sectors.frozen[a].nodeIndices.push(this.nodeIndices[b])},
_collapseThisToSingleCluster:function(){this.clusterToFit(1,!1)},_addSector:function(a){var b=this._sector();delete this.nodes[a.id];var c=m.randomUUID();this._freezeSector(b);this._createNewSector(c);this._setActiveSector(c);this._switchToSector(this._sector());this.nodes[a.id]=a},_collapseSector:function(){var a=this._sector();if("default"!=a&&(1==this.nodeIndices.length||this.sectors.active[a].drawingNode.width*this.scale<this.constants.clustering.screenSizeThreshold*this.frame.canvas.clientWidth||
this.sectors.active[a].drawingNode.height*this.scale<this.constants.clustering.screenSizeThreshold*this.frame.canvas.clientHeight)){var b=this._previousSector();this._collapseThisToSingleCluster();this._mergeThisWithFrozen(b);this._deleteActiveSector(a);this._activateSector(b);this._switchToSector(b);this._forgetLastSector();this._updateNodeIndexList();this._updateCalculationNodes()}},_doInAllActiveSectors:function(a,b){if(void 0===b)for(var c in this.sectors.active)this.sectors.active.hasOwnProperty(c)&&
(this._switchToActiveSector(c),this[a]());else for(c in this.sectors.active)if(this.sectors.active.hasOwnProperty(c)){this._switchToActiveSector(c);var d=Array.prototype.splice.call(arguments,1);if(1<d.length)this[a](d[0],d[1]);else this[a](b)}this._loadLatestSector()},_doInSupportSector:function(a,b){if(void 0===b)this._switchToSupportSector(),this[a]();else{this._switchToSupportSector();var c=Array.prototype.splice.call(arguments,1);if(1<c.length)this[a](c[0],c[1]);else this[a](b)}this._loadLatestSector()},
_doInAllFrozenSectors:function(a,b){if(void 0===b)for(var c in this.sectors.frozen)this.sectors.frozen.hasOwnProperty(c)&&(this._switchToFrozenSector(c),this[a]());else for(c in this.sectors.frozen)if(this.sectors.frozen.hasOwnProperty(c)){this._switchToFrozenSector(c);var d=Array.prototype.splice.call(arguments,1);if(1<d.length)this[a](d[0],d[1]);else this[a](b)}this._loadLatestSector()},_doInAllSectors:function(a,b){var c=Array.prototype.splice.call(arguments,1);void 0===b?(this._doInAllActiveSectors(a),
this._doInAllFrozenSectors(a)):1<c.length?(this._doInAllActiveSectors(a,c[0],c[1]),this._doInAllFrozenSectors(a,c[0],c[1])):(this._doInAllActiveSectors(a,b),this._doInAllFrozenSectors(a,b))},_clearNodeIndexList:function(){var a=this._sector();this.sectors.active[a].nodeIndices=[];this.nodeIndices=this.sectors.active[a].nodeIndices},_drawSectorNodes:function(a,b){var c=1E9,d=-1E9,e=1E9,f=-1E9,g,h;for(h in this.sectors[b])if(this.sectors[b].hasOwnProperty(h)&&void 0!==this.sectors[b][h].drawingNode){this._switchToSector(h,
b);var c=1E9,d=-1E9,e=1E9,f=-1E9,m;for(m in this.nodes)this.nodes.hasOwnProperty(m)&&(g=this.nodes[m],g.resize(a),e>g.x-0.5*g.width&&(e=g.x-0.5*g.width),f<g.x+0.5*g.width&&(f=g.x+0.5*g.width),c>g.y-0.5*g.height&&(c=g.y-0.5*g.height),d<g.y+0.5*g.height&&(d=g.y+0.5*g.height));g=this.sectors[b][h].drawingNode;g.x=0.5*(f+e);g.y=0.5*(d+c);g.width=2*(g.x-e);g.height=2*(g.y-c);g.radius=Math.sqrt(Math.pow(0.5*g.width,2)+Math.pow(0.5*g.height,2));g.setScale(this.scale);g._drawCircle(a)}},_drawAllSectorNodes:function(a){this._drawSectorNodes(a,
"frozen");this._drawSectorNodes(a,"active");this._loadLatestSector()}},t={startWithClustering:function(){this.clusterToFit(this.constants.clustering.initialMaxNodes,!0);this.updateLabels();this.stabilize&&this._stabilize();this.start()},clusterToFit:function(a,b){for(var c=this.nodeIndices.length,d=0;c>a&&50>d;)0==d%3?(this.forceAggregateHubs(!0),this.normalizeClusterLevels()):this.increaseClusterLevel(),c=this.nodeIndices.length,d+=1;0<d&&!0==b&&this.repositionNodes();this._updateCalculationNodes()},
openCluster:function(a){var b=this.moving;if(a.clusterSize>this.constants.clustering.sectorThreshold&&this._nodeInActiveArea(a)&&!("default"==this._sector()&&1==this.nodeIndices.length)){this._addSector(a);for(a=0;this.nodeIndices.length<this.constants.clustering.initialMaxNodes&&10>a;)this.decreaseClusterLevel(),a+=1}else this._expandClusterNode(a,!1,!0),this._updateNodeIndexList(),this._updateDynamicEdges(),this._updateCalculationNodes(),this.updateLabels();this.moving!=b&&this.start()},updateClustersDefault:function(){!0==
this.constants.clustering.enabled&&this.updateClusters(0,!1,!1)},increaseClusterLevel:function(){this.updateClusters(-1,!1,!0)},decreaseClusterLevel:function(){this.updateClusters(1,!1,!0)},updateClusters:function(a,b,c,d){var e=this.moving,f=this.nodeIndices.length;this.previousScale>this.scale&&0==a&&this._collapseSector();if(this.previousScale>this.scale||-1==a)this._formClusters(c);else if(this.previousScale<this.scale||1==a)!0==c?this._openClusters(b,c):this._openClustersBySize();this._updateNodeIndexList();
if(this.nodeIndices.length==f&&(this.previousScale>this.scale||-1==a))this._aggregateHubs(c),this._updateNodeIndexList();if(this.previousScale>this.scale||-1==a)this.handleChains(),this._updateNodeIndexList();this.previousScale=this.scale;this._updateDynamicEdges();this.updateLabels();this.nodeIndices.length<f&&(this.clusterSession+=1,this.normalizeClusterLevels());(!1==d||void 0===d)&&this.moving!=e&&this.start();this._updateCalculationNodes()},handleChains:function(){var a=this._getChainFraction();
a>this.constants.clustering.chainThreshold&&this._reduceAmountOfChains(1-this.constants.clustering.chainThreshold/a)},_aggregateHubs:function(a){this._getHubSize();this._formClustersByHub(a,!1)},forceAggregateHubs:function(a){var b=this.moving,c=this.nodeIndices.length;this._aggregateHubs(!0);this._updateNodeIndexList();this._updateDynamicEdges();this.updateLabels();this.nodeIndices.length!=c&&(this.clusterSession+=1);(!1==a||void 0===a)&&this.moving!=b&&this.start()},_openClustersBySize:function(){for(var a in this.nodes)if(this.nodes.hasOwnProperty(a)){var b=
this.nodes[a];!0==b.inView()&&(b.width*this.scale>this.constants.clustering.screenSizeThreshold*this.frame.canvas.clientWidth||b.height*this.scale>this.constants.clustering.screenSizeThreshold*this.frame.canvas.clientHeight)&&this.openCluster(b)}},_openClusters:function(a,b){for(var c=0;c<this.nodeIndices.length;c++)this._expandClusterNode(this.nodes[this.nodeIndices[c]],a,b),this._updateCalculationNodes()},_expandClusterNode:function(a,b,c,d){if(1<a.clusterSize&&(a.clusterSize<this.constants.clustering.sectorThreshold&&
(d=!0),b=d?!0:b,a.formationScale<this.scale||!0==c))for(var e in a.containedNodes)if(a.containedNodes.hasOwnProperty(e)){var f=a.containedNodes[e];!0==c?(f.clusterSession==a.clusterSessions[a.clusterSessions.length-1]||d)&&this._expelChildFromParent(a,e,b,c,d):this._nodeInActiveArea(a)&&this._expelChildFromParent(a,e,b,c,d)}},_expelChildFromParent:function(a,b,c,d,e){var f=a.containedNodes[b];if(f.formationScale<this.scale||!0==d){this._unselectAll();this.nodes[b]=f;this._releaseContainedEdges(a,
f);this._connectEdgeBackToChild(a,f);this._validateEdges(a);a.mass-=f.mass;a.clusterSize-=f.clusterSize;a.fontSize=Math.min(this.constants.clustering.maxFontSize,this.constants.nodes.fontSize+this.constants.clustering.fontSizeMultiplier*a.clusterSize);a.dynamicEdgesLength=a.dynamicEdges.length;f.x=a.x+a.growthIndicator*(0.5-Math.random());f.y=a.y+a.growthIndicator*(0.5-Math.random());delete a.containedNodes[b];b=!1;for(var g in a.containedNodes)if(a.containedNodes.hasOwnProperty(g)&&a.containedNodes[g].clusterSession==
f.clusterSession){b=!0;break}!1==b&&a.clusterSessions.pop();this._repositionBezierNodes(f);f.clusterSession=0;a.clearSizeCache();this.moving=!0}!0==c&&this._expandClusterNode(f,c,d,e)},_repositionBezierNodes:function(a){for(var b=0;b<a.dynamicEdges.length;b++)a.dynamicEdges[b].positionBezierNode()},_formClusters:function(a){!1==a?this._formClustersByZoom():this._forceClustersByZoom()},_formClustersByZoom:function(){var a,b,c=this.constants.clustering.clusterEdgeThreshold/this.scale,d;for(d in this.edges)if(this.edges.hasOwnProperty(d)){var e=
this.edges[d];e.connected&&e.toId!=e.fromId&&(a=e.to.x-e.from.x,b=e.to.y-e.from.y,a=Math.sqrt(a*a+b*b),a<c&&(a=e.from,b=e.to,e.to.mass>e.from.mass&&(a=e.to,b=e.from),1==b.dynamicEdgesLength?this._addToCluster(a,b,!1):1==a.dynamicEdgesLength&&this._addToCluster(b,a,!1)))}},_forceClustersByZoom:function(){for(var a in this.nodes)if(this.nodes.hasOwnProperty(a)){var b=this.nodes[a];if(1==b.dynamicEdgesLength&&0!=b.dynamicEdges.length){var c=b.dynamicEdges[0],c=c.toId==b.id?this.nodes[c.fromId]:this.nodes[c.toId];
b.id!=c.id&&(c.mass>b.mass?this._addToCluster(c,b,!0):this._addToCluster(b,c,!0))}}},_clusterToSmallestNeighbour:function(a){for(var b=-1,c=0;c<a.dynamicEdges.length;c++)if(void 0!==a.dynamicEdges[c]){var d=null;a.dynamicEdges[c].fromId!=a.id?d=a.dynamicEdges[c].from:a.dynamicEdges[c].toId!=a.id&&(d=a.dynamicEdges[c].to);null!=d&&b>d.clusterSessions.length&&(b=d.clusterSessions.length)}null!=d&&void 0!==this.nodes[d.id]&&this._addToCluster(d,a,!0)},_formClustersByHub:function(a,b){for(var c in this.nodes)this.nodes.hasOwnProperty(c)&&
this._formClusterFromHub(this.nodes[c],a,b)},_formClusterFromHub:function(a,b,c,d){void 0===d&&(d=0);if(a.dynamicEdgesLength>=this.hubThreshold&&!1==c||a.dynamicEdgesLength==this.hubThreshold&&!0==c){var e,f,g=this.constants.clustering.clusterEdgeThreshold/this.scale,h=!1;c=[];for(var m=a.dynamicEdges.length,p=0;p<m;p++)c.push(a.dynamicEdges[p].id);if(!1==b){h=!1;for(p=0;p<m;p++)if(f=this.edges[c[p]],void 0!==f&&(f.connected&&f.toId!=f.fromId)&&(e=f.to.x-f.from.x,f=f.to.y-f.from.y,e=Math.sqrt(e*e+
f*f),e<g)){h=!0;break}}if(!b&&h||b)for(p=0;p<m;p++)f=this.edges[c[p]],void 0!==f&&(g=this.nodes[f.fromId==a.id?f.toId:f.fromId],g.dynamicEdges.length<=this.hubThreshold+d&&g.id!=a.id&&this._addToCluster(a,g,b))}},_addToCluster:function(a,b,c){a.containedNodes[b.id]=b;for(var d=0;d<b.dynamicEdges.length;d++){var e=b.dynamicEdges[d];e.toId==a.id||e.fromId==a.id?this._addToContainedEdges(a,b,e):this._connectEdgeToCluster(a,b,e)}b.dynamicEdges=[];this._containCircularEdgesFromNode(a,b);delete this.nodes[b.id];
d=a.mass;b.clusterSession=this.clusterSession;a.mass+=b.mass;a.clusterSize+=b.clusterSize;a.fontSize=Math.min(this.constants.clustering.maxFontSize,this.constants.nodes.fontSize+this.constants.clustering.fontSizeMultiplier*a.clusterSize);a.clusterSessions[a.clusterSessions.length-1]!=this.clusterSession&&a.clusterSessions.push(this.clusterSession);a.formationScale=!0==c?0:this.scale;a.clearSizeCache();a.containedNodes[b.id].formationScale=a.formationScale;b.clearVelocity();a.updateVelocity(d);this.moving=
!0},_updateDynamicEdges:function(){for(var a=0;a<this.nodeIndices.length;a++){var b=this.nodes[this.nodeIndices[a]];b.dynamicEdgesLength=b.dynamicEdges.length;var c=0;if(1<b.dynamicEdgesLength)for(var d=0;d<b.dynamicEdgesLength-1;d++)for(var e=b.dynamicEdges[d].toId,f=b.dynamicEdges[d].fromId,g=d+1;g<b.dynamicEdgesLength;g++)if(b.dynamicEdges[g].toId==e&&b.dynamicEdges[g].fromId==f||b.dynamicEdges[g].fromId==e&&b.dynamicEdges[g].toId==f)c+=1;b.dynamicEdgesLength-=c}},_addToContainedEdges:function(a,
b,c){a.containedEdges.hasOwnProperty(b.id)||(a.containedEdges[b.id]=[]);a.containedEdges[b.id].push(c);delete this.edges[c.id];for(b=0;b<a.dynamicEdges.length;b++)if(a.dynamicEdges[b].id==c.id){a.dynamicEdges.splice(b,1);break}},_connectEdgeToCluster:function(a,b,c){c.toId==c.fromId?this._addToContainedEdges(a,b,c):(c.toId==b.id?(c.originalToId.push(b.id),c.to=a,c.toId=a.id):(c.originalFromId.push(b.id),c.from=a,c.fromId=a.id),this._addToReroutedEdges(a,b,c))},_containCircularEdgesFromNode:function(a,
b){for(var c=0;c<a.dynamicEdges.length;c++){var d=a.dynamicEdges[c];d.toId==d.fromId&&this._addToContainedEdges(a,b,d)}},_addToReroutedEdges:function(a,b,c){a.reroutedEdges.hasOwnProperty(b.id)||(a.reroutedEdges[b.id]=[]);a.reroutedEdges[b.id].push(c);a.dynamicEdges.push(c)},_connectEdgeBackToChild:function(a,b){if(a.reroutedEdges.hasOwnProperty(b.id)){for(var c=0;c<a.reroutedEdges[b.id].length;c++){var d=a.reroutedEdges[b.id][c];d.originalFromId[d.originalFromId.length-1]==b.id?(d.originalFromId.pop(),
d.fromId=b.id,d.from=b):(d.originalToId.pop(),d.toId=b.id,d.to=b);b.dynamicEdges.push(d);for(var e=0;e<a.dynamicEdges.length;e++)if(a.dynamicEdges[e].id==d.id){a.dynamicEdges.splice(e,1);break}}delete a.reroutedEdges[b.id]}},_validateEdges:function(a){for(var b=0;b<a.dynamicEdges.length;b++){var c=a.dynamicEdges[b];a.id!=c.toId&&a.id!=c.fromId&&a.dynamicEdges.splice(b,1)}},_releaseContainedEdges:function(a,b){for(var c=0;c<a.containedEdges[b.id].length;c++){var d=a.containedEdges[b.id][c];this.edges[d.id]=
d;b.dynamicEdges.push(d);a.dynamicEdges.push(d)}delete a.containedEdges[b.id]},updateLabels:function(){for(var a in this.nodes)if(this.nodes.hasOwnProperty(a)){var b=this.nodes[a];1<b.clusterSize&&(b.label="[".concat(String(b.clusterSize),"]"))}for(a in this.nodes)this.nodes.hasOwnProperty(a)&&(b=this.nodes[a],1==b.clusterSize&&(b.label=void 0!==b.originalLabel?b.originalLabel:String(b.id)))},normalizeClusterLevels:function(){var a=0,b=1E9,c=0,d;for(d in this.nodes)this.nodes.hasOwnProperty(d)&&(c=
this.nodes[d].clusterSessions.length,a<c&&(a=c),b>c&&(b=c));if(a-b>this.constants.clustering.clusterLevelDifference){b=this.nodeIndices.length;a-=this.constants.clustering.clusterLevelDifference;for(d in this.nodes)this.nodes.hasOwnProperty(d)&&this.nodes[d].clusterSessions.length<a&&this._clusterToSmallestNeighbour(this.nodes[d]);this._updateNodeIndexList();this._updateDynamicEdges();this.nodeIndices.length!=b&&(this.clusterSession+=1)}},_nodeInActiveArea:function(a){return Math.abs(a.x-this.areaCenter.x)<=
this.constants.clustering.activeAreaBoxSize/this.scale&&Math.abs(a.y-this.areaCenter.y)<=this.constants.clustering.activeAreaBoxSize/this.scale},repositionNodes:function(){for(var a=0;a<this.nodeIndices.length;a++){var b=this.nodes[this.nodeIndices[a]];if((!1==b.xFixed||!1==b.yFixed)&&!0!=this.createNodeOnClick){var c=this.constants.physics.springLength*Math.min(100,b.mass),d=2*Math.PI*Math.random();!1==b.xFixed&&(b.x=c*Math.cos(d));!1==b.yFixed&&(b.y=c*Math.sin(d));this._repositionBezierNodes(b)}}},
_getHubSize:function(){for(var a=0,b=0,c=0,d=0,e=0;e<this.nodeIndices.length;e++){var f=this.nodes[this.nodeIndices[e]];f.dynamicEdgesLength>d&&(d=f.dynamicEdgesLength);a+=f.dynamicEdgesLength;b+=Math.pow(f.dynamicEdgesLength,2);c+=1}a/=c;b=b/c-Math.pow(a,2);b=Math.sqrt(b);this.hubThreshold=Math.floor(a+2*b);this.hubThreshold>d&&(this.hubThreshold=d)},_reduceAmountOfChains:function(a){this.hubThreshold=2;a=Math.floor(this.nodeIndices.length*a);for(var b in this.nodes)this.nodes.hasOwnProperty(b)&&
(2==this.nodes[b].dynamicEdgesLength&&2<=this.nodes[b].dynamicEdges.length&&0<a)&&(this._formClusterFromHub(this.nodes[b],!0,!0,1),a-=1)},_getChainFraction:function(){var a=0,b=0,c;for(c in this.nodes)this.nodes.hasOwnProperty(c)&&(2==this.nodes[c].dynamicEdgesLength&&2<=this.nodes[c].dynamicEdges.length&&(a+=1),b+=1);return a/b}},ga={_getNodesOverlappingWith:function(a,b){var c=this.nodes,d;for(d in c)c.hasOwnProperty(d)&&c[d].isOverlappingWith(a)&&b.push(d)},_getAllNodesOverlappingWith:function(a){var b=
[];this._doInAllActiveSectors("_getNodesOverlappingWith",a,b);return b},_pointerToPositionObject:function(a){var b=this._canvasToX(a.x);a=this._canvasToY(a.y);return{left:b,top:a,right:b,bottom:a}},_getNodeAt:function(a){a=this._pointerToPositionObject(a);a=this._getAllNodesOverlappingWith(a);return 0<a.length?this.nodes[a[a.length-1]]:null},_getEdgesOverlappingWith:function(a,b){var c=this.edges,d;for(d in c)c.hasOwnProperty(d)&&c[d].isOverlappingWith(a)&&b.push(d)},_getAllEdgesOverlappingWith:function(a){var b=
[];this._doInAllActiveSectors("_getEdgesOverlappingWith",a,b);return b},_getEdgeAt:function(a){a=this._pointerToPositionObject(a);a=this._getAllEdgesOverlappingWith(a);return 0<a.length?this.edges[a[a.length-1]]:null},_addToSelection:function(a){this.selectionObj[a.id]=a},_removeFromSelection:function(a){delete this.selectionObj[a.id]},_unselectAll:function(a){void 0===a&&(a=!1);for(var b in this.selectionObj)this.selectionObj.hasOwnProperty(b)&&this.selectionObj[b].unselect();this.selectionObj={};
!1==a&&this.emit("select",this.getSelection())},_unselectClusters:function(a){void 0===a&&(a=!1);for(var b in this.selectionObj)this.selectionObj.hasOwnProperty(b)&&(this.selectionObj[b]instanceof p&&1<this.selectionObj[b].clusterSize)&&(this.selectionObj[b].unselect(),this._removeFromSelection(this.selectionObj[b]));!1==a&&this.emit("select",this.getSelection())},_getSelectedNodeCount:function(){var a=0,b;for(b in this.selectionObj)this.selectionObj.hasOwnProperty(b)&&this.selectionObj[b]instanceof
p&&(a+=1);return a},_getSelectedNode:function(){for(var a in this.selectionObj)if(this.selectionObj.hasOwnProperty(a)&&this.selectionObj[a]instanceof p)return this.selectionObj[a];return null},_getSelectedEdgeCount:function(){var a=0,b;for(b in this.selectionObj)this.selectionObj.hasOwnProperty(b)&&this.selectionObj[b]instanceof z&&(a+=1);return a},_getSelectedObjectCount:function(){var a=0,b;for(b in this.selectionObj)this.selectionObj.hasOwnProperty(b)&&(a+=1);return a},_selectionIsEmpty:function(){for(var a in this.selectionObj)if(this.selectionObj.hasOwnProperty(a))return!1;
return!0},_clusterInSelection:function(){for(var a in this.selectionObj)if(this.selectionObj.hasOwnProperty(a)&&this.selectionObj[a]instanceof p&&1<this.selectionObj[a].clusterSize)return!0;return!1},_selectConnectedEdges:function(a){for(var b=0;b<a.dynamicEdges.length;b++){var c=a.dynamicEdges[b];c.select();this._addToSelection(c)}},_unselectConnectedEdges:function(a){for(var b=0;b<a.dynamicEdges.length;b++){var c=a.dynamicEdges[b];c.unselect();this._removeFromSelection(c)}},_selectObject:function(a,
b,c){void 0===c&&(c=!1);!1==this._selectionIsEmpty()&&(!1==b&&!1==this.forceAppendSelection)&&this._unselectAll(!0);!1==a.selected?(a.select(),this._addToSelection(a),a instanceof p&&!1==this.blockConnectingEdgeSelection&&this._selectConnectedEdges(a)):(a.unselect(),this._removeFromSelection(a));!1==c&&this.emit("select",this.getSelection())},_handleTouch:function(a){},_handleTap:function(a){var b=this._getNodeAt(a);null!=b?this._selectObject(b,!1):(a=this._getEdgeAt(a),null!=a?this._selectObject(a,
!1):this._unselectAll());this.emit("click",this.getSelection());this._redraw()},_handleDoubleTap:function(a){var b=this._getNodeAt(a);null!=b&&void 0!==b&&(this.areaCenter={x:this._canvasToX(a.x),y:this._canvasToY(a.y)},this.openCluster(b));this.emit("doubleClick",this.getSelection())},_handleOnHold:function(a){var b=this._getNodeAt(a);null!=b?this._selectObject(b,!0):(a=this._getEdgeAt(a),null!=a&&this._selectObject(a,!0));this._redraw()},_handleOnRelease:function(a){},getSelection:function(){var a=
this.getSelectedNodes(),b=this.getSelectedEdges();return{nodes:a,edges:b}},getSelectedNodes:function(){var a=[],b;for(b in this.selectionObj)this.selectionObj.hasOwnProperty(b)&&this.selectionObj[b]instanceof p&&a.push(b);return a},getSelectedEdges:function(){var a=[],b;for(b in this.selectionObj)this.selectionObj.hasOwnProperty(b)&&this.selectionObj[b]instanceof z&&a.push(b);return a},setSelection:function(a){var b,c,d;if(!a||void 0==a.length)throw"Selection must be an array with ids";this._unselectAll(!0);
b=0;for(c=a.length;b<c;b++){d=a[b];var e=this.nodes[d];if(!e)throw new RangeError('Node with id "'+d+'" not found');this._selectObject(e,!0,!0)}this.redraw()},_updateSelection:function(){for(var a in this.selectionObj)this.selectionObj.hasOwnProperty(a)&&(this.selectionObj[a]instanceof p?this.nodes.hasOwnProperty(a)||delete this.selectionObj[a]:this.edges.hasOwnProperty(a)||delete this.selectionObj[a])}},W={_cleanNavigation:function(){var a=document.getElementById("graph-navigation_wrapper");null!=
a&&this.containerElement.removeChild(a);document.onmouseup=null},_loadNavigationElements:function(){this._cleanNavigation();this.navigationDivs={};var a="up down left right zoomIn zoomOut zoomExtends".split(" "),b="_moveUp _moveDown _moveLeft _moveRight _zoomIn _zoomOut zoomExtent".split(" ");this.navigationDivs.wrapper=document.createElement("div");this.navigationDivs.wrapper.id="graph-navigation_wrapper";this.navigationDivs.wrapper.style.position="absolute";this.navigationDivs.wrapper.style.width=
this.frame.canvas.clientWidth+"px";this.navigationDivs.wrapper.style.height=this.frame.canvas.clientHeight+"px";this.containerElement.insertBefore(this.navigationDivs.wrapper,this.frame);for(var c=0;c<a.length;c++)this.navigationDivs[a[c]]=document.createElement("div"),this.navigationDivs[a[c]].id="graph-navigation_"+a[c],this.navigationDivs[a[c]].className="graph-navigation "+a[c],this.navigationDivs.wrapper.appendChild(this.navigationDivs[a[c]]),this.navigationDivs[a[c]].onmousedown=this[b[c]].bind(this);
document.onmouseup=this._stopMovement.bind(this)},_stopMovement:function(){this._xStopMoving();this._yStopMoving();this._stopZoom()},_preventDefault:function(a){void 0!==a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},_moveUp:function(a){this.yIncrement=this.constants.keyboard.speed.y;this.start();this._preventDefault(a)},_moveDown:function(a){this.yIncrement=-this.constants.keyboard.speed.y;this.start();this._preventDefault(a)},_moveLeft:function(a){this.xIncrement=this.constants.keyboard.speed.x;
this.start();this._preventDefault(a)},_moveRight:function(a){this.xIncrement=-this.constants.keyboard.speed.y;this.start();this._preventDefault(a)},_zoomIn:function(a){this.zoomIncrement=this.constants.keyboard.speed.zoom;this.start();this._preventDefault(a)},_zoomOut:function(){this.zoomIncrement=-this.constants.keyboard.speed.zoom;this.start();this._preventDefault(event)},_stopZoom:function(){this.zoomIncrement=0},_yStopMoving:function(){this.yIncrement=0},_xStopMoving:function(){this.xIncrement=
0}},H={_loadMixin:function(a){for(var b in a)a.hasOwnProperty(b)&&(r.prototype[b]=a[b])},_clearMixin:function(a){for(var b in a)a.hasOwnProperty(b)&&(r.prototype[b]=void 0)},_loadPhysicsSystem:function(){this._loadMixin(ea);this._loadSelectedForceSolver();!0==this.constants.configurePhysics&&this._loadPhysicsConfiguration()},_loadClusterSystem:function(){this.clusterSession=0;this.hubThreshold=5;this._loadMixin(t)},_loadSectorSystem:function(){this.sectors={};this.activeSector=["default"];this.sectors.active=
{};this.sectors.active["default"]={nodes:{},edges:{},nodeIndices:[],formationScale:1,drawingNode:void 0};this.sectors.frozen={};this.sectors.support={nodes:{},edges:{},nodeIndices:[],formationScale:1,drawingNode:void 0};this.nodeIndices=this.sectors.active["default"].nodeIndices;this._loadMixin(ja)},_loadSelectionSystem:function(){this.selectionObj={};this._loadMixin(ga)},_loadManipulationSystem:function(){this.forceAppendSelection=this.blockConnectingEdgeSelection=!1;!0==this.constants.dataManipulation.enabled?
(void 0===this.manipulationDiv&&(this.manipulationDiv=document.createElement("div"),this.manipulationDiv.className="graph-manipulationDiv",this.manipulationDiv.id="graph-manipulationDiv",this.manipulationDiv.style.display=!0==this.editMode?"block":"none",this.containerElement.insertBefore(this.manipulationDiv,this.frame)),void 0===this.editModeDiv&&(this.editModeDiv=document.createElement("div"),this.editModeDiv.className="graph-manipulation-editMode",this.editModeDiv.id="graph-manipulation-editMode",
this.editModeDiv.style.display=!0==this.editMode?"none":"block",this.containerElement.insertBefore(this.editModeDiv,this.frame)),void 0===this.closeDiv&&(this.closeDiv=document.createElement("div"),this.closeDiv.className="graph-manipulation-closeDiv",this.closeDiv.id="graph-manipulation-closeDiv",this.closeDiv.style.display=this.manipulationDiv.style.display,this.containerElement.insertBefore(this.closeDiv,this.frame)),this._loadMixin(fa),this._createManipulatorBar()):void 0!==this.manipulationDiv&&
(this._createManipulatorBar(),this.containerElement.removeChild(this.manipulationDiv),this.containerElement.removeChild(this.editModeDiv),this.containerElement.removeChild(this.closeDiv),this.closeDiv=this.editModeDiv=this.manipulationDiv=void 0,this._clearMixin(fa))},_loadNavigationControls:function(){this._loadMixin(W);this._cleanNavigation();!0==this.constants.navigation.enabled&&this._loadNavigationElements()},_loadHierarchySystem:function(){this._loadMixin(na)}};aa(r.prototype);r.prototype._getScriptPath=
function(){for(var a=document.getElementsByTagName("script"),b=0;b<a.length;b++){var c=a[b].src,d=c&&/\/?vis(.min)?\.js$/.exec(c);if(d)return c.substring(0,c.length-d[0].length)}return null};r.prototype._getRange=function(){var a=1E9,b=-1E9,c=1E9,d=-1E9,e,f;for(f in this.nodes)this.nodes.hasOwnProperty(f)&&(e=this.nodes[f],c>e.x&&(c=e.x),d<e.x&&(d=e.x),a>e.y&&(a=e.y),b<e.y&&(b=e.y));return{minX:c,maxX:d,minY:a,maxY:b}};r.prototype._findCenter=function(a){return{x:0.5*(a.maxX+a.minX),y:0.5*(a.maxY+
a.minY)}};r.prototype._centerGraph=function(a){a=this._findCenter(a);a.x*=this.scale;a.y*=this.scale;a.x-=0.5*this.frame.canvas.clientWidth;a.y-=0.5*this.frame.canvas.clientHeight;this._setTranslation(-a.x,-a.y)};r.prototype.zoomExtent=function(a,b){void 0===a&&(a=!1);void 0===b&&(b=!1);var c=this._getRange(),d;if(!0==a){d=this.nodeIndices.length;d=!0==this.constants.smoothCurves?!0==this.constants.clustering.enabled&&d>=this.constants.clustering.initialMaxNodes?49.07548/(d+142.05338)+9.1444E-4:12.662/
(d+7.4147)+0.0964822:!0==this.constants.clustering.enabled&&d>=this.constants.clustering.initialMaxNodes?77.5271985/(d+187.266146)+4.76710517E-5:30.5062972/(d+19.93597763)+0.08413486;var e=Math.min(this.frame.canvas.clientWidth/600,this.frame.canvas.clientHeight/600);d*=e}else e=1.1*(Math.abs(c.minX)+Math.abs(c.maxX)),d=1.1*(Math.abs(c.minY)+Math.abs(c.maxY)),e=this.frame.canvas.clientWidth/e,d=this.frame.canvas.clientHeight/d,d=e<=d?e:d;1<d&&(d=1);this._setScale(d);this._centerGraph(c);!1==b&&(this.moving=
!0,this.start())};r.prototype._updateNodeIndexList=function(){this._clearNodeIndexList();for(var a in this.nodes)this.nodes.hasOwnProperty(a)&&this.nodeIndices.push(a)};r.prototype.setData=function(a,b){void 0===b&&(b=!1);if(a&&a.dot&&(a.nodes||a.edges))throw new SyntaxError('Data must contain either parameter "dot" or  parameter pair "nodes" and "edges", but not both.');this.setOptions(a&&a.options);if(a&&a.dot){if(a&&a.dot){var c=M.util.DOTToGraph(a.dot);this.setData(c);return}}else this._setNodes(a&&
a.nodes),this._setEdges(a&&a.edges);this._putDataInSector();b||(this.stabilize&&this._stabilize(),this.start())};r.prototype.setOptions=function(a){if(a){var b;void 0!==a.width&&(this.width=a.width);void 0!==a.height&&(this.height=a.height);void 0!==a.stabilize&&(this.stabilize=a.stabilize);void 0!==a.selectable&&(this.selectable=a.selectable);void 0!==a.smoothCurves&&(this.constants.smoothCurves=a.smoothCurves);void 0!==a.configurePhysics&&(this.constants.configurePhysics=a.configurePhysics);void 0!==
a.stabilizationIterations&&(this.constants.stabilizationIterations=a.stabilizationIterations);a.onAdd&&(this.triggerFunctions.add=a.onAdd);a.onEdit&&(this.triggerFunctions.edit=a.onEdit);a.onConnect&&(this.triggerFunctions.connect=a.onConnect);a.onDelete&&(this.triggerFunctions.delete=a.onDelete);if(a.physics){if(a.physics.barnesHut)for(b in this.constants.physics.barnesHut.enabled=!0,a.physics.barnesHut)a.physics.barnesHut.hasOwnProperty(b)&&(this.constants.physics.barnesHut[b]=a.physics.barnesHut[b]);
if(a.physics.repulsion)for(b in this.constants.physics.barnesHut.enabled=!1,a.physics.repulsion)a.physics.repulsion.hasOwnProperty(b)&&(this.constants.physics.repulsion[b]=a.physics.repulsion[b])}if(a.hierarchicalLayout)for(b in this.constants.hierarchicalLayout.enabled=!0,a.hierarchicalLayout)a.hierarchicalLayout.hasOwnProperty(b)&&(this.constants.hierarchicalLayout[b]=a.hierarchicalLayout[b]);else void 0!==a.hierarchicalLayout&&(this.constants.hierarchicalLayout.enabled=!1);if(a.clustering)for(b in this.constants.clustering.enabled=
!0,a.clustering)a.clustering.hasOwnProperty(b)&&(this.constants.clustering[b]=a.clustering[b]);else void 0!==a.clustering&&(this.constants.clustering.enabled=!1);if(a.navigation)for(b in this.constants.navigation.enabled=!0,a.navigation)a.navigation.hasOwnProperty(b)&&(this.constants.navigation[b]=a.navigation[b]);else void 0!==a.navigation&&(this.constants.navigation.enabled=!1);if(a.keyboard)for(b in this.constants.keyboard.enabled=!0,a.keyboard)a.keyboard.hasOwnProperty(b)&&(this.constants.keyboard[b]=
a.keyboard[b]);else void 0!==a.keyboard&&(this.constants.keyboard.enabled=!1);if(a.dataManipulation)for(b in this.constants.dataManipulation.enabled=!0,a.dataManipulation)a.dataManipulation.hasOwnProperty(b)&&(this.constants.dataManipulation[b]=a.dataManipulation[b]);else void 0!==a.dataManipulation&&(this.constants.dataManipulation.enabled=!1);if(a.edges){for(b in a.edges)a.edges.hasOwnProperty(b)&&(this.constants.edges[b]=a.edges[b]);a.edges.fontColor||(this.constants.edges.fontColor=a.edges.color);
a.edges.dash&&(void 0!==a.edges.dash.length&&(this.constants.edges.dash.length=a.edges.dash.length),void 0!==a.edges.dash.gap&&(this.constants.edges.dash.gap=a.edges.dash.gap),void 0!==a.edges.dash.altLength&&(this.constants.edges.dash.altLength=a.edges.dash.altLength))}if(a.nodes){for(b in a.nodes)a.nodes.hasOwnProperty(b)&&(this.constants.nodes[b]=a.nodes[b]);a.nodes.color&&(this.constants.nodes.color=p.parseColor(a.nodes.color))}if(a.groups)for(var c in a.groups)a.groups.hasOwnProperty(c)&&this.groups.add(c,
a.groups[c])}this._loadPhysicsSystem();this._loadNavigationControls();this._loadManipulationSystem();this._configureSmoothCurves();this._createKeyBinds();this.setSize(this.width,this.height);this._setTranslation(this.frame.clientWidth/2,this.frame.clientHeight/2);this._setScale(1);this._redraw()};r.prototype._create=function(){for(;this.containerElement.hasChildNodes();)this.containerElement.removeChild(this.containerElement.firstChild);this.frame=document.createElement("div");this.frame.className=
"graph-frame";this.frame.style.position="relative";this.frame.style.overflow="hidden";this.frame.style.zIndex="1";this.frame.canvas=document.createElement("canvas");this.frame.canvas.style.position="relative";this.frame.appendChild(this.frame.canvas);if(!this.frame.canvas.getContext){var a=document.createElement("DIV");a.style.color="red";a.style.fontWeight="bold";a.style.padding="10px";a.innerHTML="Error: your browser does not support HTML canvas";this.frame.canvas.appendChild(a)}this.drag={};this.pinch=
{};this.hammer=T(this.frame.canvas,{prevent_default:!0});this.hammer.on("tap",this._onTap.bind(this));this.hammer.on("doubletap",this._onDoubleTap.bind(this));this.hammer.on("hold",this._onHold.bind(this));this.hammer.on("pinch",this._onPinch.bind(this));this.hammer.on("touch",this._onTouch.bind(this));this.hammer.on("dragstart",this._onDragStart.bind(this));this.hammer.on("drag",this._onDrag.bind(this));this.hammer.on("dragend",this._onDragEnd.bind(this));this.hammer.on("release",this._onRelease.bind(this));
this.hammer.on("mousewheel",this._onMouseWheel.bind(this));this.hammer.on("DOMMouseScroll",this._onMouseWheel.bind(this));this.hammer.on("mousemove",this._onMouseMoveTitle.bind(this));this.containerElement.appendChild(this.frame)};r.prototype._createKeyBinds=function(){this.mousetrap=ha;this.mousetrap.reset();!0==this.constants.keyboard.enabled&&(this.mousetrap.bind("up",this._moveUp.bind(this),"keydown"),this.mousetrap.bind("up",this._yStopMoving.bind(this),"keyup"),this.mousetrap.bind("down",this._moveDown.bind(this),
"keydown"),this.mousetrap.bind("down",this._yStopMoving.bind(this),"keyup"),this.mousetrap.bind("left",this._moveLeft.bind(this),"keydown"),this.mousetrap.bind("left",this._xStopMoving.bind(this),"keyup"),this.mousetrap.bind("right",this._moveRight.bind(this),"keydown"),this.mousetrap.bind("right",this._xStopMoving.bind(this),"keyup"),this.mousetrap.bind("=",this._zoomIn.bind(this),"keydown"),this.mousetrap.bind("=",this._stopZoom.bind(this),"keyup"),this.mousetrap.bind("-",this._zoomOut.bind(this),
"keydown"),this.mousetrap.bind("-",this._stopZoom.bind(this),"keyup"),this.mousetrap.bind("[",this._zoomIn.bind(this),"keydown"),this.mousetrap.bind("[",this._stopZoom.bind(this),"keyup"),this.mousetrap.bind("]",this._zoomOut.bind(this),"keydown"),this.mousetrap.bind("]",this._stopZoom.bind(this),"keyup"),this.mousetrap.bind("pageup",this._zoomIn.bind(this),"keydown"),this.mousetrap.bind("pageup",this._stopZoom.bind(this),"keyup"),this.mousetrap.bind("pagedown",this._zoomOut.bind(this),"keydown"),
this.mousetrap.bind("pagedown",this._stopZoom.bind(this),"keyup"));!0==this.constants.dataManipulation.enabled&&(this.mousetrap.bind("escape",this._createManipulatorBar.bind(this)),this.mousetrap.bind("del",this._deleteSelected.bind(this)))};r.prototype._getPointer=function(a){return{x:a.pageX-M.util.getAbsoluteLeft(this.frame.canvas),y:a.pageY-M.util.getAbsoluteTop(this.frame.canvas)}};r.prototype._onTouch=function(a){this.drag.pointer=this._getPointer(a.gesture.center);this.drag.pinched=!1;this.pinch.scale=
this._getScale();this._handleTouch(this.drag.pointer)};r.prototype._onDragStart=function(){this._handleDragStart()};r.prototype._handleDragStart=function(){var a=this.drag,b=this._getNodeAt(a.pointer);a.dragging=!0;a.selection=[];a.translation=this._getTranslation();a.nodeId=null;if(null!=b){a.nodeId=b.id;b.isSelected()||this._selectObject(b,!1);for(var c in this.selectionObj)if(this.selectionObj.hasOwnProperty(c)&&(b=this.selectionObj[c],b instanceof p)){var d={id:b.id,node:b,x:b.x,y:b.y,xFixed:b.xFixed,
yFixed:b.yFixed};b.xFixed=!0;b.yFixed=!0;a.selection.push(d)}}};r.prototype._onDrag=function(a){this._handleOnDrag(a)};r.prototype._handleOnDrag=function(a){if(!this.drag.pinched){a=this._getPointer(a.gesture.center);var b=this,c=this.drag,d=c.selection;if(d&&d.length){var e=a.x-c.pointer.x,f=a.y-c.pointer.y;d.forEach(function(a){var c=a.node;a.xFixed||(c.x=b._canvasToX(b._xToCanvas(a.x)+e));a.yFixed||(c.y=b._canvasToY(b._yToCanvas(a.y)+f))});this.moving||(this.moving=!0,this.start())}else this._setTranslation(this.drag.translation.x+
(a.x-this.drag.pointer.x),this.drag.translation.y+(a.y-this.drag.pointer.y)),this._redraw(),this.moved=!0}};r.prototype._onDragEnd=function(){this.drag.dragging=!1;var a=this.drag.selection;a&&a.forEach(function(a){a.node.xFixed=a.xFixed;a.node.yFixed=a.yFixed})};r.prototype._onTap=function(a){this.pointerPosition=a=this._getPointer(a.gesture.center);this._handleTap(a)};r.prototype._onDoubleTap=function(a){a=this._getPointer(a.gesture.center);this._handleDoubleTap(a)};r.prototype._onHold=function(a){this.pointerPosition=
a=this._getPointer(a.gesture.center);this._handleOnHold(a)};r.prototype._onRelease=function(a){a=this._getPointer(a.gesture.center);this._handleOnRelease(a)};r.prototype._onPinch=function(a){var b=this._getPointer(a.gesture.center);this.drag.pinched=!0;"scale"in this.pinch||(this.pinch.scale=1);this._zoom(this.pinch.scale*a.gesture.scale,b)};r.prototype._zoom=function(a,b){var c=this._getScale();1E-5>a&&(a=1E-5);10<a&&(a=10);var d=this._getTranslation(),e=a/c,c=(1-e)*b.x+d.x*e,d=(1-e)*b.y+d.y*e;this.areaCenter=
{x:this._canvasToX(b.x),y:this._canvasToY(b.y)};this._setScale(a);this._setTranslation(c,d);this.updateClustersDefault();this._redraw();return a};r.prototype._onMouseWheel=function(a){var b=0;a.wheelDelta?b=a.wheelDelta/120:a.detail&&(b=-a.detail/3);if(b){var c=this._getScale(),d=b/10;0>b&&(d/=1-d);c*=1+d;b=m.fakeGesture(this,a);b=this._getPointer(b.center);this._zoom(c,b)}a.preventDefault()};r.prototype._onMouseMoveTitle=function(a){a=m.fakeGesture(this,a);var b=this._getPointer(a.center);this.popupNode&&
this._checkHidePopup(b);var c=this;a=function(){c._checkShowPopup(b)};this.popupTimer&&clearInterval(this.popupTimer);this.drag.dragging||(this.popupTimer=setTimeout(a,300))};r.prototype._checkShowPopup=function(a){var b={left:this._canvasToX(a.x),top:this._canvasToY(a.y),right:this._canvasToX(a.x),bottom:this._canvasToY(a.y)},c,d=this.popupNode;if(void 0==this.popupNode){var e=this.nodes;for(c in e)if(e.hasOwnProperty(c)){var f=e[c];if(void 0!==f.getTitle()&&f.isOverlappingWith(b)){this.popupNode=
f;break}}}if(void 0===this.popupNode)for(c in e=this.edges,e)if(e.hasOwnProperty(c)&&(f=e[c],f.connected&&void 0!==f.getTitle()&&f.isOverlappingWith(b))){this.popupNode=f;break}this.popupNode?this.popupNode!=d&&(this.popup||(this.popup=new V(this.frame)),this.popup.setPosition(a.x-3,a.y-3),this.popup.setText(this.popupNode.getTitle()),this.popup.show()):this.popup&&this.popup.hide()};r.prototype._checkHidePopup=function(a){if(!this.popupNode||!this._getNodeAt(a))this.popupNode=void 0,this.popup&&
this.popup.hide()};r.prototype.setSize=function(a,b){this.frame.style.width=a;this.frame.style.height=b;this.frame.canvas.style.width="100%";this.frame.canvas.style.height="100%";this.frame.canvas.width=this.frame.canvas.clientWidth;this.frame.canvas.height=this.frame.canvas.clientHeight;void 0!==this.manipulationDiv&&(this.manipulationDiv.style.width=this.frame.canvas.clientWidth+"px");void 0!==this.navigationDivs&&void 0!==this.navigationDivs.wrapper&&(this.navigationDivs.wrapper.style.width=this.frame.canvas.clientWidth+
"px",this.navigationDivs.wrapper.style.height=this.frame.canvas.clientHeight+"px");this.emit("resize",{width:this.frame.canvas.width,height:this.frame.canvas.height})};r.prototype._setNodes=function(a){var b=this.nodesData;if(a instanceof n||a instanceof u)this.nodesData=a;else if(a instanceof Array)this.nodesData=new n,this.nodesData.add(a);else{if(a)throw new TypeError("Array or DataSet expected");this.nodesData=new n}b&&m.forEach(this.nodesListeners,function(a,c){b.off(c,a)});this.nodes={};if(this.nodesData){var c=
this;m.forEach(this.nodesListeners,function(a,b){c.nodesData.on(b,a)});a=this.nodesData.getIds();this._addNodes(a)}this._updateSelection()};r.prototype._addNodes=function(a){for(var b,c=0,d=a.length;c<d;c++){b=a[c];var e=this.nodesData.get(b),e=new p(e,this.images,this.groups,this.constants);this.nodes[b]=e;if((!1==e.xFixed||!1==e.yFixed)&&!0!=this.createNodeOnClick){b=1*a.length;var f=2*Math.PI*Math.random();!1==e.xFixed&&(e.x=b*Math.cos(f));!1==e.yFixed&&(e.y=b*Math.sin(f));this.moving=!0}}this._updateNodeIndexList();
this._updateCalculationNodes();this._reconnectEdges();this._updateValueRange(this.nodes);this.updateLabels()};r.prototype._updateNodes=function(a){for(var b=this.nodes,c=this.nodesData,d=0,e=a.length;d<e;d++){var f=a[d],g=b[f],h=c.get(f);g?g.setProperties(h,this.constants):(g=new p(properties,this.images,this.groups,this.constants),b[f]=g,g.isFixed()||(this.moving=!0))}this._updateNodeIndexList();this._reconnectEdges();this._updateValueRange(b)};r.prototype._removeNodes=function(a){for(var b=this.nodes,
c=0,d=a.length;c<d;c++)delete b[a[c]];this._updateNodeIndexList();this._reconnectEdges();this._updateSelection();this._updateValueRange(b)};r.prototype._setEdges=function(a){var b=this.edgesData;if(a instanceof n||a instanceof u)this.edgesData=a;else if(a instanceof Array)this.edgesData=new n,this.edgesData.add(a);else{if(a)throw new TypeError("Array or DataSet expected");this.edgesData=new n}b&&m.forEach(this.edgesListeners,function(a,c){b.off(c,a)});this.edges={};if(this.edgesData){var c=this;m.forEach(this.edgesListeners,
function(a,b){c.edgesData.on(b,a)});a=this.edgesData.getIds();this._addEdges(a)}this._reconnectEdges()};r.prototype._addEdges=function(a){for(var b=this.edges,c=this.edgesData,d=0,e=a.length;d<e;d++){var f=a[d],g=b[f];g&&g.disconnect();g=c.get(f,{showInternalIds:!0});b[f]=new z(g,this,this.constants)}this.moving=!0;this._updateValueRange(b);this._createBezierNodes();this._updateCalculationNodes()};r.prototype._updateEdges=function(a){for(var b=this.edges,c=this.edgesData,d=0,e=a.length;d<e;d++){var f=
a[d],g=c.get(f),h=b[f];h?(h.disconnect(),h.setProperties(g,this.constants),h.connect()):(h=new z(g,this,this.constants),this.edges[f]=h)}this._createBezierNodes();this.moving=!0;this._updateValueRange(b)};r.prototype._removeEdges=function(a){for(var b=this.edges,c=0,d=a.length;c<d;c++){var e=a[c],f=b[e];f&&(null!=f.via&&delete this.sectors.support.nodes[f.via.id],f.disconnect(),delete b[e])}this.moving=!0;this._updateValueRange(b);this._updateCalculationNodes()};r.prototype._reconnectEdges=function(){var a,
b=this.nodes,c=this.edges;for(a in b)b.hasOwnProperty(a)&&(b[a].edges=[]);for(a in c)c.hasOwnProperty(a)&&(b=c[a],b.from=null,b.to=null,b.connect())};r.prototype._updateValueRange=function(a){var b,c=void 0,d=void 0;for(b in a)if(a.hasOwnProperty(b)){var e=a[b].getValue();void 0!==e&&(c=void 0===c?e:Math.min(e,c),d=void 0===d?e:Math.max(e,d))}if(void 0!==c&&void 0!==d)for(b in a)a.hasOwnProperty(b)&&a[b].setValueRange(c,d)};r.prototype.redraw=function(){this.setSize(this.width,this.height);this._redraw()};
r.prototype._redraw=function(){var a=this.frame.canvas.getContext("2d");a.clearRect(0,0,this.frame.canvas.width,this.frame.canvas.height);a.save();a.translate(this.translation.x,this.translation.y);a.scale(this.scale,this.scale);this.canvasTopLeft={x:this._canvasToX(0),y:this._canvasToY(0)};this.canvasBottomRight={x:this._canvasToX(this.frame.canvas.clientWidth),y:this._canvasToY(this.frame.canvas.clientHeight)};this._doInAllSectors("_drawAllSectorNodes",a);this._doInAllSectors("_drawEdges",a);this._doInAllSectors("_drawNodes",
a,!1);a.restore()};r.prototype._setTranslation=function(a,b){void 0===this.translation&&(this.translation={x:0,y:0});void 0!==a&&(this.translation.x=a);void 0!==b&&(this.translation.y=b)};r.prototype._getTranslation=function(){return{x:this.translation.x,y:this.translation.y}};r.prototype._setScale=function(a){this.scale=a};r.prototype._getScale=function(){return this.scale};r.prototype._canvasToX=function(a){return(a-this.translation.x)/this.scale};r.prototype._xToCanvas=function(a){return a*this.scale+
this.translation.x};r.prototype._canvasToY=function(a){return(a-this.translation.y)/this.scale};r.prototype._yToCanvas=function(a){return a*this.scale+this.translation.y};r.prototype._drawNodes=function(a,b){void 0===b&&(b=!1);var c=this.nodes,d=[],e;for(e in c)c.hasOwnProperty(e)&&(c[e].setScaleAndPos(this.scale,this.canvasTopLeft,this.canvasBottomRight),c[e].isSelected()?d.push(e):(c[e].inArea()||b)&&c[e].draw(a));e=0;for(var f=d.length;e<f;e++)(c[d[e]].inArea()||b)&&c[d[e]].draw(a)};r.prototype._drawEdges=
function(a){var b=this.edges,c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c];d.setScale(this.scale);d.connected&&b[c].draw(a)}};r.prototype._stabilize=function(){for(var a=0;this.moving&&a<this.constants.stabilizationIterations;)this._physicsTick(),a++;this.zoomExtent(!1,!0)};r.prototype._isMoving=function(a){var b=this.nodes,c;for(c in b)if(b.hasOwnProperty(c)&&b[c].isMoving(a))return!0;return!1};r.prototype._discreteStepNodes=function(){var a=this.nodes,b;if(0<this.constants.maxVelocity)for(b in a)a.hasOwnProperty(b)&&
a[b].discreteStepLimited(0.65,this.constants.maxVelocity);else for(b in a)a.hasOwnProperty(b)&&a[b].discreteStep(0.65);a=this.constants.minVelocity/Math.max(this.scale,0.05);this.moving=a>0.5*this.constants.maxVelocity?!0:this._isMoving(a)};r.prototype._physicsTick=function(){!this.freezeSimulation&&this.moving&&(this._doInAllActiveSectors("_initializeForceCalculation"),this.constants.smoothCurves&&this._doInSupportSector("_discreteStepNodes"),this._doInAllActiveSectors("_discreteStepNodes"),this._findCenter(this._getRange()))};
r.prototype._animationStep=function(){this.timer=void 0;this._handleNavigation();this.start();var a=Date.now(),b=1;this._physicsTick();for(var c=Date.now()-a;c<this.renderTimestep-this.renderTime&&b<this.maxRenderSteps;)this._physicsTick(),c=Date.now()-a,b++;a=Date.now();this._redraw();this.renderTime=Date.now()-a};"undefined"!==typeof window&&(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame);
r.prototype.start=function(){this.moving||0!=this.xIncrement||0!=this.yIncrement||0!=this.zoomIncrement?this.timer||(this.timer=window.requestAnimationFrame(this._animationStep.bind(this),this.renderTimestep)):this._redraw()};r.prototype._handleNavigation=function(){if(0!=this.xIncrement||0!=this.yIncrement){var a=this._getTranslation();this._setTranslation(a.x+this.xIncrement,a.y+this.yIncrement)}0!=this.zoomIncrement&&this._zoom(this.scale*(1+this.zoomIncrement),{x:this.frame.canvas.clientWidth/
2,y:this.frame.canvas.clientHeight/2})};r.prototype.toggleFreeze=function(){!1==this.freezeSimulation?this.freezeSimulation=!0:(this.freezeSimulation=!1,this.start())};r.prototype._configureSmoothCurves=function(a){void 0===a&&(a=!0);if(!0==this.constants.smoothCurves)this._createBezierNodes();else{this.sectors.support.nodes={};for(var b in this.edges)this.edges.hasOwnProperty(b)&&(this.edges[b].smooth=!1,this.edges[b].via=null)}this._updateCalculationNodes();a||(this.moving=!0,this.start())};r.prototype._createBezierNodes=
function(){if(!0==this.constants.smoothCurves)for(var a in this.edges)if(this.edges.hasOwnProperty(a)){var b=this.edges[a];if(null==b.via){b.smooth=!0;var c="edgeId:".concat(b.id);this.sectors.support.nodes[c]=new p({id:c,mass:1,shape:"circle",internalMultiplier:1},{},{},this.constants);b.via=this.sectors.support.nodes[c];b.via.parentEdgeId=b.id;b.positionBezierNode()}}};r.prototype._initializeMixinLoaders=function(){for(var a in H)H.hasOwnProperty(a)&&(r.prototype[a]=H[a])};r.prototype.storePosition=
function(){var a=[],b;for(b in this.nodes)if(this.nodes.hasOwnProperty(b)){var c=this.nodes[b],d=!this.nodes.xFixed,e=!this.nodes.yFixed;(this.nodesData.data[b].x!=Math.round(c.x)||this.nodesData.data[b].y!=Math.round(c.y))&&a.push({id:b,x:Math.round(c.x),y:Math.round(c.y),allowedToMoveX:d,allowedToMoveY:e})}this.nodesData.update(a)};var M={util:m,Controller:E,DataSet:n,DataView:u,Range:g,Stack:A,TimeStep:TimeStep,components:{items:{Item:K,ItemBox:N,ItemPoint:x,ItemRange:G},Component:f,Panel:h,RootPanel:s,
ItemSet:q,TimeAxis:B},graph:{Node:p,Edge:z,Popup:V,Groups:Groups,Images:Images},Timeline:y,Graph:r};"undefined"!==typeof Q&&(Q=M);"undefined"!==typeof I&&"undefined"!==typeof I.exports&&(I.exports=M);"undefined"!==typeof window&&(window.vis=M)},{"emitter-component":2,hammerjs:3,moment:4,mousetrap:5}],2:[function(v,I,Q){function n(u){if(u){for(var A in n.prototype)u[A]=n.prototype[A];return u}}I.exports=n;n.prototype.on=n.prototype.addEventListener=function(n,A){this._callbacks=this._callbacks||{};
(this._callbacks[n]=this._callbacks[n]||[]).push(A);return this};n.prototype.once=function(n,A){function g(){v.off(n,g);A.apply(this,arguments)}var v=this;this._callbacks=this._callbacks||{};g.fn=A;this.on(n,g);return this};n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(n,A){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var g=this._callbacks[n];if(!g)return this;if(1==arguments.length)return delete this._callbacks[n],
this;for(var v,J=0;J<g.length;J++)if(v=g[J],v===A||v.fn===A){g.splice(J,1);break}return this};n.prototype.emit=function(n){this._callbacks=this._callbacks||{};var v=[].slice.call(arguments,1),g=this._callbacks[n];if(g)for(var g=g.slice(0),I=0,J=g.length;I<J;++I)g[I].apply(this,v);return this};n.prototype.listeners=function(n){this._callbacks=this._callbacks||{};return this._callbacks[n]||[]};n.prototype.hasListeners=function(n){return!!this.listeners(n).length}},{}],3:[function(v,I,Q){(function(n,
u){function v(){if(!g.READY){g.event.determineEventTypes();for(var f in g.gestures)g.gestures.hasOwnProperty(f)&&g.detection.register(g.gestures[f]);g.event.onTouch(g.DOCUMENT,g.EVENT_MOVE,g.detection.detect);g.event.onTouch(g.DOCUMENT,g.EVENT_END,g.detection.detect);g.READY=!0}}var g=function(f,h){return new g.Instance(f,h||{})};g.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};g.HAS_POINTEREVENTS=
navigator.pointerEnabled||navigator.msPointerEnabled;g.HAS_TOUCHEVENTS="ontouchstart"in n;g.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;g.NO_MOUSEEVENTS=g.HAS_TOUCHEVENTS&&navigator.userAgent.match(g.MOBILE_REGEX);g.EVENT_TYPES={};g.DIRECTION_DOWN="down";g.DIRECTION_LEFT="left";g.DIRECTION_UP="up";g.DIRECTION_RIGHT="right";g.POINTER_MOUSE="mouse";g.POINTER_TOUCH="touch";g.POINTER_PEN="pen";g.EVENT_START="start";g.EVENT_MOVE="move";g.EVENT_END="end";g.DOCUMENT=document;g.plugins={};g.READY=
!1;g.Instance=function(f,h){var s=this;v();this.element=f;this.enabled=!0;this.options=g.utils.extend(g.utils.extend({},g.defaults),h||{});this.options.stop_browser_behavior&&g.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior);g.event.onTouch(f,g.EVENT_START,function(f){s.enabled&&g.detection.startDetect(s,f)});return this};g.Instance.prototype={on:function(f,g){for(var s=f.split(" "),n=0;n<s.length;n++)this.element.addEventListener(s[n],g,!1);return this},off:function(f,
g){for(var s=f.split(" "),n=0;n<s.length;n++)this.element.removeEventListener(s[n],g,!1);return this},trigger:function(f,h){var s=g.DOCUMENT.createEvent("Event");s.initEvent(f,!0,!0);s.gesture=h;var n=this.element;g.utils.hasParent(h.target,n)&&(n=h.target);n.dispatchEvent(s);return this},enable:function(f){this.enabled=f;return this}};var S=null,J=!1,E=!1;g.event={bindDom:function(f,g,s){g=g.split(" ");for(var n=0;n<g.length;n++)f.addEventListener(g[n],s,!1)},onTouch:function(f,h,s){var n=this;this.bindDom(f,
g.EVENT_TYPES[h],function(u){var v=u.type.toLowerCase();if(!v.match(/mouse/)||!E){if(v.match(/touch/)||v.match(/pointerdown/)||v.match(/mouse/)&&1===u.which)J=!0;v.match(/touch|pointer/)&&(E=!0);var q=0;J&&(g.HAS_POINTEREVENTS&&h!=g.EVENT_END?q=g.PointerEvent.updatePointer(h,u):v.match(/touch/)?q=u.touches.length:E||(q=v.match(/up/)?0:1),0<q&&h==g.EVENT_END?h=g.EVENT_MOVE:q||(h=g.EVENT_END),!q&&null!==S?u=S:S=u,s.call(g.detection,n.collectEventData(f,h,u)),g.HAS_POINTEREVENTS&&h==g.EVENT_END&&(q=
g.PointerEvent.updatePointer(h,u)));q||(S=null,E=J=!1,g.PointerEvent.reset())}})},determineEventTypes:function(){var f;f=g.HAS_POINTEREVENTS?g.PointerEvent.getEvents():g.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"];g.EVENT_TYPES[g.EVENT_START]=f[0];g.EVENT_TYPES[g.EVENT_MOVE]=f[1];g.EVENT_TYPES[g.EVENT_END]=f[2]},getTouchList:function(f){return g.HAS_POINTEREVENTS?g.PointerEvent.getTouchList():f.touches?
f.touches:[{identifier:1,pageX:f.pageX,pageY:f.pageY,target:f.target}]},collectEventData:function(f,h,s){f=this.getTouchList(s,h);var n=g.POINTER_TOUCH;if(s.type.match(/mouse/)||g.PointerEvent.matchType(g.POINTER_MOUSE,s))n=g.POINTER_MOUSE;return{center:g.utils.getCenter(f),timeStamp:(new Date).getTime(),target:s.target,touches:f,eventType:h,pointerType:n,srcEvent:s,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation();this.srcEvent.preventDefault&&this.srcEvent.preventDefault()},
stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return g.detection.stopDetect()}}}};g.PointerEvent={pointers:{},getTouchList:function(){var f=this,g=[];Object.keys(f.pointers).sort().forEach(function(s){g.push(f.pointers[s])});return g},updatePointer:function(f,h){f==g.EVENT_END?this.pointers={}:(h.identifier=h.pointerId,this.pointers[h.pointerId]=h);return Object.keys(this.pointers).length},matchType:function(f,h){if(!h.pointerType)return!1;var s={};s[g.POINTER_MOUSE]=
h.pointerType==h.MSPOINTER_TYPE_MOUSE||h.pointerType==g.POINTER_MOUSE;s[g.POINTER_TOUCH]=h.pointerType==h.MSPOINTER_TYPE_TOUCH||h.pointerType==g.POINTER_TOUCH;s[g.POINTER_PEN]=h.pointerType==h.MSPOINTER_TYPE_PEN||h.pointerType==g.POINTER_PEN;return s[f]},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]},reset:function(){this.pointers={}}};g.utils={extend:function(f,g,s){for(var n in g)f[n]!==u&&s||(f[n]=g[n]);
return f},hasParent:function(f,g){for(;f;){if(f==g)return!0;f=f.parentNode}return!1},getCenter:function(f){for(var g=[],s=[],n=0,u=f.length;n<u;n++)g.push(f[n].pageX),s.push(f[n].pageY);return{pageX:(Math.min.apply(Math,g)+Math.max.apply(Math,g))/2,pageY:(Math.min.apply(Math,s)+Math.max.apply(Math,s))/2}},getVelocity:function(f,g,s){return{x:Math.abs(g/f)||0,y:Math.abs(s/f)||0}},getAngle:function(f,g){return 180*Math.atan2(g.pageY-f.pageY,g.pageX-f.pageX)/Math.PI},getDirection:function(f,h){var s=
Math.abs(f.pageX-h.pageX),n=Math.abs(f.pageY-h.pageY);return s>=n?0<f.pageX-h.pageX?g.DIRECTION_LEFT:g.DIRECTION_RIGHT:0<f.pageY-h.pageY?g.DIRECTION_UP:g.DIRECTION_DOWN},getDistance:function(f,g){var s=g.pageX-f.pageX,n=g.pageY-f.pageY;return Math.sqrt(s*s+n*n)},getScale:function(f,g){return 2<=f.length&&2<=g.length?this.getDistance(g[0],g[1])/this.getDistance(f[0],f[1]):1},getRotation:function(f,g){return 2<=f.length&&2<=g.length?this.getAngle(g[1],g[0])-this.getAngle(f[1],f[0]):0},isVertical:function(f){return f==
g.DIRECTION_UP||f==g.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(f,g){var n,u="webkit khtml moz ms o ".split(" ");if(g&&f.style){for(var v=0;v<u.length;v++)for(var A in g)g.hasOwnProperty(A)&&(n=A,u[v]&&(n=u[v]+n.substring(0,1).toUpperCase()+n.substring(1)),f.style[n]=g[A]);"none"==g.userSelect&&(f.onselectstart=function(){return!1})}}};g.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(f,h){this.current||(this.stopped=!1,this.current={inst:f,startEvent:g.utils.extend({},
h),lastEvent:!1,name:""},this.detect(h))},detect:function(f){if(this.current&&!this.stopped){f=this.extendEventData(f);for(var h=this.current.inst.options,n=0,u=this.gestures.length;n<u;n++){var v=this.gestures[n];if(!this.stopped&&!1!==h[v.name]&&!1===v.handler.call(v,f,this.current.inst)){this.stopDetect();break}}this.current&&(this.current.lastEvent=f);f.eventType==g.EVENT_END&&!f.touches.length-1&&this.stopDetect();return f}},stopDetect:function(){this.previous=g.utils.extend({},this.current);
this.current=null;this.stopped=!0},extendEventData:function(f){var h=this.current.startEvent;if(h&&(f.touches.length!=h.touches.length||f.touches===h.touches)){h.touches=[];for(var n=0,u=f.touches.length;n<u;n++)h.touches.push(g.utils.extend({},f.touches[n]))}var n=f.timeStamp-h.timeStamp,u=f.center.pageX-h.center.pageX,v=f.center.pageY-h.center.pageY,A=g.utils.getVelocity(n,u,v);g.utils.extend(f,{deltaTime:n,deltaX:u,deltaY:v,velocityX:A.x,velocityY:A.y,distance:g.utils.getDistance(h.center,f.center),
angle:g.utils.getAngle(h.center,f.center),direction:g.utils.getDirection(h.center,f.center),scale:g.utils.getScale(h.touches,f.touches),rotation:g.utils.getRotation(h.touches,f.touches),startEvent:h});return f},register:function(f){var h=f.defaults||{};h[f.name]===u&&(h[f.name]=!0);g.utils.extend(g.defaults,h,!0);f.index=f.index||1E3;this.gestures.push(f);this.gestures.sort(function(f,g){return f.index<g.index?-1:f.index>g.index?1:0});return this.gestures}};g.gestures=g.gestures||{};g.gestures.Hold=
{name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(f,h){switch(f.eventType){case g.EVENT_START:clearTimeout(this.timer);g.detection.current.name=this.name;this.timer=setTimeout(function(){"hold"==g.detection.current.name&&h.trigger("hold",f)},h.options.hold_timeout);break;case g.EVENT_MOVE:f.distance>h.options.hold_threshold&&clearTimeout(this.timer);break;case g.EVENT_END:clearTimeout(this.timer)}}};g.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,
tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(f,h){if(f.eventType==g.EVENT_END){var n=g.detection.previous,u=!1;if(!(f.deltaTime>h.options.tap_max_touchtime||f.distance>h.options.tap_max_distance))if(n&&("tap"==n.name&&f.timeStamp-n.lastEvent.timeStamp<h.options.doubletap_interval&&f.distance<h.options.doubletap_distance)&&(h.trigger("doubletap",f),u=!0),!u||h.options.tap_always)g.detection.current.name="tap",h.trigger(g.detection.current.name,f)}}};
g.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:0.7},handler:function(f,h){if(f.eventType==g.EVENT_END&&!(0<h.options.swipe_max_touches&&f.touches.length>h.options.swipe_max_touches)&&(f.velocityX>h.options.swipe_velocity||f.velocityY>h.options.swipe_velocity))h.trigger(this.name,f),h.trigger(this.name+f.direction,f)}};g.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,
drag_lock_min_distance:25},triggered:!1,handler:function(f,h){if(g.detection.current.name!=this.name&&this.triggered)h.trigger(this.name+"end",f),this.triggered=!1;else if(!(0<h.options.drag_max_touches&&f.touches.length>h.options.drag_max_touches))switch(f.eventType){case g.EVENT_START:this.triggered=!1;break;case g.EVENT_MOVE:if(f.distance<h.options.drag_min_distance&&g.detection.current.name!=this.name)break;g.detection.current.name=this.name;if(g.detection.current.lastEvent.drag_locked_to_axis||
h.options.drag_lock_to_axis&&h.options.drag_lock_min_distance<=f.distance)f.drag_locked_to_axis=!0;var n=g.detection.current.lastEvent.direction;f.drag_locked_to_axis&&n!==f.direction&&(g.utils.isVertical(n)?f.direction=0>f.deltaY?g.DIRECTION_UP:g.DIRECTION_DOWN:f.direction=0>f.deltaX?g.DIRECTION_LEFT:g.DIRECTION_RIGHT);this.triggered||(h.trigger(this.name+"start",f),this.triggered=!0);h.trigger(this.name,f);h.trigger(this.name+f.direction,f);(h.options.drag_block_vertical&&g.utils.isVertical(f.direction)||
h.options.drag_block_horizontal&&!g.utils.isVertical(f.direction))&&f.preventDefault();break;case g.EVENT_END:this.triggered&&h.trigger(this.name+"end",f),this.triggered=!1}}};g.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:0.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(f,h){if(g.detection.current.name!=this.name&&this.triggered)h.trigger(this.name+"end",f),this.triggered=!1;else if(!(2>f.touches.length))switch(h.options.transform_always_block&&
f.preventDefault(),f.eventType){case g.EVENT_START:this.triggered=!1;break;case g.EVENT_MOVE:var n=Math.abs(1-f.scale),u=Math.abs(f.rotation);if(n<h.options.transform_min_scale&&u<h.options.transform_min_rotation)break;g.detection.current.name=this.name;this.triggered||(h.trigger(this.name+"start",f),this.triggered=!0);h.trigger(this.name,f);u>h.options.transform_min_rotation&&h.trigger("rotate",f);n>h.options.transform_min_scale&&(h.trigger("pinch",f),h.trigger("pinch"+(1>f.scale?"in":"out"),f));
break;case g.EVENT_END:this.triggered&&h.trigger(this.name+"end",f),this.triggered=!1}}};g.gestures.Touch={name:"touch",index:-Infinity,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(f,h){h.options.prevent_mouseevents&&f.pointerType==g.POINTER_MOUSE?f.stopDetect():(h.options.prevent_default&&f.preventDefault(),f.eventType==g.EVENT_START&&h.trigger(this.name,f))}};g.gestures.Release={name:"release",index:Infinity,handler:function(f,h){f.eventType==g.EVENT_END&&h.trigger(this.name,
f)}};"object"===typeof I&&"object"===typeof I.exports?I.exports=g:(n.Hammer=g,"function"===typeof n.define&&n.define.amd&&n.define("hammer",[],function(){return g}))})(this)},{}],4:[function(v,I,Q){(function(n){function u(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function A(a,b){return function(c){return s(a.call(this,c),b)}}function g(a,b){return function(c){return this.lang().ordinal(a.call(this,
c),b)}}function S(){}function J(a){U(a);f(this,a)}function E(a){a=K(a);var b=a.year||0,c=a.month||0,d=a.week||0,e=a.day||0;this._milliseconds=+(a.millisecond||0)+1E3*(a.second||0)+6E4*(a.minute||0)+36E5*(a.hour||0);this._days=+e+7*d;this._months=+c+12*b;this._data={};this._bubble()}function f(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);b.hasOwnProperty("toString")&&(a.toString=b.toString);b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf);return a}function h(a){return 0>a?Math.ceil(a):Math.floor(a)}
function s(a,b,c){for(var d=""+Math.abs(a);d.length<b;)d="0"+d;return(0<=a?c?"+":"":"-")+d}function B(a,b,c,d){var e=b._milliseconds,f=b._days;b=b._months;var g,k;e&&a._d.setTime(+a._d+e*c);if(f||b)g=a.minute(),k=a.hour();f&&a.date(a.date()+f*c);b&&a.month(a.month()+b*c);e&&!d&&t.updateOffset(a);if(f||b)a.minute(g),a.hour(k)}function Q(a){return"[object Array]"===Object.prototype.toString.call(a)}function P(a,b,c){var d=Math.min(a.length,b.length),e=Math.abs(a.length-b.length),f=0,g;for(g=0;g<d;g++)(c&&
a[g]!==b[g]||!c&&x(a[g])!==x(b[g]))&&f++;return f+e}function q(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");a=Pa[a]||Qa[b]||b}return a}function K(a){var b={},c,d;for(d in a)a.hasOwnProperty(d)&&(c=q(d))&&(b[c]=a[d]);return b}function N(a){var b,c;if(0===a.indexOf("week"))b=7,c="day";else if(0===a.indexOf("month"))b=12,c="month";else return;t[a]=function(d,e){var f,g,k=t.fn._lang[a],h=[];"number"===typeof d&&(e=d,d=n);g=function(a){a=t().utc().set(c,a);return k.call(t.fn._lang,a,d||"")};if(null!=
e)return g(e);for(f=0;f<b;f++)h.push(g(f));return h}}function x(a){a=+a;var b=0;0!==a&&isFinite(a)&&(b=0<=a?Math.floor(a):Math.ceil(a));return b}function G(a){return 0===a%4&&0!==a%100||0===a%400}function U(f){var g;if(f._a&&-2===f._pf.overflow){g=0>f._a[a]||11<f._a[a]?a:1>f._a[b]||f._a[b]>(new Date(Date.UTC(f._a[M],f._a[a]+1,0))).getUTCDate()?b:0>f._a[c]||23<f._a[c]?c:0>f._a[d]||59<f._a[d]?d:0>f._a[e]||59<f._a[e]?e:0>f._a[k]||999<f._a[k]?k:-1;if(f._pf._overflowDayOfYear&&(g<M||g>b))g=b;f._pf.overflow=
g}}function R(a){null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&0>a._pf.overflow&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length));return a._isValid}function D(a){return a?a.toLowerCase().replace("_","-"):a}function y(a,b){return b._isUTC?t(a).zone(b._offset||0):t(a).local()}function p(a){var b=0,c,d,e,f,g=function(a){if(!l[a]&&sa)try{v("./lang/"+a)}catch(b){}return l[a]};
if(!a)return t.fn._lang;if(!Q(a)){if(d=g(a))return d;a=[a]}for(;b<a.length;){f=D(a[b]).split("-");c=f.length;for(e=(e=D(a[b+1]))?e.split("-"):null;0<c;){if(d=g(f.slice(0,c).join("-")))return d;if(e&&e.length>=c&&P(f,e,!0)>=c-1)break;c--}b++}return t.fn._lang}function z(a){var b=a.match(ua),c,d;c=0;for(d=b.length;c<d;c++)b[c]=X[b[c]]?X[b[c]]:b[c].match(/\[[\s\S]/)?b[c].replace(/^\[|\]$/g,""):b[c].replace(/\\/g,"");return function(e){var f="";for(c=0;c<d;c++)f+=b[c]instanceof Function?b[c].call(e,a):
b[c];return f}}function V(a,b){if(!a.isValid())return a.lang().invalidDate();b=$(b,a.lang());oa[b]||(oa[b]=z(b));return oa[b](a)}function $(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(ia.lastIndex=0;0<=d&&ia.test(a);)a=a.replace(ia,c),ia.lastIndex=0,d-=1;return a}function O(a,b){var c=b._strict;switch(a){case "DDDD":return wa;case "YYYY":case "GGGG":case "gggg":return c?Ka:Ea;case "Y":case "G":case "g":return Ma;case "YYYYYY":case "YYYYY":case "GGGGG":case "ggggg":return c?La:Fa;
case "S":if(c)return Ga;case "SS":if(c)return va;case "SSS":if(c)return wa;case "DDD":return Da;case "MMM":case "MMMM":case "dd":case "ddd":case "dddd":return Ia;case "a":case "A":return p(b._l)._meridiemParse;case "X":return Oa;case "Z":case "ZZ":return w;case "T":return Ja;case "SSSS":return Ha;case "MM":case "DD":case "YY":case "GG":case "gg":case "HH":case "hh":case "mm":case "ss":case "ww":case "WW":return c?va:ta;case "M":case "D":case "d":case "H":case "h":case "m":case "s":case "w":case "W":case "e":case "E":return ta;
default:var c=RegExp,d;d=ha(a.replace("\\","")).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");return new c(d)}}function r(a){a=(a||"").match(w)||[];a=((a[a.length-1]||[])+"").match(Ra)||["-",0,0];var b=+(60*a[1])+x(a[2]);return"+"===a[0]?-b:b}function F(e){var f,g=[],k,h,l,n,r;if(!e._d){k=aa(e);e._w&&(null==e._a[b]&&null==e._a[a])&&(f=function(a){var b=parseInt(a,10);return a?3>a.length?68<b?1900+b:2E3+b:b:null==e._a[M]?t().weekYear():e._a[M]},h=e._w,null!=h.GG||null!=h.W||null!=h.E?f=ca(f(h.GG),h.W||
1,h.E,4,1):(l=p(e._l),n=null!=h.d?Z(h.d,l):null!=h.e?parseInt(h.e,10)+l._week.dow:0,r=parseInt(h.w,10)||1,null!=h.d&&n<l._week.dow&&r++,f=ca(f(h.gg),r,n,l._week.doy,l._week.dow)),e._a[M]=f.year,e._dayOfYear=f.dayOfYear);if(e._dayOfYear){f=null==e._a[M]?k[M]:e._a[M];if(e._dayOfYear>(G(f)?366:365))e._pf._overflowDayOfYear=!0;f=m(f,0,e._dayOfYear);e._a[a]=f.getUTCMonth();e._a[b]=f.getUTCDate()}for(f=0;3>f&&null==e._a[f];++f)e._a[f]=g[f]=k[f];for(;7>f;f++)e._a[f]=g[f]=null==e._a[f]?2===f?1:0:e._a[f];
g[c]+=x((e._tzm||0)/60);g[d]+=x((e._tzm||0)%60);e._d=(e._useUTC?m:ra).apply(null,g)}}function aa(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function T(f){f._a=[];f._pf.empty=!0;var g=p(f._l),h=""+f._i,l,m,n,y,t=h.length,s=0;m=$(f._f,g).match(ua)||[];for(g=0;g<m.length;g++){n=m[g];if(l=(h.match(O(n,f))||[])[0])y=h.substr(0,h.indexOf(l)),0<y.length&&f._pf.unusedInput.push(y),h=h.slice(h.indexOf(l)+l.length),s+=l.length;
if(X[n]){l?f._pf.empty=!1:f._pf.unusedTokens.push(n);y=f;var q=void 0,z=y._a;switch(n){case "M":case "MM":null!=l&&(z[a]=x(l)-1);break;case "MMM":case "MMMM":q=p(y._l).monthsParse(l);null!=q?z[a]=q:y._pf.invalidMonth=l;break;case "D":case "DD":null!=l&&(z[b]=x(l));break;case "DDD":case "DDDD":null!=l&&(y._dayOfYear=x(l));break;case "YY":z[M]=x(l)+(68<x(l)?1900:2E3);break;case "YYYY":case "YYYYY":case "YYYYYY":z[M]=x(l);break;case "a":case "A":y._isPm=p(y._l).isPM(l);break;case "H":case "HH":case "h":case "hh":z[c]=
x(l);break;case "m":case "mm":z[d]=x(l);break;case "s":case "ss":z[e]=x(l);break;case "S":case "SS":case "SSS":case "SSSS":z[k]=x(1E3*("0."+l));break;case "X":y._d=new Date(1E3*parseFloat(l));break;case "Z":case "ZZ":y._useUTC=!0;y._tzm=r(l);break;case "w":case "ww":case "W":case "WW":case "d":case "dd":case "ddd":case "dddd":case "e":case "E":n=n.substr(0,1);case "gg":case "gggg":case "GG":case "GGGG":case "GGGGG":n=n.substr(0,2),l&&(y._w=y._w||{},y._w[n]=l)}}else f._strict&&!l&&f._pf.unusedTokens.push(n)}f._pf.charsLeftOver=
t-s;0<h.length&&f._pf.unusedInput.push(h);f._isPm&&12>f._a[c]&&(f._a[c]+=12);!1===f._isPm&&12===f._a[c]&&(f._a[c]=0);F(f);U(f)}function ha(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function ra(a,b,c,d,e,f,g){b=new Date(a,b,c,d,e,f,g);1970>a&&b.setFullYear(a);return b}function m(a){var b=new Date(Date.UTC.apply(null,arguments));1970>a&&b.setUTCFullYear(a);return b}function Z(a,b){if("string"===typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!==
typeof a)return null}else a=parseInt(a,10);return a}function L(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function ea(a,b,c){b=c-b;c-=a.day();c>b&&(c-=7);c<b-7&&(c+=7);a=t(a).add("d",c);return{week:Math.ceil(a.dayOfYear()/7),year:a.year()}}function ca(a,b,c,d,e){var f=m(a,0,1).getUTCDay();b=7*(b-1)+((null!=c?c:e)-e)+(e-f+(f>d?7:0)-(f<e?7:0))+1;return{year:0<b?a:a-1,dayOfYear:0<b?b:(G(a-1)?366:365)+b}}function da(a){var b=a._i,c=a._f;if(null===b)return t.invalid({nullInput:!0});"string"===typeof b&&
(a._i=b=p().preparse(b));if(t.isMoment(b)){a=b;var d={},e;for(e in a)a.hasOwnProperty(e)&&C.hasOwnProperty(e)&&(d[e]=a[e]);a=d;a._d=new Date(+b._d)}else if(c)if(Q(c)){var b=a,g,k;if(0===b._f.length)b._pf.invalidFormat=!0,b._d=new Date(NaN);else{for(e=0;e<b._f.length;e++)if(c=0,d=f({},b),d._pf=u(),d._f=b._f[e],T(d),R(d)&&(c+=d._pf.charsLeftOver,c+=10*d._pf.unusedTokens.length,d._pf.score=c,null==k||c<k))k=c,g=d;f(b,g||d)}}else T(a);else if(d=a,g=d._i,k=Aa.exec(g),g===n)d._d=new Date;else if(k)d._d=
new Date(+k[1]);else if("string"===typeof g)if(b=d._i,e=Na.exec(b)){d._pf.iso=!0;g=0;for(k=la.length;g<k;g++)if(la[g][1].exec(b)){d._f=la[g][0]+(e[6]||" ");break}g=0;for(k=ma.length;g<k;g++)if(ma[g][1].exec(b)){d._f+=ma[g][0];break}b.match(w)&&(d._f+="Z");T(d)}else d._d=new Date(b);else Q(g)?(d._a=g.slice(0),F(d)):"[object Date]"===Object.prototype.toString.call(g)||g instanceof Date?d._d=new Date(+g):"object"===typeof g?d._d||(g=K(d._i),d._a=[g.year,g.month,g.day,g.hour,g.minute,g.second,g.millisecond],
F(d)):d._d=new Date(g);return new J(a)}function ba(a,b){t.fn[a]=t.fn[a+"s"]=function(a){var c=this._isUTC?"UTC":"";return null!=a?(this._d["set"+c+b](a),t.updateOffset(this),this):this._d["get"+c+b]()}}function na(a){t.duration.fn[a]=function(){return this._data[a]}}function fa(a,b){t.duration.fn["as"+a]=function(){return+this/b}}function ja(a){var b=!1,c=t;"undefined"===typeof ender&&(a?(ga.moment=function(){!b&&(console&&console.warn)&&(b=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release."));
return c.apply(null,arguments)},f(ga.moment,c)):ga.moment=t)}for(var t,ga=this,W=Math.round,H,M=0,a=1,b=2,c=3,d=4,e=5,k=6,l={},C={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},sa="undefined"!==typeof I&&I.exports&&"undefined"!==typeof v,Aa=/^\/?Date\((\-?\d+)/i,Ba=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ca=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,
ua=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,ia=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,ta=/\d\d?/,Da=/\d{1,3}/,Ea=/\d{1,4}/,Fa=/[+\-]?\d{1,6}/,Ha=/\d+/,Ia=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,w=/Z|[\+\-]\d\d:?\d\d/gi,Ja=/T/i,Oa=/[\+\-]?\d+(\.\d{1,3})?/,Ga=/\d/,va=/\d\d/,wa=/\d{3}/,Ka=/\d{4}/,La=/[+-]?\d{6}/,
Ma=/[+-]?\d+/,Na=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,la=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],ma=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Ra=/([\+\-]|\d\d)/gi,pa=["Date","Hours",
"Minutes","Seconds","Milliseconds"],qa={Milliseconds:1,Seconds:1E3,Minutes:6E4,Hours:36E5,Days:864E5,Months:2592E6,Years:31536E6},Pa={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Qa={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},oa={},xa="DDD w W M D d".split(" "),ya="MDHhmswW".split(""),X={M:function(){return this.month()+
1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return s(this.year()%100,2)},YYYY:function(){return s(this.year(),
4)},YYYYY:function(){return s(this.year(),5)},YYYYYY:function(){var a=this.year();return(0<=a?"+":"-")+s(Math.abs(a),6)},gg:function(){return s(this.weekYear()%100,2)},gggg:function(){return s(this.weekYear(),4)},ggggg:function(){return s(this.weekYear(),5)},GG:function(){return s(this.isoWeekYear()%100,2)},GGGG:function(){return s(this.isoWeekYear(),4)},GGGGG:function(){return s(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),
this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return x(this.milliseconds()/100)},SS:function(){return s(x(this.milliseconds()/10),2)},SSS:function(){return s(this.milliseconds(),3)},SSSS:function(){return s(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";0>a&&(a=-a,b="-");return b+
s(x(a/60),2)+":"+s(x(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";0>a&&(a=-a,b="-");return b+s(x(a/60),2)+s(x(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},za=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];xa.length;)H=xa.pop(),X[H+"o"]=g(X[H],H);for(;ya.length;)H=ya.pop(),X[H+H]=A(X[H],2);X.DDDD=A(X.DDD,3);f(S.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"===
typeof b?this[c]=b:this["_"+c]=b},_months:"January February March April May June July August September October November December".split(" "),months:function(a){return this._months[a.month()]},_monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c;this._monthsParse||(this._monthsParse=[]);for(b=0;12>b;b++)if(this._monthsParse[b]||(c=t.utc([2E3,b]),c="^"+this.months(c,"")+"|^"+this.monthsShort(c,
""),this._monthsParse[b]=RegExp(c.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c;this._weekdaysParse||
(this._weekdaysParse=[]);for(b=0;7>b;b++)if(this._weekdaysParse[b]||(c=t([2E3,1]).day(b),c="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=RegExp(c.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,
function(a){return a.slice(1)}),this._longDateFormat[a]=b);return b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return 11<a?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"===typeof c?c.apply(b):c},_relativeTime:{future:"in %s",
past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"===typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[0<a?"future":"past"];return"function"===typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},
postformat:function(a){return a},week:function(a){return ea(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});t=function(a,b,c,d){var e;"boolean"===typeof c&&(d=c,c=n);e={_isAMomentObject:!0};e._i=a;e._f=b;e._l=c;e._strict=d;e._isUTC=!1;e._pf=u();return da(e)};t.utc=function(a,b,c,d){var e;"boolean"===typeof c&&(d=c,c=n);e={_isAMomentObject:!0,_useUTC:!0,_isUTC:!0};e._l=c;e._i=a;e._f=b;e._strict=d;e._pf=u();return da(e).utc()};
t.unix=function(a){return t(1E3*a)};t.duration=function(a,f){var g=a,h=null,l;if(t.isDuration(a))g={ms:a._milliseconds,d:a._days,M:a._months};else if("number"===typeof a)g={},f?g[f]=a:g.milliseconds=a;else if(h=Ba.exec(a))l="-"===h[1]?-1:1,g={y:0,d:x(h[b])*l,h:x(h[c])*l,m:x(h[d])*l,s:x(h[e])*l,ms:x(h[k])*l};else if(h=Ca.exec(a))l="-"===h[1]?-1:1,g=function(a){a=a&&parseFloat(a.replace(",","."));return(isNaN(a)?0:a)*l},g={y:g(h[2]),M:g(h[3]),d:g(h[4]),h:g(h[5]),m:g(h[6]),s:g(h[7]),w:g(h[8])};h=new E(g);
t.isDuration(a)&&a.hasOwnProperty("_lang")&&(h._lang=a._lang);return h};t.version="2.5.1";t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";t.updateOffset=function(){};t.lang=function(a,b){if(!a)return t.fn._lang._abbr;if(b){var c=D(a);b.abbr=c;l[c]||(l[c]=new S);l[c].set(b)}else null===b?(delete l[a],a="en"):l[a]||p(a);return(t.duration.fn._lang=t.fn._lang=p(a))._abbr};t.langData=function(a){a&&(a._lang&&a._lang._abbr)&&(a=a._lang._abbr);return p(a)};t.isMoment=function(a){return a instanceof J||null!=a&&a.hasOwnProperty("_isAMomentObject")};
t.isDuration=function(a){return a instanceof E};for(H=za.length-1;0<=H;--H)N(za[H]);t.normalizeUnits=function(a){return q(a)};t.invalid=function(a){var b=t.utc(NaN);null!=a?f(b._pf,a):b._pf.userInvalidated=!0;return b};t.parseZone=function(a){return t(a).parseZone()};f(t.fn=J.prototype,{clone:function(){return t(this)},valueOf:function(){return+this._d+6E4*(this._offset||0)},unix:function(){return Math.floor(+this/1E3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},
toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var a=t(this).utc();return 0<a.year()&&9999>=a.year()?V(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):V(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){return[this.year(),this.month(),this.date(),this.hours(),this.minutes(),this.seconds(),this.milliseconds()]},isValid:function(){return R(this)},isDSTShifted:function(){return this._a?this.isValid()&&0<P(this._a,(this._isUTC?t.utc(this._a):t(this._a)).toArray()):!1},parsingFlags:function(){return f({},
this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){this.zone(0);this._isUTC=!1;return this},format:function(a){a=V(this,a||t.defaultFormat);return this.lang().postformat(a)},add:function(a,b){var c;c="string"===typeof a?t.duration(+b,a):t.duration(a,b);B(this,c,1);return this},subtract:function(a,b){var c;c="string"===typeof a?t.duration(+b,a):t.duration(a,b);B(this,c,-1);return this},diff:function(a,b,c){a=y(a,this);var d=6E4*(this.zone()-
a.zone()),e;b=q(b);"year"===b||"month"===b?(e=432E5*(this.daysInMonth()+a.daysInMonth()),d=12*(this.year()-a.year())+(this.month()-a.month()),d+=(this-t(this).startOf("month")-(a-t(a).startOf("month")))/e,d-=6E4*(this.zone()-t(this).startOf("month").zone()-(a.zone()-t(a).startOf("month").zone()))/e,"year"===b&&(d/=12)):(e=this-a,d="second"===b?e/1E3:"minute"===b?e/6E4:"hour"===b?e/36E5:"day"===b?(e-d)/864E5:"week"===b?(e-d)/6048E5:e);return c?d:h(d)},from:function(a,b){return t.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},
fromNow:function(a){return this.from(t(),a)},calendar:function(){var a=y(t(),this).startOf("day"),a=this.diff(a,"days",!0);return this.format(this.lang().calendar(-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse",this))},isLeapYear:function(){return G(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=
a?(a=Z(a,this.lang()),this.add({d:a-b})):b},month:function(a){var b=this._isUTC?"UTC":"",c;if(null!=a){if("string"===typeof a&&(a=this.lang().monthsParse(a),"number"!==typeof a))return this;c=this.date();this.date(1);this._d["set"+b+"Month"](a);this.date(Math.min(c,this.daysInMonth()));t.updateOffset(this);return this}return this._d["get"+b+"Month"]()},startOf:function(a){a=q(a);switch(a){case "year":this.month(0);case "month":this.date(1);case "week":case "isoWeek":case "day":this.hours(0);case "hour":this.minutes(0);
case "minute":this.seconds(0);case "second":this.milliseconds(0)}"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1);return this},endOf:function(a){a=q(a);return this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){b="undefined"!==typeof b?b:"millisecond";return+this.clone().startOf(b)>+t(a).startOf(b)},isBefore:function(a,b){b="undefined"!==typeof b?b:"millisecond";return+this.clone().startOf(b)<+t(a).startOf(b)},isSame:function(a,b){b=b||"ms";return+this.clone().startOf(b)===
+y(a,this).startOf(b)},min:function(a){a=t.apply(null,arguments);return a<this?this:a},max:function(a){a=t.apply(null,arguments);return a>this?this:a},zone:function(a){var b=this._offset||0;if(null!=a)"string"===typeof a&&(a=r(a)),16>Math.abs(a)&&(a*=60),this._offset=a,this._isUTC=!0,b!==a&&B(this,t.duration(b-a,"m"),1,!0);else return this._isUTC?b:this._d.getTimezoneOffset();return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":
""},parseZone:function(){this._tzm?this.zone(this._tzm):"string"===typeof this._i&&this.zone(this._i);return this},hasAlignedHourOffset:function(a){a=a?t(a).zone():0;return 0===(this.zone()-a)%60},daysInMonth:function(){var a=this.year(),b=this.month();return(new Date(Date.UTC(a,b+1,0))).getUTCDate()},dayOfYear:function(a){var b=W((t(this).startOf("day")-t(this).startOf("year"))/864E5)+1;return null==a?b:this.add("d",a-b)},quarter:function(){return Math.ceil((this.month()+1)/3)},weekYear:function(a){var b=
ea(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=ea(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=ea(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:
this.day(this.day()%7?a:a-7)},get:function(a){a=q(a);return this[a]()},set:function(a,b){a=q(a);if("function"===typeof this[a])this[a](b);return this},lang:function(a){if(a===n)return this._lang;this._lang=p(a);return this}});for(H=0;H<pa.length;H++)ba(pa[H].toLowerCase().replace(/s$/,""),pa[H]);ba("year","FullYear");t.fn.days=t.fn.day;t.fn.months=t.fn.month;t.fn.weeks=t.fn.week;t.fn.isoWeeks=t.fn.isoWeek;t.fn.toJSON=t.fn.toISOString;f(t.duration.fn=E.prototype,{_bubble:function(){var a=this._milliseconds,
b=this._days,c=this._months,d=this._data;d.milliseconds=a%1E3;a=h(a/1E3);d.seconds=a%60;a=h(a/60);d.minutes=a%60;a=h(a/60);d.hours=a%24;b+=h(a/24);d.days=b%30;c+=h(b/30);d.months=c%12;b=h(c/12);d.years=b},weeks:function(){return h(this.days()/7)},valueOf:function(){return this._milliseconds+864E5*this._days+2592E6*(this._months%12)+31536E6*x(this._months/12)},humanize:function(a){var b=+this,c;c=!a;var d=this.lang(),e=W(Math.abs(b)/1E3),f=W(e/60),g=W(f/60),k=W(g/24),h=W(k/365),e=45>e&&["s",e]||1===
f&&["m"]||45>f&&["mm",f]||1===g&&["h"]||22>g&&["hh",g]||1===k&&["d"]||25>=k&&["dd",k]||45>=k&&["M"]||345>k&&["MM",W(k/30)]||1===h&&["y"]||["yy",h];e[2]=c;e[3]=0<b;e[4]=d;c=L.apply({},e);a&&(c=this.lang().pastFuture(b,c));return this.lang().postformat(c)},add:function(a,b){var c=t.duration(a,b);this._milliseconds+=c._milliseconds;this._days+=c._days;this._months+=c._months;this._bubble();return this},subtract:function(a,b){var c=t.duration(a,b);this._milliseconds-=c._milliseconds;this._days-=c._days;
this._months-=c._months;this._bubble();return this},get:function(a){a=q(a);return this[a.toLowerCase()+"s"]()},as:function(a){a=q(a);return this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:t.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1E3);return!this.asSeconds()?"P0D":(0>this.asSeconds()?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+
(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":"")}});for(H in qa)qa.hasOwnProperty(H)&&(fa(H,qa[H]),na(H.toLowerCase()));fa("Weeks",6048E5);t.duration.fn.asMonths=function(){return(+this-31536E6*this.years())/2592E6+12*this.years()};t.lang("en",{ordinal:function(a){var b=a%10,b=1===x(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});sa?(I.exports=t,ja(!0)):ja()}).call(this)},{}],5:[function(v,I,Q){function n(f,g,h){if(f.addEventListener)return f.addEventListener(g,
h,!1);f.attachEvent("on"+g,h)}function u(f){return"keypress"==f.type?String.fromCharCode(f.which):B[f.which]?B[f.which]:Y[f.which]?Y[f.which]:String.fromCharCode(f.which).toLowerCase()}function A(f){f=f||{};var g=!1,h;for(h in G)f[h]?g=!0:G[h]=0;g||(D=!1)}function g(f,g,h,n,s){var q,r,u=[];if(!N[f])return[];"keyup"==h&&E(f)&&(g=[f]);for(q=0;q<N[f].length;++q)if(r=N[f][q],!(r.seq&&G[r.seq]!=r.level)&&h==r.action&&("keypress"==h||g.sort().join(",")===r.modifiers.sort().join(",")))n&&r.combo==s&&N[f].splice(q,
1),u.push(r);return u}function S(f,g){!1===f(g)&&(g.preventDefault&&g.preventDefault(),g.stopPropagation&&g.stopPropagation(),g.returnValue=!1,g.cancelBubble=!0)}function J(f){f.which="number"==typeof f.which?f.which:f.keyCode;var h=u(f);if(h)if("keyup"==f.type&&R==h)R=!1;else{var n=f.target||f.srcElement,q=n.tagName;if(!(-1<(" "+n.className+" ").indexOf(" mousetrap ")?0:"INPUT"==q||"SELECT"==q||"TEXTAREA"==q||n.contentEditable&&"true"==n.contentEditable)){n=[];f.shiftKey&&n.push("shift");f.altKey&&
n.push("alt");f.ctrlKey&&n.push("ctrl");f.metaKey&&n.push("meta");for(var n=g(h,n,f.type),s={},v=!1,q=0;q<n.length;++q)n[q].seq?(v=!0,s[n[q].seq]=1,S(n[q].callback,f)):!v&&!D&&S(n[q].callback,f);f.type==D&&!E(h)&&A(s)}}}function E(f){return"shift"==f||"ctrl"==f||"alt"==f||"meta"==f}function f(f,g,h){if(!h){if(!K){K={};for(var n in B)95<n&&112>n||B.hasOwnProperty(n)&&(K[B[n]]=n)}h=K[f]?"keydown":"keypress"}"keypress"==h&&g.length&&(h="keydown");return h}function h(g,h,n,q){G[g]=0;q||(q=f(h[0],[]));
var v=function(f){D=q;++G[g];clearTimeout(U);U=setTimeout(A,1E3)},x=function(f){S(n,f);"keyup"!==q&&(R=u(f));setTimeout(A,10)},r;for(r=0;r<h.length;++r)s(h[r],r<h.length-1?v:x,q,g,r)}function s(n,p,s,u,v){n=n.replace(/\s+/g," ");var x=n.split(" "),r,A,B=[];if(1<x.length)return h(n,x,p,s);A="+"===n?["+"]:n.split("+");for(x=0;x<A.length;++x)r=A[x],q[r]&&(r=q[r]),s&&("keypress"!=s&&P[r])&&(r=P[r],B.push("shift")),E(r)&&B.push(r);s=f(r,B,s);N[r]||(N[r]=[]);g(r,B,s,!u,n);N[r][u?"unshift":"push"]({callback:p,
modifiers:B,action:s,seq:u,level:v,combo:n})}var B={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},Y={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},P={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",
_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},q={option:"alt",command:"meta","return":"enter",escape:"esc"},K,N={},x={},G={},U,R=!1,D=!1;for(v=1;20>v;++v)B[111+v]="f"+v;for(v=0;9>=v;++v)B[v+96]=v;n(document,"keypress",J);n(document,"keydown",J);n(document,"keyup",J);I.exports={bind:function(f,g,h){for(var n=f instanceof Array?f:[f],q=0;q<n.length;++q)s(n[q],g,h);x[f+":"+h]=g;return this},unbind:function(f,g){x[f+":"+g]&&(delete x[f+":"+g],this.bind(f,function(){},g));return this},
trigger:function(f,g){x[f+":"+g]();return this},reset:function(){N={};x={};return this}}},{}]},{},[1])(1)});
