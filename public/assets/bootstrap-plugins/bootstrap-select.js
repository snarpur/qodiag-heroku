!function(d){var h=function(b,a,e){e&&(e.stopPropagation(),e.preventDefault());this.$element=d(b);this.button=this.$newElement=null;this.options=d.extend({},d.fn.selectpicker.defaults,this.$element.data(),"object"==typeof a&&a);null==this.options.title&&(this.options.title=this.$element.attr("title"));this.val=h.prototype.val;this.render=h.prototype.render;this.refresh=h.prototype.refresh;this.selectAll=h.prototype.selectAll;this.deselectAll=h.prototype.deselectAll;this.init()};h.prototype={constructor:h,
init:function(b){this.options.container?this.$element.css("visibility","hidden"):this.$element.hide();this.multiple=this.$element.prop("multiple");b=void 0!==this.$element.attr("class")?this.$element.attr("class").split(/\s+/):"";var a=this.$element.attr("id");this.$element.after(this.createView());this.$newElement=this.$element.next(".bootstrap-select");this.options.container&&this.selectPosition();this.button=this.$newElement.find("> button");if(void 0!==a){var e=this;this.button.attr("data-id",
a);d('label[for="'+a+'"]').click(function(){e.$newElement.find("button[data-id="+a+"]").focus()})}for(var c=0;c<b.length;c++)"selectpicker"!=b[c]&&this.$newElement.addClass(b[c]);this.multiple&&this.$newElement.addClass("show-tick");this.button.addClass(this.options.style);this.checkDisabled();this.checkTabIndex();this.clickListener();this.render();this.setSize()},createDropdown:function(){return d("<div class='btn-group bootstrap-select'><button type='button' class='btn dropdown-toggle' data-toggle='dropdown'><span class='filter-option pull-left'></span>&nbsp;<span class='caret'></span></button><ul class='dropdown-menu' role='menu'></ul></div>")},
createView:function(){var b=this.createDropdown(),a=this.createLi();b.find("ul").append(a);return b},reloadLi:function(){this.destroyLi();var b=this.createLi();this.$newElement.find("ul").append(b)},destroyLi:function(){this.$newElement.find("li").remove()},createLi:function(){var b=this,a=[],e=[],c="";this.$element.find("option").each(function(){a.push(d(this).text())});this.$element.find("option").each(function(a){a=d(this);var c=void 0!==a.attr("class")?a.attr("class"):"",g=a.text(),f=void 0!==
a.data("subtext")?'<small class="muted">'+a.data("subtext")+"</small>":"",m=void 0!==a.data("icon")?'<i class="'+a.data("icon")+'"></i> ':"";if(a.is(":disabled")||a.parent().is(":disabled"))m="<span>"+m+"</span>";g=m+'<span class="text">'+g+f+"</span>";b.options.hideDisabled&&(a.is(":disabled")||a.parent().is(":disabled"))?e.push('<a style="min-height: 0; padding: 0"></a>'):a.parent().is("optgroup")&&!0!=a.data("divider")?0==a.index()?(f=a.parent().attr("label"),m=void 0!==a.parent().data("subtext")?
'<small class="muted">'+a.parent().data("subtext")+"</small>":"",f=(a.parent().data("icon")?'<i class="'+a.parent().data("icon")+'"></i> ':"")+'<span class="text">'+f+m+"</span>",0!=a[0].index?e.push('<div class="div-contain"><div class="divider"></div></div><dt>'+f+"</dt>"+b.createA(g,"opt "+c)):e.push("<dt>"+f+"</dt>"+b.createA(g,"opt "+c))):e.push(b.createA(g,"opt "+c)):!0==a.data("divider")?e.push('<div class="div-contain"><div class="divider"></div></div>'):!0==d(this).data("hidden")?e.push(""):
e.push(b.createA(g,c))});if(0<a.length)for(var f=0;f<a.length;f++)this.$element.find("option").eq(f),c+="<li rel="+f+">"+e[f]+"</li>";!this.multiple&&(0==this.$element.find("option:selected").length&&!b.options.title)&&this.$element.find("option").eq(0).prop("selected",!0).attr("selected","selected");return d(c)},createA:function(b,a){return'<a tabindex="0" class="'+a+'">'+b+'<i class="icon-ok check-mark"></i></a>'},render:function(){var b=this;this.$element.find("option").each(function(a){b.setDisabled(a,
d(this).is(":disabled")||d(this).parent().is(":disabled"));b.setSelected(a,d(this).is(":selected"))});var a=this.$element.find("option:selected").map(function(a,c){var e;e=b.options.showSubtext&&d(this).attr("data-subtext")&&!b.multiple?' <small class="muted">'+d(this).data("subtext")+"</small>":"";return void 0!=d(this).attr("title")?d(this).attr("title"):d(this).text()+e}).toArray(),e=!this.multiple?a[0]:a.join(", ");if(b.multiple&&-1<b.options.selectedTextFormat.indexOf("count")){var c=b.options.selectedTextFormat.split(">"),
f=this.options.hideDisabled?":not([disabled])":"";if(1<c.length&&a.length>c[1]||1==c.length&&2<=a.length)e=a.length+" of "+this.$element.find('option:not([data-divider="true"]):not([data-hidden="true"])'+f).length+" selected"}e||(e=void 0!=b.options.title?b.options.title:b.options.noneSelectedText);a=this.options.showSubtext&&this.$element.find("option:selected").attr("data-subtext")?' <small class="muted">'+this.$element.find("option:selected").data("subtext")+"</small>":"";b.$newElement.find(".filter-option").html(e+
a)},setSize:function(){this.options.container&&this.$newElement.toggle(this.$element.parent().is(":visible"));var b=this,a=this.$newElement.find(".dropdown-menu");a.find("li > a");var e=this.$newElement.addClass("open").find(".dropdown-menu li > a").outerHeight();this.$newElement.removeClass("open");var c=a.find("li .divider").outerHeight(!0),f=this.$newElement.offset().top,n=this.$newElement.outerHeight(),k=parseInt(a.css("padding-top"))+parseInt(a.css("padding-bottom"))+parseInt(a.css("border-top-width"))+
parseInt(a.css("border-bottom-width")),g=this.options.hideDisabled?":not(.disabled)":"",l;"auto"==this.options.size?(c=function(){var c=f-d(window).scrollTop(),g=window.innerHeight,h=k+parseInt(a.css("margin-top"))+parseInt(a.css("margin-bottom"))+2;l=g-c-n-h;b.$newElement.hasClass("dropup")&&(l=c-h);c=3<a.find("li").length+a.find("dt").length?3*e+h-2:0;a.css({"max-height":l+"px","overflow-y":"auto","min-height":c+"px"})},c(),d(window).resize(c),d(window).scroll(c)):this.options.size&&("auto"!=this.options.size&&
a.find("li"+g).length>this.options.size)&&(g=a.find("li"+g+" > *").filter(":not(.div-contain)").slice(0,this.options.size).last().parent().index(),g=a.find("li").slice(0,g+1).find(".div-contain").length,l=e*this.options.size+g*c+k,a.css({"max-height":l+"px","overflow-y":"auto"}));"auto"==this.options.width?(this.$newElement.find(".dropdown-menu").css("min-width","0"),c=this.$newElement.find(".dropdown-menu").css("width"),this.$newElement.css("width",c),this.options.container&&this.$element.css("width",
c)):this.options.width?this.options.container?(this.$element.css("width",this.options.width),this.$newElement.width(this.$element.outerWidth())):this.$newElement.css("width",this.options.width):this.options.container&&this.$newElement.width(this.$element.outerWidth())},selectPosition:function(){var b=d(this.options.container).offset(),a=this.$element.offset();if(b&&a){var e=a.top-b.top,b=a.left-b.left;this.$newElement.appendTo(this.options.container);this.$newElement.css({position:"absolute",top:e+
"px",left:b+"px"})}},refresh:function(){this.reloadLi();this.render();this.setSize();this.checkDisabled();this.options.container&&this.selectPosition()},setSelected:function(b,a){a?this.$newElement.find("li").eq(b).addClass("selected"):this.$newElement.find("li").eq(b).removeClass("selected")},setDisabled:function(b,a){a?this.$newElement.find("li").eq(b).addClass("disabled").find("a").attr("href","#").attr("tabindex",-1):this.$newElement.find("li").eq(b).removeClass("disabled").find("a").removeAttr("href").attr("tabindex",
0)},isDisabled:function(){return this.$element.is(":disabled")||this.$element.attr("readonly")},checkDisabled:function(){this.isDisabled()?(this.button.addClass("disabled"),this.button.click(function(b){b.preventDefault()}),this.button.attr("tabindex","-1")):!this.isDisabled()&&this.button.hasClass("disabled")&&(this.button.removeClass("disabled"),this.button.click(function(){return!0}),this.button.removeAttr("tabindex"))},checkTabIndex:function(){if(this.$element.is("[tabindex]")){var b=this.$element.attr("tabindex");
this.button.attr("tabindex",b)}},clickListener:function(){var b=this;d("body").on("touchstart.dropdown",".dropdown-menu",function(a){a.stopPropagation()});this.$newElement.on("click","li a",function(a){var e=d(this).parent().index(),c=d(this).parent(),f=c.parents(".bootstrap-select"),n=b.$element.val();b.multiple&&a.stopPropagation();a.preventDefault();b.$element.not(":disabled")&&!d(this).parent().hasClass("disabled")&&(b.multiple?b.$element.find("option").eq(e).prop("selected")?b.$element.find("option").eq(e).prop("selected",
!1):b.$element.find("option").eq(e).prop("selected",!0):(b.$element.find("option").prop("selected",!1),b.$element.find("option").eq(e).prop("selected",!0)),f.find(".filter-option").html(c.text()),f.find("button").focus(),n!=b.$element.val()&&b.$element.trigger("change"),b.render())});this.$newElement.on("click","li.disabled a, li dt, li .div-contain",function(a){a.preventDefault();a.stopPropagation();d(this).parent().parents(".bootstrap-select").find("button").focus()});this.$element.on("change",
function(a){b.render()})},val:function(b){return void 0!=b?(this.$element.val(b),this.$element.trigger("change"),this.$element):this.$element.val()},selectAll:function(){this.$element.find("option").prop("selected",!0).attr("selected","selected");this.render()},deselectAll:function(){this.$element.find("option").prop("selected",!1).removeAttr("selected");this.render()},keydown:function(b){var a,e,c,f,n,k,g,h;e=d(this).parent();a=d("[role=menu] li:not(.divider):visible a",e);if(a.length){if(/(38|40)/.test(b.keyCode))c=
a.index(a.filter(":focus")),n=a.parent(":not(.disabled)").first().index(),k=a.parent(":not(.disabled)").last().index(),f=a.eq(c).parent().nextAll(":not(.disabled)").eq(0).index(),g=a.eq(c).parent().prevAll(":not(.disabled)").eq(0).index(),h=a.eq(f).parent().prevAll(":not(.disabled)").eq(0).index(),38==b.keyCode&&(c!=h&&c>g&&(c=g),c<n&&(c=n)),40==b.keyCode&&(c!=h&&c<f&&(c=f),c>k&&(c=k)),a.eq(c).focus();else{var m={48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",
66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"},p=[];a.each(function(){d(this).parent().is(":not(.disabled)")&&d.trim(d(this).text().toLowerCase()).substring(0,1)==m[b.keyCode]&&p.push(d(this).parent().index())});c=d(document).data("keycount");c++;d(document).data("keycount",c);d.trim(d(":focus").text().toLowerCase()).substring(0,
1)!=m[b.keyCode]?(c=1,d(document).data("keycount",c)):c>=p.length&&d(document).data("keycount",0);a.eq(p[c-1]).focus()}/(13)/.test(b.keyCode)&&(d(":focus").click(),e.addClass("open"),d(document).data("keycount",0))}}};d.fn.selectpicker=function(b,a){var e=arguments,c,f=this.each(function(){if(d(this).is("select")){var f=d(this),k=f.data("selectpicker"),g="object"==typeof b&&b;if(k){if(g)for(var l in g)k.options[l]=g[l]}else f.data("selectpicker",k=new h(this,g,a));"string"==typeof b&&(f=b,k[f]instanceof
Function?([].shift.apply(e),c=k[f].apply(k,e)):c=k.options[f])}});return void 0!=c?c:f};d.fn.selectpicker.defaults={style:null,size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",width:null,container:!1,hideDisabled:!1,showSubtext:!1};d(document).data("keycount",0).on("keydown","[data-toggle=dropdown], [role=menu]",h.prototype.keydown)}(window.jQuery);
