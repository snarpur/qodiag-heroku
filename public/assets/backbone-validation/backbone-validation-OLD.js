Backbone.Validation=function(b){var n={forceUpdate:!1,selector:"name",labelFormatter:"sentenceCase",valid:Function.prototype,invalid:Function.prototype},u={formatLabel:function(b,e){return p[n.labelFormatter](b,e)},format:function(){var b=Array.prototype.slice.call(arguments);return b.shift().replace(/\{(\d+)\}/g,function(e,d){return"undefined"!==typeof b[d]?b[d]:e})}},q=function(g,e,d){e=e||{};d=d||"";b.each(g,function(a,b){g.hasOwnProperty(b)&&(a&&"object"===typeof a&&!(a instanceof Date||a instanceof
RegExp||a instanceof Backbone.Model||a instanceof Backbone.Collection)?q(a,e,d+b+"."):e[d+b]=a)});return e},k=function(){var g=function(a){return b.reduce(b.keys(a.validation||{}),function(a,c){a[c]=void 0;return a},{})},e=function(a,c){var f=a.validation?a.validation[c]||{}:{};if(b.isFunction(f)||b.isString(f))f={fn:f};b.isArray(f)||(f=[f]);return b.reduce(f,function(a,c){b.each(b.without(b.keys(c),"msg"),function(b){a.push({fn:s[b],val:c[b],msg:c.msg})});return a},[])},d=function(a,c,f,l){return b.reduce(e(a,
c),function(e,d){var g=b.extend({},u,s),g=d.fn.call(g,f,c,d.val,a,l);return!1===g||!1===e?!1:g&&!e?d.msg||g:e},"")},a=function(a,c){var f,l={},e=!0,g=b.clone(c),h=q(c);b.each(h,function(c,b){if(f=d(a,b,c,g))l[b]=f,e=!1});return{invalidAttrs:l,isValid:e}},f=function(c,f){return{preValidate:function(a,c){return d(this,a,c,b.extend({},this.attributes))},isValid:function(a){var c=q(this.attributes);if(b.isString(a))return!d(this,a,c[a],b.extend({},this.attributes));if(b.isArray(a))return b.reduce(a,function(a,
f){return a&&!d(this,f,c[f],b.extend({},this.attributes))},!0,this);!0===a&&this.validate();return this.validation?this._isValid:!0},validate:function(l,e){var d=this,h=!l,k=b.extend({},f,e),r=g(d),n=b.extend({},r,d.attributes,l),p=q(l||n),m=a(d,n);d._isValid=m.isValid;b.each(r,function(a,b){m.invalidAttrs.hasOwnProperty(b)||k.valid(c,b,k.selector)});b.each(r,function(a,b){var f=m.invalidAttrs.hasOwnProperty(b),d=p.hasOwnProperty(b);f&&(d||h)&&k.invalid(c,b,m.invalidAttrs[b],k.selector)});b.defer(function(){d.trigger("validated",
d._isValid,d,m.invalidAttrs);d.trigger("validated:"+(d._isValid?"valid":"invalid"),d,m.invalidAttrs)});if(!k.forceUpdate&&0<b.intersection(b.keys(m.invalidAttrs),b.keys(p)).length)return m.invalidAttrs}}},c=function(a){delete a.validate;delete a.preValidate;delete a.isValid},l=function(a){b.extend(a,f(this.view,this.options))},h=function(a){c(a)};return{version:"0.8.0",configure:function(a){b.extend(n,a)},bind:function(a,c){var d=a.model,e=a.collection;c=b.extend({},n,v,c);if("undefined"===typeof d&&
"undefined"===typeof e)throw"Before you execute the binding your view must have a model or a collection.\nSee http://thedersen.com/projects/backbone-validation/#using-form-model-validation for more information.";d?b.extend(d,f(a,c)):e&&(e.each(function(d){b.extend(d,f(a,c))}),e.bind("add",l,{view:a,options:c}),e.bind("remove",h))},unbind:function(a){var b=a.collection;a.model&&c(a.model);b&&(b.each(function(a){c(a)}),b.unbind("add",l),b.unbind("remove",h))},mixin:f(null,n)}}(),v=k.callbacks={valid:function(b,
e,d){b.$("["+d+'~="'+e+'"]').removeClass("invalid").removeAttr("data-error")},invalid:function(b,e,d,a){b.$("["+a+'~="'+e+'"]').addClass("invalid").attr("data-error",d)}},t=k.patterns={digits:/^\d+$/,number:/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/,email:/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i,
url:/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},
h=k.messages={required:"{0} is required",acceptance:"{0} must be accepted",min:"{0} must be greater than or equal to {1}",max:"{0} must be less than or equal to {1}",range:"{0} must be between {1} and {2}",length:"{0} must be {1} characters",minLength:"{0} must be at least {1} characters",maxLength:"{0} must be at most {1} characters",rangeLength:"{0} must be between {1} and {2} characters",oneOf:"{0} must be one of: {1}",equalTo:"{0} must be the same as {1}",pattern:"{0} must be a valid {1}"},p=
k.labelFormatters={none:function(b){return b},sentenceCase:function(b){return b.replace(/(?:^\w|[A-Z]|\b\w)/g,function(b,d){return 0===d?b.toUpperCase():" "+b.toLowerCase()}).replace("_"," ")},label:function(b,e){return e.labels&&e.labels[b]||p.sentenceCase(b,e)}},s=k.validators=function(){var g=String.prototype.trim?function(a){return null===a?"":String.prototype.trim.call(a)}:function(a){var b=/^\s+/,c=/\s+$/;return null===a?"":a.toString().replace(b,"").replace(c,"")},e=function(a){return b.isNumber(a)||
b.isString(a)&&a.match(t.number)},d=function(a){return!(b.isNull(a)||b.isUndefined(a)||b.isString(a)&&""===g(a))};return{fn:function(a,f,c,d,e){b.isString(c)&&(c=d[c]);return c.call(d,a,f,e)},required:function(a,f,c,e,g){c=b.isFunction(c)?c.call(e,a,f,g):c;if(!c&&!d(a))return!1;if(c&&!d(a))return this.format(h.required,this.formatLabel(f,e))},acceptance:function(a,d,c,e){if("true"!==a&&(!b.isBoolean(a)||!1===a))return this.format(h.acceptance,this.formatLabel(d,e))},min:function(a,b,c,d){if(!e(a)||
a<c)return this.format(h.min,this.formatLabel(b,d),c)},max:function(a,b,c,d){if(!e(a)||a>c)return this.format(h.max,this.formatLabel(b,d),c)},range:function(a,b,c,d){if(!e(a)||a<c[0]||a>c[1])return this.format(h.range,this.formatLabel(b,d),c[0],c[1])},length:function(a,b,c,e){if(!d(a)||g(a).length!==c)return this.format(h.length,this.formatLabel(b,e),c)},minLength:function(a,b,c,e){if(!d(a)||g(a).length<c)return this.format(h.minLength,this.formatLabel(b,e),c)},maxLength:function(a,b,c,e){if(!d(a)||
g(a).length>c)return this.format(h.maxLength,this.formatLabel(b,e),c)},rangeLength:function(a,b,c,e){if(!d(a)||g(a).length<c[0]||g(a).length>c[1])return this.format(h.rangeLength,this.formatLabel(b,e),c[0],c[1])},oneOf:function(a,d,c,e){if(!b.include(c,a))return this.format(h.oneOf,this.formatLabel(d,e),c.join(", "))},equalTo:function(a,b,c,d,e){if(a!==e[c])return this.format(h.equalTo,this.formatLabel(b,d),this.formatLabel(c,d))},pattern:function(a,b,c,e){if(!d(a)||!a.toString().match(t[c]||c))return this.format(h.pattern,
this.formatLabel(b,e),c)}}}();return k}(_);
