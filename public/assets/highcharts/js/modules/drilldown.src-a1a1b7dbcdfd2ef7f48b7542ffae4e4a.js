(function(g){function v(a,b,d){return"rgba("+[Math.round(a[0]+(b[0]-a[0])*d),Math.round(a[1]+(b[1]-a[1])*d),Math.round(a[2]+(b[2]-a[2])*d),a[3]+(b[3]-a[3])*d].join()+")"}var w=function(){},r=g.getOptions(),k=g.each,s=g.extend,A=g.format,t=g.wrap,n=g.Chart,q=g.seriesTypes,x=q.pie,p=q.column,y=HighchartsAdapter.fireEvent,B=HighchartsAdapter.inArray;s(r.lang,{drillUpText:"\u25c1 Back to {series.name}"});r.drilldown={activeAxisLabelStyle:{cursor:"pointer",color:"#0d233a",fontWeight:"bold",textDecoration:"underline"},
activeDataLabelStyle:{cursor:"pointer",color:"#0d233a",fontWeight:"bold",textDecoration:"underline"},animation:{duration:500},drillUpButton:{position:{align:"right",x:-10,y:10}}};g.SVGRenderer.prototype.Element.prototype.fadeIn=function(a){this.attr({opacity:0.1,visibility:"inherit"}).animate({opacity:1},a||{duration:250})};n.prototype.addSeriesAsDrilldown=function(a,b){this.addSingleSeriesAsDrilldown(a,b);this.applyDrilldown()};n.prototype.addSingleSeriesAsDrilldown=function(a,b){var d=a.series,
c=d.xAxis,f=d.yAxis,h;h=a.color||d.color;var e,z=[],g=[],m;m=d.levelNumber||0;b=s({color:h},b);e=B(a,d.points);k(d.chart.series,function(a){a.xAxis===c&&(z.push(a),g.push(a.userOptions),a.levelNumber=a.levelNumber||0)});h={levelNumber:m,seriesOptions:d.userOptions,levelSeriesOptions:g,levelSeries:z,shapeArgs:a.shapeArgs,bBox:a.graphic.getBBox(),color:h,lowerSeriesOptions:b,pointOptions:d.options.data[e],pointIndex:e,oldExtremes:{xMin:c&&c.userMin,xMax:c&&c.userMax,yMin:f&&f.userMin,yMax:f&&f.userMax}};
this.drilldownLevels||(this.drilldownLevels=[]);this.drilldownLevels.push(h);h=h.lowerSeries=this.addSeries(b,!1);h.levelNumber=m+1;c&&(c.oldPos=c.pos,c.userMin=c.userMax=null,f.userMin=f.userMax=null);d.type===h.type&&(h.animate=h.animateDrilldown||w,h.options.animation=!0)};n.prototype.applyDrilldown=function(){var a=this.drilldownLevels,b=a[a.length-1].levelNumber;k(this.drilldownLevels,function(a){a.levelNumber===b&&k(a.levelSeries,function(a){a.levelNumber===b&&a.remove(!1)})});this.redraw();
this.showDrillUpButton()};n.prototype.getDrilldownBackText=function(){var a=this.drilldownLevels[this.drilldownLevels.length-1];a.series=a.seriesOptions;return A(this.options.lang.drillUpText,a)};n.prototype.showDrillUpButton=function(){var a=this,b=this.getDrilldownBackText(),d=a.options.drilldown.drillUpButton,c,f;this.drillUpButton?this.drillUpButton.attr({text:b}).align():(f=(c=d.theme)&&c.states,this.drillUpButton=this.renderer.button(b,null,null,function(){a.drillUp()},c,f&&f.hover,f&&f.select).attr({align:d.position.align,
zIndex:9}).add().align(d.position,!1,d.relativeTo||"plotBox"))};n.prototype.drillUp=function(){for(var a=this,b=a.drilldownLevels,d=b[b.length-1].levelNumber,c=b.length,f=a.series,h=f.length,e,g,l,m,n=function(b){var c;k(f,function(a){a.userOptions===b&&(c=a)});c=c||a.addSeries(b,!1);c.type===g.type&&c.animateDrillupTo&&(c.animate=c.animateDrillupTo);b===e.seriesOptions&&(l=c)};c--;)if(e=b[c],e.levelNumber===d){b.pop();g=e.lowerSeries;if(!g.chart)for(;h--;)if(f[h].options.id===e.lowerSeriesOptions.id){g=
f[h];break}g.xData=[];k(e.levelSeriesOptions,n);y(a,"drillup",{seriesOptions:e.seriesOptions});l.type===g.type&&(l.drilldownLevel=e,l.options.animation=a.options.drilldown.animation,g.animateDrillupFrom&&g.animateDrillupFrom(e));l.levelNumber=d;g.remove(!1);l.xAxis&&(m=e.oldExtremes,l.xAxis.setExtremes(m.xMin,m.xMax,!1),l.yAxis.setExtremes(m.yMin,m.yMax,!1))}this.redraw();0===this.drilldownLevels.length?this.drillUpButton=this.drillUpButton.destroy():this.drillUpButton.attr({text:this.getDrilldownBackText()}).align()};
p.prototype.supportsDrilldown=!0;p.prototype.animateDrillupTo=function(a){if(!a){var b=this,d=b.drilldownLevel;k(this.points,function(a){a.graphic.hide();a.dataLabel&&a.dataLabel.hide();a.connector&&a.connector.hide()});setTimeout(function(){k(b.points,function(a,b){var h=b===(d&&d.pointIndex)?"show":"fadeIn",e="show"===h?!0:void 0;a.graphic[h](e);if(a.dataLabel)a.dataLabel[h](e);if(a.connector)a.connector[h](e)})},Math.max(this.chart.options.drilldown.animation.duration-50,0));this.animate=w}};p.prototype.animateDrilldown=
function(a){var b=this,d=this.chart.drilldownLevels,c=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1].shapeArgs,f=this.chart.options.drilldown.animation;a||(k(d,function(a){b.userOptions===a.lowerSeriesOptions&&(c=a.shapeArgs)}),c.x+=this.xAxis.oldPos-this.xAxis.pos,k(this.points,function(a){a.graphic&&a.graphic.attr(c).animate(a.shapeArgs,f);a.dataLabel&&a.dataLabel.fadeIn(f)}),this.animate=null)};p.prototype.animateDrillupFrom=function(a){var b=this.chart.options.drilldown.animation,
d=this.group,c=this;k(c.trackerGroups,function(a){if(c[a])c[a].on("mouseover")});delete this.group;k(this.points,function(c){var h=c.graphic,e=g.Color(c.color).rgba,k=g.Color(a.color).rgba,l=function(){h.destroy();d&&(d=d.destroy())};h&&(delete c.graphic,b?h.animate(a.shapeArgs,g.merge(b,{step:function(a,b){"start"===b.prop&&(4===e.length&&4===k.length)&&this.attr({fill:v(e,k,b.pos)})},complete:l})):(h.attr(a.shapeArgs),l()))})};x&&s(x.prototype,{supportsDrilldown:!0,animateDrillupTo:p.prototype.animateDrillupTo,
animateDrillupFrom:p.prototype.animateDrillupFrom,animateDrilldown:function(a){var b=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],d=this.chart.options.drilldown.animation,c=b.shapeArgs,f=c.start,h=(c.end-f)/this.points.length,e=g.Color(b.color).rgba;a||(k(this.points,function(a,b){var k=g.Color(a.color).rgba;a.graphic.attr(g.merge(c,{start:f+b*h,end:f+(b+1)*h}))[d?"animate":"attr"](a.shapeArgs,g.merge(d,{step:function(a,b){"start"===b.prop&&(4===e.length&&4===k.length)&&this.attr({fill:v(e,
k,b.pos)})}}))}),this.animate=null)}});g.Point.prototype.doDrilldown=function(a){for(var b=this.series.chart,d=b.options.drilldown,c=(d.series||[]).length,f;c--&&!f;)d.series[c].id===this.drilldown&&(f=d.series[c]);y(b,"drilldown",{point:this,seriesOptions:f});f&&(a?b.addSingleSeriesAsDrilldown(this,f):b.addSeriesAsDrilldown(this,f))};t(g.Point.prototype,"init",function(a,b,d,c){var f=a.call(this,b,d,c),h=b.chart,e=(a=b.xAxis&&b.xAxis.ticks[c])&&a.label;f.drilldown?(g.addEvent(f,"click",function(){f.doDrilldown()}),
e&&(e._basicStyle||(e._basicStyle=e.element.getAttribute("style")),e.addClass("highcharts-drilldown-axis-label").css(h.options.drilldown.activeAxisLabelStyle).on("click",function(){k(e.ddPoints,function(a){a.doDrilldown&&a.doDrilldown(!0)});h.applyDrilldown()}),e.ddPoints||(e.ddPoints=[]),e.ddPoints.push(f))):e&&e._basicStyle&&e.element.setAttribute("style",e._basicStyle);return f});t(g.Series.prototype,"drawDataLabels",function(a){var b=this.chart.options.drilldown.activeDataLabelStyle;a.call(this);
k(this.points,function(a){if(a.drilldown&&a.dataLabel)a.dataLabel.attr({"class":"highcharts-drilldown-data-label"}).css(b).on("click",function(){a.doDrilldown()})})});var u,r=function(a){a.call(this);k(this.points,function(a){a.drilldown&&a.graphic&&a.graphic.attr({"class":"highcharts-drilldown-point"}).css({cursor:"pointer"})})};for(u in q)q[u].prototype.supportsDrilldown&&t(q[u].prototype,"drawTracker",r)})(Highcharts);
