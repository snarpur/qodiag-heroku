(function(){var h={}.hasOwnProperty,k=function(c,d){function g(){this.constructor=c}for(var e in d)h.call(d,e)&&(c[e]=d[e]);g.prototype=d.prototype;c.prototype=new g;c.__super__=d.prototype;return c};this.Qapp.module("EntryFieldsSidebarApp.List",function(c,d,g,e,h,l){return c.Controller=function(e){function b(){return b.__super__.constructor.apply(this,arguments)}k(b,e);b.prototype.list=function(a){this.region=a.region;this.region.show(this.getLayout());return this.showEntryFields(a)};b.prototype.showEntryFields=
function(a){var f,c,b;f=a.droppableCollection;c=a.droppableElement;b=d.request("entry:fields:entities");this.listenTo(f,"change:current:dropzone",function(a){return function(a){return b.droppableElement=a}}(this));return d.execute("when:fetched",b,function(a){return function(){var d;d=b.createSearchCollection(l.result(f,"entryFieldIds"));b.droppableElement=c;a.listenTo(f,"remove:fields",function(a){return d.add(a.model.get("entry_field"))});a.showEntryFieldsView({collection:d,droppableCollection:f});
return a.showSearchField(b)}}(this))};b.prototype.getEntryFieldsView=function(a){return new c.EntryFields({collection:a.collection})};b.prototype.showEntryFieldsView=function(a){var b,c;c=a.droppableCollection;b=a.collection;a=this.getEntryFieldsView(a);this.listenTo(a,"childview:drag:stopped",function(a){return function(a){if(c.hasFieldWithId(a.model.id))return b.remove(a.model)}}(this));return this.layout.listRegion.show(a)};b.prototype.showSearchField=function(a){return this.layout.searchRegion.show(this.getSearchFieldView(a))};
b.prototype.getSearchFieldView=function(a){var b;b=new g.Model({search:""});b.on("change:search",function(){return a.trigger("search:update",this.get("search"))});return new c.Search({model:b})};b.prototype.getLayout=function(){return null!=this.layout?this.layout:this.layout=new c.Layout};return b}(d.Controllers.Base)})}).call(this);
