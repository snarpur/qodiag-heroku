(function(){var __bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key)){child[key]=parent[key]}}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child};this.Qapp.module("EntryFieldsApp.List",function(List,App,Backbone,Marionette,$,_){var _ref;return List.Controller=(function(_super){__extends(Controller,_super);function Controller(){this.getLayout=__bind(this.getLayout,this);_ref=Controller.__super__.constructor.apply(this,arguments);return _ref}Controller.prototype.list=function(options){App.contentRegion.show(this.getLayout());this.executeSettingsNavigation();return this.showEntryFields()};Controller.prototype.executeSettingsNavigation=function(){return App.execute("show:settings:navigation",{currentSetting:"entry_fields",region:this.getLayout().settingsNavigationRegion})};Controller.prototype.showEntryFields=function(options){var fields,_this=this;fields=App.request("entry:fields:entities");return App.execute("when:fetched",fields,function(){var searchCollection;searchCollection=fields.createSearchCollection();return _this.showEntryFieldsView(searchCollection,fields)})};Controller.prototype.getEntryFieldsView=function(collection){return new List.EntryFields({collection:collection})};Controller.prototype.showEntryFieldsView=function(collection,fields){var view,_this=this;view=this.getEntryFieldsView(collection);this.getLayout().listRegion.on("show",function(){_this.showSearchField(fields);return _this.listenTo(collection,"add",function(model,collection){return toastr.success("Spurningu bætt við",model.get("title"))})});this.show(view,{region:this.getLayout().listRegion,loading:true});this.listenTo(view,"create:field:clicked",function(view){return App.execute("create:entry:field",{collection:view.collection})});this.listenTo(view,"childview:edit:clicked",function(view){return App.execute("edit:entry:field",{model:view.model})});return this.listenTo(view,"childview:destroy:clicked",function(view){return bootbox.confirm("Ertu viss um að þú viljir eyða þessari spurningu",function(result){if(result){return view.model.destroy()}})})};Controller.prototype.showSearchField=function(collection){return this.show(this.getSearchFieldView(collection),{region:this.layout.searchRegion,loading:false})};Controller.prototype.getSearchFieldView=function(collection){var search;search=new Backbone.Model({search:""});search.on("change:search",function(model,searchString){return collection.trigger("search:update",this.get("search"))});return new List.Search({model:search})};Controller.prototype.getLayout=function(){var _ref1;return(_ref1=this.layout)!=null?_ref1:this.layout=new List.Layout};return Controller})(App.Controllers.Base)})}).call(this);