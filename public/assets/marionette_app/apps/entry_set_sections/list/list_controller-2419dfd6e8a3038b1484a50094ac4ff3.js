(function(){var k={}.hasOwnProperty,l=function(d,c){function h(){this.constructor=d}for(var f in c)k.call(c,f)&&(d[f]=c[f]);h.prototype=c.prototype;d.prototype=new h;d.__super__=c.prototype;return d};this.Qapp.module("EntrySetSectionsApp.List",function(d,c,h,f,k,g){return d.Controller=function(f){function a(){return a.__super__.constructor.apply(this,arguments)}l(a,f);a.prototype.list=function(b){return this.getEntrySet(b)};a.prototype.showSidebarOnce=function(){return this.getEntryFieldsRegion().on("show",
function(b){return function(e){return b.executeSidebar({droppableCollection:e.model.collection,droppableElement:e.$itemViewContainer})}}(this))};a.prototype.getEntrySet=function(b){var e;e=c.request("entry:set:entity",{id:b.entrySetId});return c.execute("when:fetched",e,function(a){return function(){c.contentRegion.show(a.getLayout(e));window.sectionregion=a.getSectionContentRegion();a.showSidebarOnce();a.showEntrySetTitle(e);a.executeSettingsNavigation();return a.getSections(g.extend(b,{entrySet:e}))}}(this))};
a.prototype.getSections=function(b){var a;a=c.request("entry:set:sections:entities",b);return c.execute("when:fetched",a,function(c){return function(){a.getCurrentSection();c.showSectionsNavigation(a,b.entrySet);if(0!==a.length)return c.executeFields({model:a.getCurrentSection()})}}(this))};a.prototype.executeFields=function(b){c.execute("show:settings:section:fields",g.extend(b,{region:this.getSectionContentRegion(),loaderRegion:this.getEntryFieldsRegion()}));return this.showTitle(b.model)};a.prototype.executeSidebar=
function(b){return c.execute("show:settings:sidebar:fields",g.extend(b,{region:this.getSidebarRegion()}))};a.prototype.showSectionsNavigation=function(b,a){var d;d=this.getNavigationView(b);this.show(d,{region:this.getNavigationRegion(),loading:!1});this.listenTo(b,"change:current:section",function(a){return function(b){a.executeFields(b);return c.navigate(a.sectionUrl(b.model),{replace:!0})}}(this));return this.listenTo(d,"add:new:section:clicked",function(b){return function(d){return c.execute("create:section",
{entrySet:a,section:d.collection.newSection(),collection:d.collection,activeView:b.getLayout()})}}(this))};a.prototype.showTitle=function(b){b=new d.Title({model:b});this.show(b,{region:this.getLayout().sectionTitleRegion,loading:{loadingType:"opacity"}});return this.listenTo(b,"edit:title",function(b){return function(a){return c.execute("edit:section",{section:a.model,activeView:b.getLayout()})}}(this))};a.prototype.showEntrySetTitle=function(b){var a;a=new d.Title({model:b});this.show(a,{region:this.getLayout().entrySetTitleRegion,
loading:!1});this.listenTo(a,"edit:title",function(d){return function(d){return c.execute("edit:entry:set",{model:b,activeView:a})}}(this));return this.listenTo(a,"remove:title",function(a){return function(a){return c.execute("remove:entry_set",{model:b})}}(this))};a.prototype.executeSettingsNavigation=function(){return c.execute("show:settings:navigation",{iconClass:"fa fa-cogs",i18n:"terms.setup"})};a.prototype.getNavigationView=function(a){return new d.SectionsNav({collection:a,model:a.getCurrentSection()})};
a.prototype.getNavigationRegion=function(){return this.getLayout().navigationRegion};a.prototype.getSectionContentRegion=function(){return this.getLayout().sectionContentRegion};a.prototype.getSidebarRegion=function(){return this.getLayout().entryFieldsSidebarRegion};a.prototype.getEntryFieldsRegion=function(){return this.getLayout().entryFieldsRegion};a.prototype.getLayout=function(a){return null!=this.layout?this.layout:this.layout=new d.Layout({model:a})};a.prototype.sectionUrl=function(a){a=g.values(a.pick("entry_set_id",
"id"));return"settings"+Routes.entry_set_section_path.apply(Routes,a)};return a}(c.Controllers.Base)})}).call(this);
