(function(){var f={}.hasOwnProperty,d=function(b,c){function d(){this.constructor=b}for(var e in c)f.call(c,e)&&(b[e]=c[e]);d.prototype=c.prototype;b.prototype=new d;b.__super__=c.prototype;return b},g=function(b,c){return function(){return b.apply(c,arguments)}};this.Qapp.module("EntrySetResponsesApp.Edit",function(b,c,f,e,k,h){b.Layout=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,b);a.prototype.template="entry_set_responses/edit/templates/layout";a.prototype.regions=
{formStepsRegion:"#form-steps-region",formWrapperRegion:"#form-wrapper-region"};return a}(c.Views.Layout);b.FormStep=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,b);a.prototype.template="entry_set_responses/edit/templates/_form_step";a.prototype.tagName="li";a.prototype.triggers={click:"set:current:section"};a.prototype.onSetCurrentSection=function(){return this.model.trigger("change:current:section",{model:this.model})};a.prototype.className=function(){if(this.model.isCurrentSection())return"active"};
return a}(c.Views.ItemView);b.EmptyStep=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,b);a.prototype.template="entry_set_responses/edit/templates/_empty_step";a.prototype.tagName="li";return a}(c.Views.ItemView);b.FormSteps=function(c){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,c);a.prototype.itemView=b.FormStep;a.prototype.emptyView=b.EmptyStep;a.prototype.className="nav nav-tabs";a.prototype.tagName="ul";a.prototype.collectionEvents=
{"change:current:section":function(){return this.render()}};return a}(c.Views.CollectionView);b.EntryFieldText=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,b);a.prototype.template="entry_set_responses/edit/templates/_text_entry_field";a.prototype.className="form-group";a.prototype.onShow=function(a){this.bindings={};this.bindings["#text_value_"+this.model.get("id")]={observe:"entry_values",onGet:function(a,b){return this.model.get("entry_values").first().get("text_value")},
onSet:function(a,b){this.model.get("entry_values").first().set("text_value",a,{silent:!0});return this.model.get("entry_values")}};return this.stickit()};return a}(c.Views.ItemView);b.EntryFieldString=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,b);a.prototype.template="entry_set_responses/edit/templates/_string_entry_field";a.prototype.className="form-group";a.prototype.onShow=function(a){this.bindings={};this.bindings["#string_value_"+this.model.get("id")]={observe:"entry_values",
onGet:function(a,b){return this.model.get("entry_values").first().get("string_value")},onSet:function(a,b){this.model.get("entry_values").first().set("string_value",a,{silent:!0});return this.model.get("entry_values")}};return this.stickit()};return a}(c.Views.ItemView);b.EntryFieldMultiChoice=function(c){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,c);a.prototype.template="entry_set_responses/edit/templates/_multi_choice_entry_field";a.prototype.className="form-group";a.prototype.onBeforeRender=
function(){return this.addRegion("optionsRegion","#field-options-"+this.model.get("id"))};a.prototype.onShow=function(){return this.optionsRegion.show(this.getFieldOptionsView())};a.prototype.getFieldOptionsView=function(){return null!=this.fieldOptionsView?this.fieldOptionsView:this.fieldOptionsView=new b.FieldOptions({collection:this.model.get("entry_field_options"),selectedIds:this.model.get("entry_values").pluck("entry_field_option_id")})};return a}(c.Views.Layout);b.EntryFieldSingleChoice=function(b){function a(){this.radioClicked=
g(this.radioClicked,this);return a.__super__.constructor.apply(this,arguments)}d(a,b);a.prototype.template="entry_set_responses/edit/templates/_single_choice_entry_field";a.prototype.className="form-group";a.prototype.events={"click input[type=radio]":"radioClicked"};a.prototype.onShow=function(a){this.bindings={};this.bindings["[name=entry_field_"+this.model.get("id")+"]"]={observe:"entry_values",onGet:function(a,b){var c,d;return Number(null!=(c=this.model.get("entry_values"))?null!=(d=c.first())?
d.get("entry_field_option_id"):void 0:void 0)},onSet:function(a,b){null!=this.model.get("entry_values")&&this.model.get("entry_values").first().set("entry_field_option_id",Number(a),{silent:!0});return this.model.get("entry_values")}};return this.stickit()};a.prototype.radioClicked=function(a){var b;b=c.request("get:current:user");return this.model.trigger("option:selected",this.model,{person_id:b.get("person_id"),entry_field_option_id:a.currentTarget.value,entry_field_id:this.model.get("id")})};
return a}(c.Views.ItemView);b.EntryFields=function(c){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,c);a.prototype.template="entry_set_responses/edit/templates/entry_fields";a.prototype.childViewMap={text:b.EntryFieldText,string:b.EntryFieldString,"multi-choice":b.EntryFieldMultiChoice,"single-choice":b.EntryFieldSingleChoice};a.prototype.getItemView=function(a){if(null!=a)return this.childViewMap[a.get("field_type")]};return a}(c.Views.CompositeView);b.FieldOption=function(b){function a(){this.templateHelpers=
g(this.templateHelpers,this);return a.__super__.constructor.apply(this,arguments)}d(a,b);a.prototype.template="entry_set_responses/edit/templates/_field_option";a.prototype.tagName="div";a.prototype.className="checkbox";a.prototype.templateHelpers=function(){return{isChecked:function(a){return function(){return h.contains(a.options.selectedIds,a.model.id)?"checked='checked'":!1}}(this)}};a.prototype.events={"click input[type=checkbox]":"fieldOptionClicked"};a.prototype.fieldOptionClicked=function(a){var b;
a=a.currentTarget.checked?"add":"remove";b=c.request("get:current:user");return this.model.collection.trigger("options:"+a,this.model,{person_id:b.get("person_id"),entry_field_option_id:this.model.id,entry_field_id:this.model.get("entry_field_id")})};return a}(c.Views.ItemView);return b.FieldOptions=function(c){function a(){return a.__super__.constructor.apply(this,arguments)}d(a,c);a.prototype.itemView=b.FieldOption;a.prototype.itemViewOptions=function(){return h.pick(this.options,"selectedIds")};
return a}(c.Views.CollectionView)})}).call(this);
