(function(){var k={}.hasOwnProperty,c=function(b,c){function d(){this.constructor=b}for(var f in c)k.call(c,f)&&(b[f]=c[f]);d.prototype=c.prototype;b.prototype=new d;b.__super__=c.prototype;return b};this.Qapp.module("Entities",function(b,k,d,f,l,e){b.Field=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);a.prototype.initialize=function(){this.setErrors();this.addErrorListeners();this.addValidateListeners();this.setFieldValue();this.addFieldValueListeners();return a.__super__.initialize.apply(this,
arguments)};a.prototype.setErrors=function(){return this.set("_errors",this.get("formModel").get("_errors"))};a.prototype.addErrorListeners=function(){return this.listenTo(this.get("formModel"),"change:_errors",function(a){return function(b,g){return a.set("_errors",g)}}(this))};a.prototype.addValidateListeners=function(){return this.listenToOnce(this.get("formModel"),"validated",function(a){return function(){return a.on("change:fieldValue",function(){return a.get("formModel").validate(a.get("fieldName"))})}}(this))};
a.prototype.setFieldValue=function(){return this.set("fieldValue",this.get("formModel").get(this.get("fieldName")))};a.prototype.addFieldValueListeners=function(){this.on("change:fieldValue",function(a){return function(){return a.get("formModel").set(a.get("fieldName"),a.get("fieldValue"),{changed:a.get("fieldName")})}}(this));return this.listenTo(this.get("formModel"),"change:"+this.get("fieldName"),function(a){return function(b,g){return a.set("fieldValue",a.get("formModel").get(a.get("fieldName")))}}(this))};
return a}(d.Model);b.Field.Separator=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);return a}(d.Model);b.Field.Title=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);return a}(d.Model);b.Field.Hidden=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);return a}(d.Model);b.Field.Date=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);return a}(b.Field);b.Field.Select=
function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);a.prototype.initialize=function(){var h;h="_"+this.get("fieldName")+"_options";this.setOptions(h);this.addOptionsListeners(h);return a.__super__.initialize.apply(this,arguments)};a.prototype.setOptions=function(a){a=null!=this.get("formModel").get(a)?this.get("formModel").get(a):this.get("options");a instanceof d.Collection||(a=new d.Collection(a));return this.set("options",a)};a.prototype.addOptionsListeners=function(a){return this.listenTo(this.get("formModel"),
"change:"+a,function(b){return function(c,g){return b.set("options",b.get("formModel").get(a))}}(this))};a.prototype.addFieldValueListeners=function(){this.on("change:fieldValue",function(a){return function(b,c,g){b=a.get("options").findWhere({id:Number(c)});return a.get("formModel").set(a.get("fieldName"),a.get("fieldValue"),{modelSelected:b})}}(this));return this.listenTo(this.get("formModel"),"change:"+this.get("fieldName"),function(a){return function(b,c){return a.set("fieldValue",a.get("formModel").get(a.get("fieldName")))}}(this))};
return a}(b.Field);b.Field.Text=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);return a}(b.Field);b.Field.TextArea=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);return a}(b.Field);b.Field.CheckBox=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);a.prototype.initialize=function(){var b;b="_"+this.get("fieldName")+"_options";this.setOptions(b);this.addOptionsListeners(b);return a.__super__.initialize.apply(this,
arguments)};a.prototype.setOptions=function(a){a=null!=this.get("formModel").get(a)?this.get("formModel").get(a):null!=this.get("options")?this.get("options"):this.get("formModel");a instanceof d.Collection||(a=new d.Collection(a));return this.set("options",a)};a.prototype.addOptionsListeners=function(a){return this.listenTo(this.get("formModel"),"change:"+a,function(b){return function(c,d){return b.set("options",b.get("formModel").get(a))}}(this))};return a}(b.Field);b.Field.Radio=function(b){function a(){return a.__super__.constructor.apply(this,
arguments)}c(a,b);return a}(b.Field.Select);b.Field.Controller=function(b){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,b);return a}(d.Model);b.FieldCollection=function(d){function a(){return a.__super__.constructor.apply(this,arguments)}c(a,d);a.prototype.model=function(a,c){var d;if(null!=a.fieldType)return d=""+e.camelize(e.capitalize(a.fieldType)),new b.Field[d](a,c)};a.prototype.initialize=function(a,b){this.rootModel=b.rootModel;this.controllerModel=b.controllerModel;
return e.each(a,function(a){return function(b){var c,d;null!=b.modelName?"controller"===b.modelName?b.formModel=a.controllerModel:e.isString(b.modelName)&&(d=b.modelName.split("."),c=a.rootModel,e.each(d,function(a){return c=c.get(a)}),b.formModel=c):b.formModel=a.rootModel;if(null!=b.validations)return e.each(b.validations,function(a){return b.formModel.validation[""+b.fieldName]=a})}}(this))};return a}(d.Collection);return b.FormModel=function(){return function(){}}()})}).call(this);
