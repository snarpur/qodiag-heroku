(function(){(function(f){var e,d,g;g=f.sync;f.sync=function(a,b,c){null==c&&(c={});_.defaults(c,{type:d.methodMap[a],dataType:"json",beforeSend:_.bind(e.beforeSend,b),complete:_.bind(e.complete,b)});d.jsonData(a,b,c);d.ignoreProcessOnNonGet(a,b,c);d.setUrl(b,c);c=g(a,b,c);if(!b._fetch&&"read"===a)return b._fetch=c};e={beforeSend:function(a,b){var c;b.noCSRF||(c=$('meta[name="csrf-token"]').attr("content"))&&a.setRequestHeader("X-CSRF-Token",c);return this.trigger("sync:start",this)},complete:function(){return this.trigger("sync:stop",
this)}};return d={methodMap:{create:"POST",update:"PUT","delete":"DELETE",read:"GET"},jsonData:function(a,b,c){if(!c.data&&b&&("create"===a||"update"===a))return c.contentType="application/json",a={},b.paramRoot?a[b.paramRoot]=b.toJSON():a=b.toJSON(),c.data=JSON.stringify(a)},ignoreProcessOnNonGet:function(a,b,c){if("GET"!==c.type)return c.processData=!1},setUrl:function(a,b){if(!b.url)return b.url=this.getUrl(a)||this.urlError()},getUrl:function(a){return!a||!a.url?null:_.isFunction(a.url)?a.url():
a.url},urlError:function(){throw Error(I18n.t("marionette.errors.url_not_found"));}}})(Backbone)}).call(this);
