(function(a){a.fn.tableSort=function(q){var e=a.extend({animation:"slide",rowspan:!1,sortAs:{},speed:300,distance:"300px",delay:1},q);return this.each(function(){function q(){a(b).find("tr").each(function(c){0<c&&a(this).addClass("tsort_id-"+(c-1));a(this).find("td").each(function(b){a(this).is(":first-child")&&(h.push({}),h[h.length-1].id=c-1,h[h.length-1].td=[],h[h.length-1].height=a(this).parent().height());void 0!=a(this).attr("data-sortAs")?h[h.length-1].td.push(a(this).attr("data-sortAs")):
void 0!=typeof e.sortAs&&void 0!=e.sortAs[a(this).text()]?h[h.length-1].td.push(e.sortAs[a(this).text()]):"numeric"==m[b]?h[h.length-1].td.push(s(a(this).text())):h[h.length-1].td.push(a(this).text())})})}function t(c,g){a(b).find("tr:first-child th div.sortArrow div").stop(!0,!0).fadeOut(e.speed,"swing");switch(g){case "ascending":a(b).find("tr:first-child th div.sortArrow div.sortArrowAscending").eq(c).fadeIn(e.speed,"swing");break;case "descending":a(b).find("tr:first-child th div.sortArrow div.sortArrowDescending").eq(c).fadeIn(e.speed,
"swing")}}function u(c,f){c="ascending"==f?c.concat():c.concat().reverse();g=a(b).find("tr").height();if("none"==e.animation)for(index=0;index<c.length;index++){var d=c[index];a(b).find("tr.tsort_id-"+d.id).css({top:g}).appendTo(b);g+=d.height}else if("slide"==e.animation)for(index=0;index<c.length;index++)d=c[index],a(b).find("tr.tsort_id-"+d.id).stop().delay(e.delay*index).animate({top:g},e.speed,"swing").appendTo(b),g+=d.height;else if("fadeAll"==e.animation)l=!0,a(b).find("tr:gt(0)").fadeOut(e.speed).promise().done(function(){for(index=
0;index<c.length;index++){var d=c[index];a(b).find("tr.tsort_id-"+d.id).css({top:g}).appendTo(b);g+=d.height;index==h.length-1&&a(b).find("tr").delay(1).fadeIn(e.speed,"swing").promise().done(function(){l=!1})}});else if("fade"==e.animation){l=!0;if(0==n.length)for(index=0;index<c.length;index++)d=c[index],n[d.id]=a(b).find("tr.tsort_id-"+d.id).clone();a(b).find("tr:gt(0)").each(function(d,f){a(this).delay(d*e.delay).fadeOut(e.speed,"swing",function(){a(this).remove();a(n[c[d].id]).clone().hide().css({top:g}).appendTo(b).delay(1).fadeIn(e.speed,
"swing",function(){d==h.length-1&&(l=!1)});g+=c[d].height})})}else if("slideLeftAll"==e.animation)l=!0,a(b).find("tr:gt(0)").each(function(d,f){a(this).delay(d*e.delay).animate({left:"-"+e.distance,opacity:0},e.speed,"swing");d==h.length-1&&a(this).promise().done(function(){for(d=0;d<c.length;d++){var f=c[d];a(b).find("tr.tsort_id-"+f.id).css({top:g,left:"",right:"-"+e.distance}).appendTo(b).delay(d*e.delay).animate({right:"0px",opacity:1},e.speed,"swing",function(){a(this).css("right","auto");a(this).is("tr:last-child")&&
(l=!1)});g+=f.height}})});else if("slideLeft"==e.animation){l=!0;if(0==n.length)for(index=0;index<c.length;index++)d=c[index],n[d.id]=a(b).find("tr.tsort_id-"+d.id).clone();a(b).find("tr:gt(0)").each(function(d,f){a(this).delay(d*e.delay).animate({left:"-"+e.distance,opacity:0},e.speed,"swing",function(){a(this).remove();a(n[c[d].id]).clone().css({opacity:0}).appendTo(b).css({top:g,left:"",right:"-"+e.distance}).animate({right:"0px",opacity:1},e.speed,function(){a(this).css("right","auto");d==h.length-
1&&(l=!1)});g+=c[d].height})})}}function s(c){for(var b="",d=0;d<=c.length;d++)if(a.isNumeric(c.charAt(d))||"."==c.charAt(d))b+=c.charAt(d);return b}function v(){a(b).find("td").each(function(c){if(void 0!=a(this).attr("rowspan")){c=a(this).attr("rowspan");a(this).removeAttr("rowspan");for(var b=a(this).parent().index(),d=1;1<c;){switch(a(this).index()){case 0:a(this).clone().prependTo(a(this).parent().parent().children().eq(b+d));break;default:a(this).clone().insertAfter(a(this).parent().parent().children().eq(b+
d).children().eq(a(this).index()-1))}d++;c--}}})}var h=[],n=[],l=!1,p=[],k=[],r=[],m=[],f,b=a(this),l=!1;!0==e.rowspan&&v();0>=e.delay&&(e.delay=1);a(b).find("tr:first-child th").each(function(c){if(void 0!=e.sortBy)switch(e.sortBy[c]){case "text":case "numeric":case "nosort":m[c]=e.sortBy[c];return}if(void 0!=a(this).attr("data-sort"))switch(a(this).attr("data-sort")){case "text":case "numeric":case "nosort":m[c]=a(this).attr("data-sort");return}var f=m;for(var d=a(b).find("tr:eq(1) td:eq("+c+")").text(),
g=0,h=0,k=0;k<=d.length-1;k++)a.isNumeric(d.charAt(k))||","==d.charAt(k)||"."==d.charAt(k)?g++:h++;f[c]=g>h?"numeric":"text"});a(b).css("position","relative");a(b).find("tr:first-child th").each(function(c){"nosort"!=m[c]&&a('<div class="sortArrow"><div class="sortArrowAscending"></div><div class="sortArrowDescending"></div></div>').appendTo(a(this))});a(b).find("tr:first-child th").each(function(){r.push(a(this).outerWidth(!0))});a(b).find("tr td, tr th").each(function(){a(this).css({minWidth:r[a(this).index()]})});
a(b).find("tr").each(function(){a(this).width(a(this).outerWidth(!0));a(this).height(a(this).outerHeight(!0))});a(b).height(a(this).outerHeight()).width(a(this).outerWidth());var g=0;a(b).find("tr").each(function(c){a(this).css("top",g);g+=a(this).outerHeight()});a(b).find("tr").each(function(c,b){a(this).css("position","absolute")});a(b).find("tr th").each(function(c){"nosort"!=m[c]&&a(this).css("cursor","pointer")});a(b).find("tr th").click(function(){if(!l&&"nosort"!=m[a(this).index()]){f=a(this).index();
0==h.length&&q();p[f]||(p[f]=h.concat(),"numeric"==m[f]?p[f].sort(function(a,b){return a.td[f]-b.td[f]}):"text"==m[f]&&p[f].sort(function(a,b){return a.td[f].localeCompare(b.td[f])}));if(0==k.length)k.push({column_id:f,direction:"ascending"});else if(0!=k.length)if(f==k[k.length-1].column_id)switch(k[k.length-1].direction){case "ascending":k.push({column_id:f,direction:"descending"});break;case "descending":k.push({column_id:f,direction:"ascending"})}else k.push({column_id:f,direction:"ascending"});
u(p[f],k[k.length-1].direction);t(f,k[k.length-1].direction)}})})}})(jQuery);
